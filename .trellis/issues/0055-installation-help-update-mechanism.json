{
  "id": 55,
  "title": "Actant å®‰è£…æµç¨‹ Â· Help æŒ‡ä»¤ Â· æœ¬åœ°éƒ¨ç½²è‡ªæ›´æ–°æœºåˆ¶",
  "status": "open",
  "labels": ["feature", "cli", "devx", "documentation", "priority:P0"],
  "milestone": "phase-3",
  "body": "## èƒŒæ™¯\n\nActant å·²å®Œæˆ Phase 1â€“3 æ ¸å¿ƒåŠŸèƒ½å¼€å‘ï¼Œä½†ç¼ºä¹æ­£å¼çš„å®‰è£…æµç¨‹ã€å†…ç½®å¸®åŠ©ç³»ç»Ÿå’Œæœ¬åœ°éƒ¨ç½²æ›´æ–°æœºåˆ¶ã€‚ç”¨æˆ·ï¼ˆå¼€å‘è€…æœ¬äººï¼‰éœ€è¦ï¼š\n1. å°† Actant å®‰è£…åˆ°åˆé€‚çš„å…¨å±€ç›®å½•ï¼Œä½œä¸ºæ—¥å¸¸æŒç»­ä½¿ç”¨çš„å·¥å…·\n2. é€šè¿‡ `actant help` å¿«é€ŸæŸ¥é˜…å¯ç”¨å‘½ä»¤å’Œç”¨æ³•\n3. åœ¨æŒç»­å¼€å‘è¿‡ç¨‹ä¸­ï¼Œèƒ½å°†æœ€æ–°ä»£ç æ— ç¼æ›´æ–°åˆ°æœ¬åœ°å·²éƒ¨ç½²çš„ç‰ˆæœ¬ï¼ŒåŒæ—¶ä¿æŒå·²è¿è¡Œ Agent çš„æ­£å¸¸å·¥ä½œ\n\n## ä¸€ã€æ­£å¼å®‰è£…æµç¨‹æ–‡æ¡£ä¸è„šæœ¬ (Install)\n\n### é—®é¢˜\n\nå½“å‰ Actant åªèƒ½åœ¨å¼€å‘ç›®å½•ä¸­é€šè¿‡ `pnpm dev` è¿è¡Œï¼Œæ²¡æœ‰æ­£å¼çš„å®‰è£…æµç¨‹ã€‚ä½œä¸ºä¸€ä¸ªéœ€è¦æŒç»­ä½¿ç”¨çš„å¼€å‘è€…å·¥å…·ï¼Œéœ€è¦ï¼š\n- å…¨å±€å¯æ‰§è¡Œçš„ `actant` å‘½ä»¤\n- åˆç†çš„ç›®å½•ç»“æ„ï¼ˆä»£ç ç›®å½• vs æ•°æ®ç›®å½• vs é…ç½®ç›®å½•ï¼‰\n- å¼€å‘æ¨¡å¼ä¸ç”Ÿäº§æ¨¡å¼å¹¶å­˜\n\n### æ–¹æ¡ˆ\n\n#### 1.1 ç›®å½•è§„åˆ’\n\n```\nå¼€å‘ç›®å½•ï¼ˆæºç ï¼‰:\n  G:/Workspace/AgentWorkSpace/AgentCraft/   # æŒç»­å¼€å‘\n\nè¿è¡Œæ—¶æ•°æ®ç›®å½• (~/.actant/):\n  ~/.actant/\n  â”œâ”€â”€ config.json          # å…¨å±€é…ç½®\n  â”œâ”€â”€ data/\n  â”‚   â”œâ”€â”€ templates/       # ç”¨æˆ·æ¨¡æ¿\n  â”‚   â”œâ”€â”€ agents/          # Agent å®ä¾‹ workspace\n  â”‚   â””â”€â”€ sources/         # ç¼“å­˜çš„ Source å†…å®¹\n  â”œâ”€â”€ logs/                # Daemon æ—¥å¿—\n  â””â”€â”€ daemon.sock          # Daemon socket\n```\n\n#### 1.2 å®‰è£…æ–¹å¼\n\n**æ–¹å¼ A â€” pnpm linkï¼ˆå¼€å‘è€…æ¨èï¼‰ï¼š**\n```bash\n# åœ¨é¡¹ç›®æ ¹ç›®å½•\npnpm build\npnpm --filter @actant/cli link --global\n\n# éªŒè¯\nactant --version\nactant help\n```\n\n**æ–¹å¼ B â€” npm global installï¼ˆå‘å¸ƒåï¼‰ï¼š**\n```bash\nnpm install -g actant\n```\n\n**æ–¹å¼ C â€” è„šæœ¬å®‰è£…ï¼ˆä¾¿æ·ï¼‰ï¼š**\næä¾› `scripts/install.sh`ï¼ˆLinux/macOSï¼‰å’Œ `scripts/install.ps1`ï¼ˆWindowsï¼‰ï¼š\n- æ£€æŸ¥ Node.js >= 22ã€pnpm >= 9\n- `pnpm install && pnpm build`\n- `pnpm --filter @actant/cli link --global`\n- åˆ›å»º `~/.actant/` ç›®å½•ç»“æ„\n- éªŒè¯å®‰è£…æˆåŠŸ\n\n#### 1.3 å®‰è£…æ–‡æ¡£\n\nåœ¨ `docs/getting-started.md` åˆ›å»ºæ­£å¼å®‰è£…æ–‡æ¡£ï¼š\n- å‰ç½®ä¾èµ–ï¼ˆNode.js 22+ã€pnpm 9+ï¼‰\n- ä¸‰ç§å®‰è£…æ–¹å¼çš„æ­¥éª¤è¯´æ˜\n- é¦–æ¬¡è¿è¡Œå¼•å¯¼ï¼ˆ`actant daemon start` â†’ `actant agent create`ï¼‰\n- ç›®å½•ç»“æ„è¯´æ˜\n- å¸¸è§é—®é¢˜ï¼ˆæƒé™ã€PATHã€socket è·¯å¾„ï¼‰\n\n### éªŒæ”¶æ ‡å‡† â€” Install\n\n- [ ] `scripts/install.ps1`ï¼ˆWindowsï¼‰å®‰è£…è„šæœ¬å¯ç”¨\n- [ ] `scripts/install.sh`ï¼ˆLinux/macOSï¼‰å®‰è£…è„šæœ¬å¯ç”¨\n- [ ] å®‰è£…å `actant` å…¨å±€å‘½ä»¤å¯ç”¨\n- [ ] `docs/getting-started.md` åŒ…å«å®Œæ•´å®‰è£…æŒ‡å—\n- [ ] `~/.actant/` ç›®å½•ç»“æ„åœ¨é¦–æ¬¡è¿è¡Œæ—¶è‡ªåŠ¨åˆ›å»º\n\n---\n\n## äºŒã€Help æŒ‡ä»¤å®ç° (Help)\n\n### é—®é¢˜\n\nå½“å‰ CLI ä½¿ç”¨ commander çš„é»˜è®¤ `-h/--help` æœºåˆ¶ï¼Œç¼ºå°‘ï¼š\n- é¡¶å±‚ `actant help` å­å‘½ä»¤ï¼ˆä¸æ­¢ `--help` flagï¼‰\n- åˆ†ç»„å±•ç¤ºå‘½ä»¤ï¼ˆAgent ç®¡ç†ã€ç»„ä»¶ç®¡ç†ã€ç³»ç»Ÿç®¡ç†ï¼‰\n- å¸¸ç”¨ workflow ç¤ºä¾‹\n- ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„å¸®åŠ©ï¼ˆ`actant help agent` æ˜¾ç¤º agent å­å‘½ä»¤çš„è¯¦ç»†å¸®åŠ©ï¼‰\n\n### æ–¹æ¡ˆ\n\n#### 2.1 `actant help` é¡¶å±‚å‘½ä»¤\n\n```\n$ actant help\n\n  Actant v0.1.0 â€” Build, manage, and compose AI agents\n\n  Quick Start:\n    actant daemon start              å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹\n    actant agent create my-agent     åˆ›å»º Agent\n    actant agent start my-agent      å¯åŠ¨ Agent\n    actant agent chat my-agent       ä¸ Agent å¯¹è¯\n\n  Agent ç®¡ç†:\n    agent create|start|stop|list|chat|run    ç®¡ç† Agent ç”Ÿå‘½å‘¨æœŸ\n    template list|show                       ç®¡ç† Agent æ¨¡æ¿\n    proxy <name>                             ACP ä»£ç†è½¬å‘\n\n  ç»„ä»¶ç®¡ç†:\n    skill list|add|remove|show       ç®¡ç†æŠ€èƒ½å®šä¹‰\n    prompt list|add|remove|show      ç®¡ç†æç¤ºè¯\n    mcp list|show                    ç®¡ç† MCP Server é…ç½®\n    workflow list|show               ç®¡ç†å·¥ä½œæµ\n    plugin list|add|remove|show      ç®¡ç†æ’ä»¶\n\n  å…±äº«ç”Ÿæ€:\n    source list|add|remove|sync      ç®¡ç†ç»„ä»¶æ¥æº\n    preset list|apply                ç®¡ç†é¢„è®¾åŒ…\n\n  è°ƒåº¦:\n    schedule start|stop|status       ç®¡ç†é›‡å‘˜å‹ Agent è°ƒåº¦\n\n  ç³»ç»Ÿ:\n    daemon start|stop|status         Daemon ç®¡ç†\n    help [command]                   æŸ¥çœ‹å¸®åŠ©\n    --version                        æ˜¾ç¤ºç‰ˆæœ¬å·\n\n  Tips:\n    ä½¿ç”¨ actant help <command> æŸ¥çœ‹è¯¦ç»†å¸®åŠ©\n    ç›´æ¥è¿è¡Œ actant è¿›å…¥äº¤äº’å¼ REPL æ¨¡å¼\n```\n\n#### 2.2 `actant help <command>` å­å‘½ä»¤å¸®åŠ©\n\n```\n$ actant help agent\n\n  Agent ç®¡ç†å‘½ä»¤\n\n  actant agent create <name> [--template <tpl>]  åˆ›å»ºæ–° Agent\n  actant agent start <name>                      å¯åŠ¨ Agent\n  actant agent stop <name>                       åœæ­¢ Agent\n  actant agent list                              åˆ—å‡ºæ‰€æœ‰ Agent\n  actant agent chat <name>                       è¿›å…¥äº¤äº’å¯¹è¯\n  actant agent run <name> --prompt <text>         å•æ¬¡è¿è¡Œ\n  actant agent dispatch <name> --input <data>     è§¦å‘è°ƒåº¦ä»»åŠ¡\n\n  ç¤ºä¾‹:\n    actant agent create reviewer --template code-review-agent\n    actant agent start reviewer\n    actant agent chat reviewer\n```\n\n#### 2.3 å®ç°æ–¹å¼\n\nåœ¨ `packages/cli/src/commands/help.ts` åˆ›å»º help å‘½ä»¤ï¼š\n- ä½¿ç”¨ commander çš„ `.helpInformation()` è·å–å„å‘½ä»¤å¸®åŠ©æ–‡æœ¬\n- è‡ªå®šä¹‰æ ¼å¼åŒ–è¾“å‡ºï¼ˆåˆ†ç»„ã€ç€è‰²ã€Quick Startï¼‰\n- `actant help` â†’ æ˜¾ç¤ºæ€»è§ˆ\n- `actant help <cmd>` â†’ æ˜¾ç¤ºç‰¹å®šå‘½ä»¤çš„è¯¦ç»†å¸®åŠ©\n- `actant help <cmd> <subcmd>` â†’ æ˜¾ç¤ºå­å‘½ä»¤å¸®åŠ©\n\n### éªŒæ”¶æ ‡å‡† â€” Help\n\n- [ ] `actant help` æ˜¾ç¤ºåˆ†ç»„çš„å‘½ä»¤æ€»è§ˆå’Œ Quick Start\n- [ ] `actant help <command>` æ˜¾ç¤ºç‰¹å®šå‘½ä»¤çš„è¯¦ç»†å¸®åŠ©å’Œç¤ºä¾‹\n- [ ] help è¾“å‡ºåŒ…å« chalk ç€è‰²ï¼ˆç»ˆç«¯å‹å¥½ï¼‰\n- [ ] åœ¨ program.ts ä¸­æ³¨å†Œ help å‘½ä»¤\n\n---\n\n## ä¸‰ã€æœ¬åœ°éƒ¨ç½²è‡ªæ›´æ–°æœºåˆ¶ (Self-Update) â€” è„šæœ¬ä¸ºéª¨ã€Agent è¾…åŠ©\n\n### é—®é¢˜\n\nç”¨æˆ·åœ¨åŒä¸€å°æœºå™¨ä¸Šï¼š\n- **å¼€å‘**ï¼šæŒç»­åœ¨æºç ç›®å½•å¼€å‘ Actant æ–°åŠŸèƒ½\n- **ä½¿ç”¨**ï¼šåŒæ—¶ä½œä¸ºæ—¥å¸¸å·¥å…·ä½¿ç”¨æœ¬åœ°éƒ¨ç½²çš„ Actant ç®¡ç† Agent\n\nä¼ ç»Ÿçš„ã€Œè‡ªå·±æ›´æ–°è‡ªå·±ã€æ–¹æ¡ˆå­˜åœ¨æ ¹æœ¬çŸ›ç›¾ï¼šæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹æ— æ³•å®‰å…¨æ›¿æ¢è‡ªèº«ã€‚\n\n### æ ¸å¿ƒè®¾è®¡ï¼šè„šæœ¬å›ºåŒ– + Agent ç›‘ç®¡\n\n**è®¾è®¡å“²å­¦**ï¼šæ›´æ–°çš„æœºæ¢°æµç¨‹ï¼ˆbuild â†’ link â†’ restartï¼‰æ˜¯ç¡®å®šæ€§çš„ï¼Œåº”è¯¥å›ºåŒ–ä¸ºä¸€å¥—**å¯ç‹¬ç«‹æ‰§è¡Œã€å¯æµ‹è¯•ã€å¯å®¡è®¡**çš„è„šæœ¬ã€‚Agent ä¸åšå…·ä½“æ›´æ–°æ“ä½œï¼Œåªè´Ÿè´£**è°ƒåº¦è„šæœ¬ã€ç›‘æ§æ‰§è¡Œã€è¯Šæ–­å¼‚å¸¸ã€æ±‡æŠ¥ç»“æœ**ã€‚\n\n```\nèŒè´£åˆ†ç¦»ï¼š\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  æ›´æ–°è„šæœ¬ (scripts/self-update.js)               â”‚\nâ”‚  â”€ ç¡®å®šæ€§ã€å¯æµ‹è¯•ã€å¯ç‹¬ç«‹è¿è¡Œ                      â”‚\nâ”‚  â”€ è¯» manifest â†’ å¤‡ä»½ â†’ build â†’ link â†’ verify    â”‚\nâ”‚  â”€ å¤±è´¥è‡ªåŠ¨å›æ»š â†’ é‡å¯ Daemon                     â”‚\nâ”‚  â”€ æ¯æ­¥å†™å…¥ phase + æ—¥å¿—                          â”‚\nâ”‚  â”€ é€€å‡ºç  0=æˆåŠŸ, 1=å·²å›æ»š, 2=ä¸¥é‡æ•…éšœ             â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n          â–² è°ƒç”¨                 â–¼ è¯»å–ç»“æœ\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  Updater Agent (è¾…åŠ©å±‚ï¼Œå¯é€‰)                     â”‚\nâ”‚  â”€ ç”± Actant ä»¥ detached è¿›ç¨‹å¯åŠ¨                 â”‚\nâ”‚  â”€ è°ƒç”¨æ›´æ–°è„šæœ¬å¹¶ç›‘æ§å…¶ stdout/exitcode            â”‚\nâ”‚  â”€ å¦‚æœè„šæœ¬æ­£å¸¸å®Œæˆ â†’ éªŒè¯ Agent æ¢å¤ã€å†™ result   â”‚\nâ”‚  â”€ å¦‚æœè„šæœ¬å¼‚å¸¸ â†’ è¯Šæ–­é”™è¯¯ã€å°è¯•ä¿®å¤ã€æ±‡æŠ¥ç»™ç”¨æˆ·    â”‚\nâ”‚  â”€ æœ€ç»ˆè‡ªæ¯                                      â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**å…³é”®åŒºåˆ«**ï¼šç”¨æˆ·ä¹Ÿå¯ä»¥è·³è¿‡ Agent ç›´æ¥è¿è¡Œè„šæœ¬ï¼ˆ`node scripts/self-update.js`ï¼‰ï¼Œç»“æœå®Œå…¨ä¸€è‡´ã€‚Agent åªæ˜¯è®©æµç¨‹æ›´æ™ºèƒ½ï¼Œä¸æ˜¯å¿…é¡»çš„ã€‚\n\n### æ–¹æ¡ˆè¯¦ç»†è®¾è®¡\n\n#### 3.1 æ›´æ–°è„šæœ¬ `scripts/self-update.js`\n\nä¸€ä¸ªçº¯ Node.js è„šæœ¬ï¼Œé›¶å¤–éƒ¨ä¾èµ–ï¼ˆä¸ä¾èµ– Actant è¿è¡Œæ—¶ï¼‰ï¼Œå¯ç‹¬ç«‹æ‰§è¡Œï¼š\n\n```\nnode scripts/self-update.js [--manifest <path>] [--skip-build] [--skip-daemon]\n\næ‰§è¡Œæµç¨‹ï¼ˆä¸¥æ ¼é¡ºåºï¼Œæ¯æ­¥è®°å½• phaseï¼‰ï¼š\n\n  Phase 1 â€” pre-check\n    â”œâ”€ è¯»å– update-manifest.json\n    â”œâ”€ éªŒè¯æºç ç›®å½•å­˜åœ¨\n    â””â”€ éªŒè¯ pnpm / node ç‰ˆæœ¬æ»¡è¶³è¦æ±‚\n\n  Phase 2 â€” backup\n    â”œâ”€ å¿«ç…§å½“å‰ packages/*/dist/ åˆ° ~/.actant/backups/<id>/\n    â””â”€ é‡‡ç”¨ç¡¬é“¾æ¥ï¼ˆå¿«é€Ÿã€çœç©ºé—´ï¼‰ï¼Œä¿ç•™æœ€è¿‘ N ä»½\n\n  Phase 3 â€” build\n    â”œâ”€ cd <sourcePath>\n    â”œâ”€ pnpm install (å¦‚æœ‰æ–°ä¾èµ–)\n    â””â”€ pnpm build\n\n  Phase 4 â€” link\n    â””â”€ pnpm --filter @actant/cli link --global\n\n  Phase 5 â€” verify\n    â”œâ”€ actant --version ï¼ˆç¡®è®¤æ–°ç‰ˆæœ¬å¯æ‰§è¡Œï¼‰\n    â””â”€ æ¯”å¯¹ version / commitHash æ˜¯å¦æ›´æ–°\n\n  Phase 6 â€” daemon-restart\n    â”œâ”€ actant daemon startï¼ˆDaemon å·²è¢«è°ƒç”¨æ–¹æå‰åœæ‰ï¼‰\n    â””â”€ ç­‰å¾… daemon readyï¼ˆsocket å¯è¿æ¥ï¼‰\n\n  Phase 7 â€” agent-check\n    â”œâ”€ éå† manifest.runningAgents\n    â”œâ”€ æ£€æŸ¥å„ PID æ˜¯å¦å­˜æ´»\n    â””â”€ æ–° Daemon è‡ªåŠ¨ reattach å­˜æ´»çš„ Agent\n\né€€å‡ºç ï¼š\n  0 â€” æ›´æ–°æˆåŠŸ\n  1 â€” æ›´æ–°å¤±è´¥ï¼Œå·²æˆåŠŸå›æ»šåˆ°å¤‡ä»½ç‰ˆæœ¬\n  2 â€” ä¸¥é‡æ•…éšœï¼ˆå›æ»šä¹Ÿå¤±è´¥ï¼‰ï¼Œéœ€äººå·¥ä»‹å…¥\n\næ—¥å¿—è¾“å‡ºï¼š\n  æ¯ä¸ª phase çš„å¼€å§‹/ç»“æŸ/è€—æ—¶å†™å…¥ ~/.actant/logs/update-<id>.log\n  åŒæ—¶æ›´æ–° manifest.phase å­—æ®µï¼ˆç”¨äºå´©æºƒæ¢å¤ï¼‰\n```\n\n#### 3.2 `actant self-update` å‘½ä»¤\n\n```bash\nactant self-update [--source <path>] [--check] [--force] [--dry-run] [--no-agent]\n```\n\n- `--source <path>`ï¼šæºç ç›®å½•ï¼Œé»˜è®¤è¯»å– `~/.actant/config.json` çš„ `devSourcePath`\n- `--check`ï¼šåªæ£€æŸ¥ç‰ˆæœ¬å·®å¼‚ï¼Œä¸æ‰§è¡Œæ›´æ–°\n- `--force`ï¼šè·³è¿‡æ´»è·ƒ session è­¦å‘Š\n- `--dry-run`ï¼šæ¨¡æ‹Ÿæ‰§è¡Œï¼Œæ˜¾ç¤ºå°†è¦åšçš„æ“ä½œ\n- `--no-agent`ï¼šè·³è¿‡ Agent ç›‘ç®¡ï¼ŒActant ç›´æ¥ spawn è„šæœ¬åé€€å‡ºï¼ˆæœ€ç®€æ¨¡å¼ï¼‰\n\nå®Œæ•´æ—¶åºï¼ˆé»˜è®¤å¸¦ Agentï¼‰ï¼š\n```\n  ç”¨æˆ·/AI             Actant Daemon          Updater Agent          æ›´æ–°è„šæœ¬\n    â”‚                      â”‚                      â”‚                    â”‚\n    â”‚â”€ self-update â”€â”€â”€â”€â”€â”€â–ºâ”‚                      â”‚                    â”‚\n    â”‚                      â”‚â”€ 1. é¢„æ£€æŸ¥            â”‚                    â”‚\n    â”‚                      â”‚â”€ 2. å†™ manifest       â”‚                    â”‚\n    â”‚                      â”‚â”€ 3. è®°å½• Agent PIDs   â”‚                    â”‚\n    â”‚                      â”‚â”€ 4. spawn Agent â”€â”€â”€â”€â”€â–ºâ”‚ (detached)         â”‚\n    â”‚                      â”‚â”€ 5. Daemon é€€å‡º       â”‚                    â”‚\n    â”‚                      âœ—                      â”‚                    â”‚\n    â”‚                                             â”‚â”€ 6. è°ƒç”¨è„šæœ¬ â”€â”€â”€â”€â”€â”€â–ºâ”‚\n    â”‚                                             â”‚                    â”‚â”€ backup\n    â”‚                                             â”‚                    â”‚â”€ build\n    â”‚                                             â”‚                    â”‚â”€ link\n    â”‚                                             â”‚                    â”‚â”€ verify\n    â”‚                                             â”‚                    â”‚â”€ daemon start\n    â”‚                                             â”‚â—„â”€ 7. exit 0 â”€â”€â”€â”€â”€â”€â”€â”‚\n    â”‚                      â”‚â—„â”€ æ–° Daemon å¯åŠ¨      â”‚                    â”‚\n    â”‚                      â”‚â”€ reattach Agents      â”‚                    â”‚\n    â”‚                                             â”‚â”€ 8. éªŒè¯ Agents æ¢å¤â”‚\n    â”‚                                             â”‚â”€ 9. å†™ result       â”‚\n    â”‚                                             â”‚â”€ 10. è‡ªæ¯           â”‚\n    â”‚                                             âœ—                    â”‚\n    â”‚â—„â”€ æ›´æ–°å®Œæˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                                           â”‚\n```\n\n`--no-agent` ç®€åŒ–æ¨¡å¼ï¼ˆæ—  Agent ç›‘ç®¡ï¼‰ï¼š\n```\n  ç”¨æˆ·/AI             Actant Daemon          æ›´æ–°è„šæœ¬\n    â”‚                      â”‚                    â”‚\n    â”‚â”€ self-update â”€â”€â”€â”€â”€â”€â–ºâ”‚                    â”‚\n    â”‚                      â”‚â”€ å†™ manifest       â”‚\n    â”‚                      â”‚â”€ spawn è„šæœ¬ â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ (detached)\n    â”‚                      â”‚â”€ Daemon é€€å‡º       â”‚\n    â”‚                      âœ—                    â”‚\n    â”‚                                           â”‚â”€ backup â†’ build â†’ link\n    â”‚                                           â”‚â”€ verify â†’ daemon start\n    â”‚                      â”‚â—„â”€ æ–° Daemon â”€â”€â”€â”€â”€â”€â”€â”€â”‚\n    â”‚                      â”‚                    â”‚â”€ exit 0\n    â”‚â—„â”€ æ›´æ–°å®Œæˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    âœ—\n```\n\n#### 3.3 Update Manifestï¼ˆçŠ¶æ€äº¤æ¥æ–‡ä»¶ï¼‰\n\nActant é€€å‡ºå‰å†™å…¥ `~/.actant/update-manifest.json`ï¼š\n\n```json\n{\n  \"updateId\": \"upd-20260222-143000\",\n  \"createdAt\": \"2026-02-22T14:30:00Z\",\n  \"sourcePath\": \"G:/Workspace/AgentWorkSpace/AgentCraft\",\n  \"installedVersion\": {\n    \"version\": \"0.1.0\",\n    \"commitHash\": \"abc1234\",\n    \"buildTime\": \"2026-02-22T10:00:00Z\"\n  },\n  \"backupPath\": \"~/.actant/backups/upd-20260222-143000/\",\n  \"runningAgents\": [\n    { \"name\": \"reviewer\", \"pid\": 12345, \"workspaceDir\": \"~/.actant/data/agents/reviewer\" },\n    { \"name\": \"assistant\", \"pid\": 67890, \"workspaceDir\": \"~/.actant/data/agents/assistant\" }\n  ],\n  \"daemonSocketPath\": \"~/.actant/daemon.sock\",\n  \"rollbackOnFailure\": true,\n  \"phase\": \"pending\",\n  \"useAgent\": true\n}\n```\n\n`phase` å­—æ®µéšè„šæœ¬æ‰§è¡Œé€æ­¥æ›´æ–°ï¼š`pending â†’ backup â†’ build â†’ link â†’ verify â†’ daemon-restart â†’ agent-check â†’ done`ã€‚å¦‚æœè¿›ç¨‹ä¸­é€”å´©æºƒï¼Œä¸‹æ¬¡ Daemon å¯åŠ¨æ—¶å¯æ ¹æ® phase å†³å®šæ¢å¤ç­–ç•¥ã€‚\n\n#### 3.4 Updater Agent è§’è‰²å®šä¹‰\n\nAgent ä¸æ‰§è¡Œä»»ä½•æ›´æ–°æ“ä½œï¼Œåªåšä¸‰ä»¶äº‹ï¼š\n\n```\n1. è°ƒåº¦ï¼šå¯åŠ¨æ›´æ–°è„šæœ¬ï¼Œä¼ å…¥ manifest è·¯å¾„\n2. ç›‘æ§ï¼šè¯»å–è„šæœ¬ stdout + exitcodeï¼Œç›‘æ§ phase è¿›å±•\n3. å–„åï¼š\n   â”œâ”€ exitcode=0 â†’ éªŒè¯ Agent æ¢å¤çŠ¶æ€ â†’ å†™å…¥ update-result.json â†’ è‡ªæ¯\n   â”œâ”€ exitcode=1 â†’ è¯»å–å›æ»šæ—¥å¿— â†’ è¯Šæ–­å¤±è´¥åŸå›  â†’ å†™å…¥ result â†’ è‡ªæ¯\n   â””â”€ exitcode=2 â†’ å°è¯•æ‰‹åŠ¨æ¢å¤ï¼ˆé‡æ–° link å¤‡ä»½ï¼‰â†’ å†™å…¥ result â†’ è‡ªæ¯\n```\n\nAgent çš„æ™ºèƒ½ä½“ç°åœ¨ï¼š\n- **å¤±è´¥è¯Šæ–­**ï¼šåˆ†æ build é”™è¯¯æ—¥å¿—ï¼Œåˆ¤æ–­æ˜¯ TypeScript ç±»å‹é”™è¯¯è¿˜æ˜¯ä¾èµ–ç¼ºå¤±\n- **æ¢å¤å†³ç­–**ï¼šå¦‚æœè„šæœ¬å´©æºƒåœ¨ link é˜¶æ®µï¼ˆphase=linkï¼‰ï¼Œå¯ä»¥ç›´æ¥è·³åˆ° verify\n- **ç”¨æˆ·é€šçŸ¥**ï¼šæ›´æ–°å®Œæˆåé€šè¿‡ update-result.json å‘ç”¨æˆ·/AI æ±‡æŠ¥è¯¦ç»†ç»“æœ\n\nAgent ä»¥ `detached: true, stdio: 'pipe'` å¯åŠ¨ï¼Œç‹¬ç«‹äº Daemon è¿›ç¨‹æ ‘ã€‚å®ƒæœ¬èº«æ˜¯ä¸€ä¸ªè½»é‡ Node.js è„šæœ¬ï¼ˆ`scripts/updater-supervisor.js`ï¼‰ï¼Œä¸éœ€è¦ Actant æ¨¡æ¿ç³»ç»Ÿã€‚\n\n#### 3.5 ç”¨æˆ·æ•°æ®ä¿æŠ¤ç­–ç•¥ï¼ˆæ ¸å¿ƒå®‰å…¨è®¾è®¡ï¼‰\n\n```\nç”¨æˆ·æ•°æ®ä¿æŠ¤ä¸‰åŸåˆ™ï¼š\n\n1. ã€Œè„šæœ¬åªç¢°ç¼–è¯‘äº§ç‰©ï¼Œç»ä¸ç¢°ç”¨æˆ·æ•°æ®ã€\n   æ›´æ–°è„šæœ¬æ“ä½œèŒƒå›´ä¸¥æ ¼é™å®šä¸ºï¼š\n   âœ… æºç ç›®å½•çš„ node_modules/ å’Œ packages/*/dist/ï¼ˆç¼–è¯‘äº§ç‰©ï¼‰\n   âœ… å…¨å±€ link ç¬¦å·é“¾æ¥ï¼ˆæŒ‡å‘æ–° distï¼‰\n   âœ… ~/.actant/backups/ï¼ˆå¤‡ä»½ç›®å½•ï¼Œè„šæœ¬è‡ªç®¡ç†ï¼‰\n   âœ… ~/.actant/update-manifest.jsonï¼ˆphase çŠ¶æ€æ›´æ–°ï¼‰\n   âœ… ~/.actant/logs/update-*.logï¼ˆæ—¥å¿—è¿½åŠ å†™å…¥ï¼‰\n   âŒ ç»ä¸è¯»å†™ ~/.actant/data/agents/*ï¼ˆAgent workspace + ç”¨æˆ·æ•°æ®ï¼‰\n   âŒ ç»ä¸è¯»å†™ ~/.actant/data/templates/*ï¼ˆç”¨æˆ·è‡ªå®šä¹‰æ¨¡æ¿ï¼‰\n   âŒ ç»ä¸è¯»å†™ ~/.actant/data/sources/*ï¼ˆç¼“å­˜çš„ Source å†…å®¹ï¼‰\n   âŒ ç»ä¸ä¿®æ”¹ ~/.actant/config.jsonï¼ˆç”¨æˆ·å…¨å±€é…ç½®ï¼‰\n   âŒ ç»ä¸åˆ é™¤ä»»ä½• .actant.jsonï¼ˆAgent å®ä¾‹å…ƒæ•°æ®ï¼‰\n\n2. ã€Œå…ˆå¤‡ä»½ï¼Œåæ“ä½œã€\n   æ›´æ–°å‰å°†å½“å‰ dist/ ç›®å½•å¤‡ä»½åˆ° ~/.actant/backups/<updateId>/\n   å¤‡ä»½é‡‡ç”¨ç¡¬é“¾æ¥ï¼ˆç§’çº§å®Œæˆï¼Œä¸å é¢å¤–ç©ºé—´ï¼‰\n   ä¿ç•™æœ€è¿‘ N ä¸ªå¤‡ä»½ï¼ˆé»˜è®¤ 3 ä¸ªï¼‰ï¼Œæ—§å¤‡ä»½è‡ªåŠ¨æ¸…ç†\n\n3. ã€ŒåŸå­åˆ‡æ¢ + å¤±è´¥å›æ»šã€\n   link æ“ä½œæ˜¯åŸå­çš„ï¼ˆç¬¦å·é“¾æ¥æ›¿æ¢ï¼‰\n   è„šæœ¬ä»»ä½•é˜¶æ®µå¤±è´¥ â†’ è‡ªåŠ¨æ¢å¤å¤‡ä»½ â†’ é‡å¯æ—§ç‰ˆ Daemon\n   å¦‚æœå›æ»šä¹Ÿå¤±è´¥ â†’ exit 2ï¼ŒAgent å°è¯•æœ€åä¿®å¤æˆ–æç¤ºäººå·¥ä»‹å…¥\n\næ•°æ®éš”ç¦»æ¶æ„ï¼š\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚          ~/.actant/ (ACTANT_HOME)          â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  config.json          ğŸ”’ åªè¯»ï¼ˆä¸å¯è§¦ç¢°ï¼‰   â”‚\nâ”‚  data/                                    â”‚\nâ”‚  â”œâ”€â”€ agents/*         ğŸ”’ åªè¯»ï¼ˆä¸å¯è§¦ç¢°ï¼‰   â”‚\nâ”‚  â”œâ”€â”€ templates/*      ğŸ”’ åªè¯»ï¼ˆä¸å¯è§¦ç¢°ï¼‰   â”‚\nâ”‚  â””â”€â”€ sources/*        ğŸ”’ åªè¯»ï¼ˆä¸å¯è§¦ç¢°ï¼‰   â”‚\nâ”‚  logs/                ğŸ“ è¿½åŠ å†™å…¥ï¼ˆä»…æ—¥å¿—ï¼‰  â”‚\nâ”‚  daemon.sock          â™»ï¸ Daemon ç®¡ç†        â”‚\nâ”‚  backups/             ğŸ“¦ è„šæœ¬ç®¡ç†           â”‚\nâ”‚  update-manifest.json â™»ï¸ è„šæœ¬è¯»å†™ phase     â”‚\nâ”‚  update-result.json   â™»ï¸ Agent å†™å…¥ç»“æœ     â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚        æºç ç›®å½• (devSourcePath)             â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  node_modules/        â™»ï¸ pnpm install      â”‚\nâ”‚  packages/*/dist/     â™»ï¸ pnpm build        â”‚\nâ”‚  å…¶ä»–æºç æ–‡ä»¶          ğŸ”’ åªè¯»              â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n#### 3.6 å…¨å±€é…ç½® `~/.actant/config.json`\n\n```json\n{\n  \"devSourcePath\": \"G:/Workspace/AgentWorkSpace/AgentCraft\",\n  \"update\": {\n    \"maxBackups\": 3,\n    \"preUpdateTestCommand\": \"pnpm test:changed\",\n    \"autoRestartAgents\": true\n  }\n}\n```\n\n#### 3.7 `actant self-update --check` ç‰ˆæœ¬å¯¹æ¯”\n\n```json\n{\n  \"installed\": {\n    \"version\": \"0.1.0\",\n    \"buildTime\": \"2026-02-22T10:00:00Z\",\n    \"commitHash\": \"abc1234\"\n  },\n  \"source\": {\n    \"version\": \"0.1.0\",\n    \"commitHash\": \"def5678\",\n    \"dirty\": true,\n    \"uncommittedChanges\": 5,\n    \"ahead\": 3\n  },\n  \"needsUpdate\": true,\n  \"lastUpdate\": {\n    \"updateId\": \"upd-20260222-100000\",\n    \"status\": \"success\",\n    \"time\": \"2026-02-22T10:00:00Z\"\n  }\n}\n```\n\n#### 3.8 è„šæœ¬å¯ç‹¬ç«‹æµ‹è¯•\n\næ›´æ–°è„šæœ¬ä½œä¸ºç‹¬ç«‹æ¨¡å—ï¼Œå¯ä»¥åœ¨ CI æˆ–æœ¬åœ°å•ç‹¬æµ‹è¯•ï¼š\n\n```bash\n# ç›´æ¥è¿è¡Œè„šæœ¬ï¼ˆä¸ç»è¿‡ Actant CLIï¼‰\nnode scripts/self-update.js --manifest ~/.actant/update-manifest.json\n\n# dry-run æ¨¡å¼ï¼ˆåªæ‰“å°å°†æ‰§è¡Œçš„æ“ä½œï¼‰\nnode scripts/self-update.js --manifest ~/.actant/update-manifest.json --dry-run\n\n# è·³è¿‡ daemon é‡å¯ï¼ˆæµ‹è¯• build + link æµç¨‹ï¼‰\nnode scripts/self-update.js --manifest ~/.actant/update-manifest.json --skip-daemon\n```\n\n#### 3.9 è¾¹ç•Œæƒ…å†µå¤„ç†\n\n| åœºæ™¯ | è„šæœ¬è¡Œä¸º | Agent è¾…åŠ©è¡Œä¸º |\n|------|----------|---------------|\n| pnpm build å¤±è´¥ | å›æ»šå¤‡ä»½ â†’ é‡å¯æ—§ Daemon â†’ exit 1 | åˆ†æ build æ—¥å¿—ï¼Œè¯Šæ–­å¤±è´¥åŸå›  |\n| link æƒé™ä¸è¶³ | å›æ»š â†’ exit 1 | æç¤ºç”¨æˆ·æ£€æŸ¥ npm å…¨å±€ç›®å½•æƒé™ |\n| æ–° Daemon å¯åŠ¨å¤±è´¥ | å›æ»š â†’ å¯åŠ¨æ—§ Daemon â†’ exit 1 | æ£€æŸ¥ç«¯å£/socket å†²çª |\n| è„šæœ¬è‡ªèº«å´©æºƒ | manifest.phase è®°å½•è¿›åº¦ | Agent æ ¹æ® phase å°è¯•ç»­è·‘æˆ–å›æ»š |\n| Agent ä¹Ÿå´©æºƒ | manifest.phase ä»ä¿ç•™ | ä¸‹æ¬¡ daemon start æ£€æµ‹ manifestï¼Œæç¤ºæ¢å¤ |\n| æ›´æ–°é€”ä¸­æ–­ç”µ | åŒä¸Š | åŒä¸Š |\n| æœ‰ Agent æ­£åœ¨æ´»è·ƒäº¤äº’ | è„šæœ¬ä¸å…³å¿ƒï¼ˆAgent è¿›ç¨‹ç‹¬ç«‹ï¼‰ | é¢„æ£€æ—¶è­¦å‘Šç”¨æˆ· |\n| æºç æœ‰æœªæäº¤æ›´æ”¹ | æ­£å¸¸æ‰§è¡Œï¼ˆå¼€å‘å¸¸æ€ï¼‰ | --check æ—¶æŠ¥å‘Š dirty çŠ¶æ€ |\n\n### éªŒæ”¶æ ‡å‡† â€” Self-Update\n\n- [ ] `scripts/self-update.js` å¯ç‹¬ç«‹æ‰§è¡Œï¼Œä¸ä¾èµ– Actant è¿è¡Œæ—¶\n- [ ] è„šæœ¬æ”¯æŒ --manifest / --dry-run / --skip-daemon / --skip-build å‚æ•°\n- [ ] è„šæœ¬æ¯æ­¥æ›´æ–° manifest.phaseï¼Œæ”¯æŒå´©æºƒæ¢å¤\n- [ ] è„šæœ¬é€€å‡ºç è¯­ä¹‰æ˜ç¡®ï¼š0=æˆåŠŸ, 1=å·²å›æ»š, 2=ä¸¥é‡æ•…éšœ\n- [ ] `~/.actant/config.json` æ”¯æŒ `devSourcePath` å’Œ `update` é…ç½®\n- [ ] `actant self-update --check` æ˜¾ç¤ºç‰ˆæœ¬å¯¹æ¯”å’Œä¸Šæ¬¡æ›´æ–°çŠ¶æ€\n- [ ] `actant self-update` å®Œæ•´æ‰§è¡Œï¼šå†™ manifest â†’ spawn Agent â†’ Daemon é€€å‡º\n- [ ] `actant self-update --no-agent` ç®€åŒ–æ¨¡å¼ç›´æ¥ spawn è„šæœ¬\n- [ ] æ›´æ–°è¿‡ç¨‹ä¸­ç”¨æˆ·æ•°æ®ï¼ˆ~/.actant/data/ï¼‰é›¶æ¥è§¦\n- [ ] æ›´æ–°å‰è‡ªåŠ¨å¤‡ä»½ dist/ ç¼–è¯‘äº§ç‰©\n- [ ] ç¼–è¯‘/link/éªŒè¯ä»»ä¸€æ­¥éª¤å¤±è´¥æ—¶è‡ªåŠ¨å›æ»š\n- [ ] æ–° Daemon å¯åŠ¨åè‡ªåŠ¨ reattach è¿è¡Œä¸­çš„ Agent\n- [ ] Updater Agent ç›‘æ§è„šæœ¬æ‰§è¡Œå¹¶å†™å…¥ update-result.json\n- [ ] Daemon å¯åŠ¨æ—¶æ£€æµ‹æœªå®Œæˆçš„ update manifestï¼Œæç¤ºæ¢å¤\n\n---\n\n## å®æ–½ä¼˜å…ˆçº§\n\n| ä¼˜å…ˆçº§ | æ¨¡å— | å†…å®¹ | å¤æ‚åº¦ |\n|--------|------|------|--------|\n| P0 | Install | å®‰è£…è„šæœ¬ + æ–‡æ¡£ + ç›®å½•ç»“æ„åˆå§‹åŒ– | ä½ |\n| P0 | Help | `actant help` å‘½ä»¤ + åˆ†ç»„å±•ç¤º | ä½ |\n| P1 | Self-Update | `scripts/self-update.js` æ›´æ–°è„šæœ¬ï¼ˆå¤‡ä»½ â†’ build â†’ link â†’ verify â†’ restartï¼‰ | ä¸­ |\n| P1 | Self-Update | `actant self-update` å‘½ä»¤ï¼ˆé¢„æ£€ â†’ manifest â†’ spawn â†’ é€€å‡ºï¼‰ | ä¸­ |\n| P1 | Self-Update | ç”¨æˆ·æ•°æ®ä¿æŠ¤ + å¤‡ä»½/å›æ»šæœºåˆ¶ | ä¸­ |\n| P2 | Self-Update | `scripts/updater-supervisor.js` Agent ç›‘ç®¡å±‚ | ä¸­ |\n| P2 | Self-Update | Daemon å¯åŠ¨æ—¶ manifest æ¢å¤æ£€æµ‹ | ä½ |\n| P2 | Self-Update | `--check` ç‰ˆæœ¬å¯¹æ¯” + update-result æŸ¥è¯¢ | ä½ |\n| P3 | Self-Update | AI è¾…åŠ©æ›´æ–° skill/command å°è£… | ä½ |",
  "author": "human",
  "assignees": [],
  "relatedFiles": [
    "packages/cli/src/program.ts",
    "packages/cli/src/bin/actant.ts",
    "scripts/self-update.js",
    "scripts/updater-supervisor.js",
    "packages/cli/src/commands/help.ts",
    "packages/cli/package.json",
    "packages/shared/src/platform/platform.ts",
    "packages/core/src/manager/agent-manager.ts",
    "packages/core/src/manager/launch-mode-handler.ts",
    "packages/core/src/state/instance-meta-io.ts",
    "packages/api/src/daemon/daemon.ts",
    "scripts/install.ps1",
    "scripts/install.sh",
    "docs/getting-started.md",
    "package.json"
  ],
  "relatedIssues": [10, 11, 15, 34, 38],
  "taskRef": null,
  "githubRef": null,
  "closedAs": null,
  "comments": [],
  "createdAt": "2026-02-22T12:00:00",
  "updatedAt": "2026-02-22T15:00:00",
  "closedAt": null
}
