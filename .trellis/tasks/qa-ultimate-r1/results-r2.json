[
  {
    "id": "p0-version",
    "description": "[Phase 0 基础设施] CLI 版本号",
    "command": "--version",
    "exitCode": 0,
    "stdout": "0.2.1",
    "stderr": "",
    "elapsed": 351,
    "verdict": "PASS",
    "expect": "输出语义化版本号（如 0.2.2），退出码 0"
  },
  {
    "id": "p0-help",
    "description": "[Phase 0 基础设施] CLI 帮助信息",
    "command": "--help",
    "exitCode": 0,
    "stdout": "Usage: actant [options] [command]\n\nActant — Build, manage, and compose AI agents\n\nOptions:\n  -V, --version           output the version number\n  -h, --help              display help for command\n\nCommands:\n  template|tpl            Manage agent templates\n  agent                   Manage agent instances\n  skill                   Manage loaded skills\n  prompt                  Manage loaded prompts\n  mcp                     Manage loaded MCP server configs\n  workflow                Manage loaded workflows\n  plugin                  Manage loaded plugins\n  source                  Manage component sources (GitHub repos, local dirs)\n  preset                  Manage component presets (bundled compositions)\n  schedule                Manage agent schedules (heartbeat, cron, hooks)\n  daemon                  Manage the Actant daemon\n  proxy [options] <name>  Run an ACP proxy for an agent (stdin/stdout ACP\n                          protocol)\n  help [command]          Show help information\n  self-update [options]   Update Actant from local source\n  setup [options]         Interactive setup wizard — configure Actant step by\n                          step",
    "stderr": "",
    "elapsed": 347,
    "verdict": "PASS",
    "expect": "输出帮助信息，列出全部子命令组（agent, template, daemon, skill, prompt, mcp, workflow, plugin, source, preset, schedule, proxy, setup, self-update, help），退出码 0"
  },
  {
    "id": "p0-help-agent",
    "description": "[Phase 0 基础设施] Agent 子命令帮助",
    "command": "help agent",
    "exitCode": 0,
    "stdout": "Usage: actant agent [options] [command]\n\nManage agent instances\n\nOptions:\n  -h, --help                   display help for command\n\nCommands:\n  create [options] <name>      Create a new agent from a template\n  start <name>                 Start an agent\n  stop <name>                  Stop a running agent\n  status [options] [name]      Show agent status (all agents if no name given)\n  list|ls [options]            List all agents\n  adopt [options] <path>       Adopt an existing agent workspace into the\n                               instance registry\n  destroy|rm [options] <name>  Destroy an agent (removes workspace directory)\n  resolve [options] <name>     Resolve spawn info for an agent (external spawn\n                               support)\n  open <name>                  Open an agent's native TUI/UI (e.g. Cursor IDE,\n                               Claude Code)\n  attach [options] <name>      Attach an externally-spawned process to an agent\n  detach [options] <name>      Detach an externally-managed process from an\n                               agent\n  run [options] <name>         Send a prompt to an agent and get the response\n  prompt [options] <name>      Send a message to a running agent's ACP session\n  chat [options] <name>        Start an interactive chat session with an agent\n  dispatch [options] <name>    Queue a one-off task for an agent's scheduler\n  tasks [options] <name>       List queued tasks for an agent's scheduler\n  logs [options] <name>        Show execution ",
    "stderr": "",
    "elapsed": 401,
    "verdict": "PASS",
    "expect": "列出 agent 的全部子命令（create, start, stop, destroy, status, list, resolve, open, adopt, attach, detach, run, prompt, chat, dispatch, tasks, logs），退出码 0"
  },
  {
    "id": "p0-help-template",
    "description": "[Phase 0 基础设施] Template 子命令帮助",
    "command": "help template",
    "exitCode": 0,
    "stdout": "Usage: actant template|tpl [options] [command]\n\nManage agent templates\n\nOptions:\n  -h, --help             display help for command\n\nCommands:\n  list|ls [options]      List all registered templates\n  show [options] <name>  Show template details\n  validate <file>        Validate a template JSON file\n  load <file>            Load a template from a JSON file into the registry\n  install <spec>         Install a template from a source (source@name or just\n                         name for default source)\n  help [command]         display help for command",
    "stderr": "",
    "elapsed": 425,
    "verdict": "PASS",
    "expect": "列出 template 子命令（list, show, validate, load, install），退出码 0"
  },
  {
    "id": "p0-help-source",
    "description": "[Phase 0 基础设施] Source 子命令帮助",
    "command": "help source",
    "exitCode": 0,
    "stdout": "Usage: actant source [options] [command]\n\nManage component sources (GitHub repos, local dirs)\n\nOptions:\n  -h, --help                   display help for command\n\nCommands:\n  list|ls [options]            List registered component sources\n  add [options] <url-or-path>  Register a component source\n  remove|rm <name>             Remove a registered source\n  sync [name]                  Sync component source(s)\n  validate [options] [name]    Validate all assets in a component source\n  help [command]               display help for command",
    "stderr": "",
    "elapsed": 345,
    "verdict": "PASS",
    "expect": "列出 source 子命令（list, add, remove, sync, validate），退出码 0"
  },
  {
    "id": "p1-setup-fullskip",
    "description": "[Phase 1 Setup] 全跳过模式 — 验证 setup 命令基本流程",
    "command": "setup --skip-home --skip-provider --skip-source --skip-agent --skip-autostart --skip-hello --skip-update",
    "exitCode": 0,
    "stdout": "╔══════════════════════════════════════════════╗\n║   Actant Setup Wizard                       ║\n║   Build, manage, and compose AI agents       ║\n╚══════════════════════════════════════════════╝\n  使用默认工作目录: C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\n\n══════════════════════════════════════════════\n  Setup Complete!\n══════════════════════════════════════════════\n\n  工作目录: C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\n\n  快速开始:\n    actant daemon start     启动 Daemon\n    actant template list    浏览模板\n    actant agent list       查看 Agent\n    actant agent chat <n>   与 Agent 对话\n    actant setup            重新运行此向导\n\n  更多帮助: actant help",
    "stderr": "",
    "elapsed": 363,
    "verdict": "PASS",
    "expect": "退出码 0，输出 Setup Complete 摘要，输出包含工作目录路径"
  },
  {
    "id": "p1-setup-verify-config",
    "description": "[Phase 1 Setup] 白盒验证 config.json 存在",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/config.json",
    "exitCode": 0,
    "stdout": "{\n  \"devSourcePath\": \"\",\n  \"update\": {\n    \"maxBackups\": 3,\n    \"preUpdateTestCommand\": \"pnpm test:changed\",\n    \"autoRestartAgents\": true\n  }\n}\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "文件存在且为合法 JSON，包含 devSourcePath 和 update 字段"
  },
  {
    "id": "p1-setup-verify-dirs",
    "description": "[Phase 1 Setup] 白盒验证目录结构通过 template list",
    "command": "template list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"actant-hub@code-reviewer\",\n    \"version\": \"1.0.0\",\n    \"description\": \"A code review agent — systematic reviews with security, performance, and maintainability checks\",\n    \"backend\": {\n      \"type\": \"claude-code\"\n    },\n    \"domainContext\": {\n      \"skills\": [\n        \"actant-hub@code-review\"\n      ],\n      \"prompts\": [\n        \"actant-hub@code-assistant\"\n      ],\n      \"mcpServers\": [\n        {\n          \"name\": \"filesystem\",\n          \"command\": \"npx\",\n          \"args\": [\n            \"-y\",\n            \"@modelcontextprotocol/server-filesystem\",\n            \".\"\n          ]\n        }\n      ]\n    },\n    \"metadata\": {\n      \"category\": \"web-dev\",\n      \"difficulty\": \"beginner\"\n    }\n  },\n  {\n    \"name\": \"actant-hub@qa-engineer\",\n    \"version\": \"1.0.0\",\n    \"description\": \"A QA testing agent — writes tests, runs test suites, and reports quality issues\",\n    \"backend\": {\n      \"type\": \"claude-code\"\n    },\n    \"domainContext\": {\n      \"skills\": [\n        \"actant-hub@test-writer\"\n      ],\n      \"prompts\": [\n        \"actant-hub@qa-assistant\"\n      ],\n      \"mcpServers\": [\n        {\n          \"name\": \"filesystem\",\n          \"command\": \"npx\",\n          \"args\": [\n            \"-y\",\n            \"@modelcontextprotocol/server-filesystem\",\n            \".\"\n          ]\n        }\n      ]\n    },\n    \"metadata\": {\n      \"category\": \"web-dev\",\n      \"difficulty\": \"beginner\"\n    }\n  },\n  {\n    \"name\": \"actant-hub@doc-writer\",\n    \"version\": \"1.0.0\",\n    \"description\": \"A documen",
    "stderr": "",
    "elapsed": 418,
    "verdict": "PASS",
    "expect": "退出码 0（daemon 可正常操作目录结构），返回数组"
  },
  {
    "id": "p1-setup-repeat",
    "description": "[Phase 1 Setup] 重复运行全跳过 setup（幂等性）",
    "command": "setup --skip-home --skip-provider --skip-source --skip-agent --skip-autostart --skip-hello --skip-update",
    "exitCode": 0,
    "stdout": "╔══════════════════════════════════════════════╗\n║   Actant Setup Wizard                       ║\n║   Build, manage, and compose AI agents       ║\n╚══════════════════════════════════════════════╝\n  使用默认工作目录: C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\n\n══════════════════════════════════════════════\n  Setup Complete!\n══════════════════════════════════════════════\n\n  工作目录: C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\n\n  快速开始:\n    actant daemon start     启动 Daemon\n    actant template list    浏览模板\n    actant agent list       查看 Agent\n    actant agent chat <n>   与 Agent 对话\n    actant setup            重新运行此向导\n\n  更多帮助: actant help",
    "stderr": "",
    "elapsed": 350,
    "verdict": "PASS",
    "expect": "退出码 0，输出 Setup Complete，不报错不崩溃"
  },
  {
    "id": "p1-setup-config-unchanged",
    "description": "[Phase 1 Setup] 白盒验证重复 setup 后 config.json 仍合法",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/config.json",
    "exitCode": 0,
    "stdout": "{\n  \"devSourcePath\": \"\",\n  \"update\": {\n    \"maxBackups\": 3,\n    \"preUpdateTestCommand\": \"pnpm test:changed\",\n    \"autoRestartAgents\": true\n  }\n}\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "文件内容仍为合法 JSON，结构完整"
  },
  {
    "id": "p1-setup-partial",
    "description": "[Phase 1 Setup] 部分跳过（非 TTY 场景）— 不跳过 source",
    "command": "setup --skip-home --skip-provider --skip-agent --skip-autostart --skip-hello --skip-update",
    "exitCode": 0,
    "stdout": "╔══════════════════════════════════════════════╗\n║   Actant Setup Wizard                       ║\n║   Build, manage, and compose AI agents       ║\n╚══════════════════════════════════════════════╝\n  使用默认工作目录: C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\n\n  Daemon 已在运行中\n\n[ Step 3/7 ] 配置组件源 (Source)\n\n? 添加官方组件源 actant-hub? (Y/n)\u001b[36G\n\u001b[?25h\n  已取消设置向导",
    "stderr": "",
    "elapsed": 415,
    "verdict": "PASS",
    "expect": "触发 ExitPromptError / 用户取消处理，或直接完成。非 TTY 下 @inquirer/prompts 可能挂起或立即取消"
  },
  {
    "id": "p1-setup-skiponly-home",
    "description": "[Phase 1 Setup] 仅跳过 home，验证 ACTANT_HOME 环境变量被使用",
    "command": "setup --skip-home --skip-provider --skip-source --skip-agent --skip-autostart --skip-hello --skip-update",
    "exitCode": 0,
    "stdout": "╔══════════════════════════════════════════════╗\n║   Actant Setup Wizard                       ║\n║   Build, manage, and compose AI agents       ║\n╚══════════════════════════════════════════════╝\n  使用默认工作目录: C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\n\n══════════════════════════════════════════════\n  Setup Complete!\n══════════════════════════════════════════════\n\n  工作目录: C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\n\n  快速开始:\n    actant daemon start     启动 Daemon\n    actant template list    浏览模板\n    actant agent list       查看 Agent\n    actant agent chat <n>   与 Agent 对话\n    actant setup            重新运行此向导\n\n  更多帮助: actant help",
    "stderr": "",
    "elapsed": 342,
    "verdict": "PASS",
    "expect": "退出码 0，输出包含 $ACTANT_HOME 路径而非默认 ~/.actant"
  },
  {
    "id": "p1-setup-config-structure",
    "description": "[Phase 1 Setup] 白盒验证 config.json 完整结构",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/config.json",
    "exitCode": 0,
    "stdout": "{\n  \"devSourcePath\": \"\",\n  \"update\": {\n    \"maxBackups\": 3,\n    \"preUpdateTestCommand\": \"pnpm test:changed\",\n    \"autoRestartAgents\": true\n  }\n}\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "JSON 包含 devSourcePath（string）和 update 对象（含 maxBackups、preUpdateTestCommand、autoRestartAgents）"
  },
  {
    "id": "p2-tpl-list-init",
    "description": "[Phase 2 Template] 列出初始模板（应含 setup 加载的 6 个）",
    "command": "template list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"actant-hub@code-reviewer\",\n    \"version\": \"1.0.0\",\n    \"description\": \"A code review agent — systematic reviews with security, performance, and maintainability checks\",\n    \"backend\": {\n      \"type\": \"claude-code\"\n    },\n    \"domainContext\": {\n      \"skills\": [\n        \"actant-hub@code-review\"\n      ],\n      \"prompts\": [\n        \"actant-hub@code-assistant\"\n      ],\n      \"mcpServers\": [\n        {\n          \"name\": \"filesystem\",\n          \"command\": \"npx\",\n          \"args\": [\n            \"-y\",\n            \"@modelcontextprotocol/server-filesystem\",\n            \".\"\n          ]\n        }\n      ]\n    },\n    \"metadata\": {\n      \"category\": \"web-dev\",\n      \"difficulty\": \"beginner\"\n    }\n  },\n  {\n    \"name\": \"actant-hub@qa-engineer\",\n    \"version\": \"1.0.0\",\n    \"description\": \"A QA testing agent — writes tests, runs test suites, and reports quality issues\",\n    \"backend\": {\n      \"type\": \"claude-code\"\n    },\n    \"domainContext\": {\n      \"skills\": [\n        \"actant-hub@test-writer\"\n      ],\n      \"prompts\": [\n        \"actant-hub@qa-assistant\"\n      ],\n      \"mcpServers\": [\n        {\n          \"name\": \"filesystem\",\n          \"command\": \"npx\",\n          \"args\": [\n            \"-y\",\n            \"@modelcontextprotocol/server-filesystem\",\n            \".\"\n          ]\n        }\n      ]\n    },\n    \"metadata\": {\n      \"category\": \"web-dev\",\n      \"difficulty\": \"beginner\"\n    }\n  },\n  {\n    \"name\": \"actant-hub@doc-writer\",\n    \"version\": \"1.0.0\",\n    \"description\": \"A documen",
    "stderr": "",
    "elapsed": 394,
    "verdict": "PASS",
    "expect": "返回数组包含 qa-cursor-tpl、qa-claude-tpl、qa-pi-tpl、qa-rich-tpl、qa-sched-tpl、qa-sec-tpl"
  },
  {
    "id": "p2-tpl-show-cursor",
    "description": "[Phase 2 Template] 查看 cursor 模板详情",
    "command": "template show qa-cursor-tpl -f json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"qa-cursor-tpl\",\n  \"version\": \"1.0.0\",\n  \"description\": \"QA cursor backend - basic\",\n  \"backend\": {\n    \"type\": \"cursor\"\n  },\n  \"domainContext\": {\n    \"skills\": [],\n    \"prompts\": [],\n    \"mcpServers\": [],\n    \"subAgents\": [],\n    \"plugins\": []\n  }\n}",
    "stderr": "",
    "elapsed": 408,
    "verdict": "PASS",
    "expect": "返回 JSON，name=qa-cursor-tpl，version=1.0.0，backend.type=cursor"
  },
  {
    "id": "p2-tpl-show-pi",
    "description": "[Phase 2 Template] 查看 Pi 模板详情",
    "command": "template show qa-pi-tpl -f json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"qa-pi-tpl\",\n  \"version\": \"1.0.0\",\n  \"description\": \"QA Pi backend with LLM provider\",\n  \"backend\": {\n    \"type\": \"pi\"\n  },\n  \"provider\": {\n    \"type\": \"anthropic\",\n    \"config\": {\n      \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n    },\n    \"protocol\": \"anthropic\"\n  },\n  \"domainContext\": {\n    \"skills\": [],\n    \"prompts\": [],\n    \"mcpServers\": [],\n    \"subAgents\": [],\n    \"plugins\": []\n  }\n}",
    "stderr": "",
    "elapsed": 407,
    "verdict": "PASS",
    "expect": "返回 JSON，name=qa-pi-tpl，backend.type=pi，provider.type=anthropic"
  },
  {
    "id": "p2-tpl-show-sched",
    "description": "[Phase 2 Template] 查看 scheduler 模板详情",
    "command": "template show qa-sched-tpl -f json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"qa-sched-tpl\",\n  \"version\": \"1.0.0\",\n  \"description\": \"QA Pi backend with heartbeat scheduler\",\n  \"backend\": {\n    \"type\": \"pi\"\n  },\n  \"provider\": {\n    \"type\": \"anthropic\",\n    \"config\": {\n      \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n    },\n    \"protocol\": \"anthropic\"\n  },\n  \"domainContext\": {\n    \"skills\": [],\n    \"prompts\": [],\n    \"mcpServers\": [],\n    \"subAgents\": [],\n    \"plugins\": []\n  },\n  \"schedule\": {\n    \"heartbeat\": {\n      \"intervalMs\": 30000,\n      \"prompt\": \"Health check heartbeat\"\n    },\n    \"cron\": [],\n    \"hooks\": []\n  }\n}",
    "stderr": "",
    "elapsed": 406,
    "verdict": "PASS",
    "expect": "返回 JSON，包含 schedule.heartbeat.intervalMs=30000"
  },
  {
    "id": "p2-tpl-validate-valid",
    "description": "[Phase 2 Template] 验证合法模板文件",
    "command": "template validate C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\\fixtures/code-review-agent.json",
    "exitCode": 0,
    "stdout": "Valid — code-review-agent@1.0.0",
    "stderr": "",
    "elapsed": 408,
    "verdict": "PASS",
    "expect": "输出 Valid 或确认信息，包含模板名 code-review-agent，退出码 0"
  },
  {
    "id": "p2-tpl-load-file",
    "description": "[Phase 2 Template] 从文件加载模板",
    "command": "template load C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\\fixtures/code-review-agent.json",
    "exitCode": 0,
    "stdout": "Loaded code-review-agent@1.0.0",
    "stderr": "",
    "elapsed": 420,
    "verdict": "PASS",
    "expect": "成功加载，退出码 0"
  },
  {
    "id": "p2-tpl-list-after-load",
    "description": "[Phase 2 Template] 加载后列出（应为 7 个）",
    "command": "template list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"actant-hub@code-reviewer\",\n    \"version\": \"1.0.0\",\n    \"description\": \"A code review agent — systematic reviews with security, performance, and maintainability checks\",\n    \"backend\": {\n      \"type\": \"claude-code\"\n    },\n    \"domainContext\": {\n      \"skills\": [\n        \"actant-hub@code-review\"\n      ],\n      \"prompts\": [\n        \"actant-hub@code-assistant\"\n      ],\n      \"mcpServers\": [\n        {\n          \"name\": \"filesystem\",\n          \"command\": \"npx\",\n          \"args\": [\n            \"-y\",\n            \"@modelcontextprotocol/server-filesystem\",\n            \".\"\n          ]\n        }\n      ]\n    },\n    \"metadata\": {\n      \"category\": \"web-dev\",\n      \"difficulty\": \"beginner\"\n    }\n  },\n  {\n    \"name\": \"actant-hub@qa-engineer\",\n    \"version\": \"1.0.0\",\n    \"description\": \"A QA testing agent — writes tests, runs test suites, and reports quality issues\",\n    \"backend\": {\n      \"type\": \"claude-code\"\n    },\n    \"domainContext\": {\n      \"skills\": [\n        \"actant-hub@test-writer\"\n      ],\n      \"prompts\": [\n        \"actant-hub@qa-assistant\"\n      ],\n      \"mcpServers\": [\n        {\n          \"name\": \"filesystem\",\n          \"command\": \"npx\",\n          \"args\": [\n            \"-y\",\n            \"@modelcontextprotocol/server-filesystem\",\n            \".\"\n          ]\n        }\n      ]\n    },\n    \"metadata\": {\n      \"category\": \"web-dev\",\n      \"difficulty\": \"beginner\"\n    }\n  },\n  {\n    \"name\": \"actant-hub@doc-writer\",\n    \"version\": \"1.0.0\",\n    \"description\": \"A documen",
    "stderr": "",
    "elapsed": 407,
    "verdict": "PASS",
    "expect": "返回数组，现在包含 code-review-agent"
  },
  {
    "id": "p2-tpl-show-loaded",
    "description": "[Phase 2 Template] 查看刚加载的模板",
    "command": "template show code-review-agent -f json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"code-review-agent\",\n  \"version\": \"1.0.0\",\n  \"description\": \"A code review agent powered by Claude\",\n  \"backend\": {\n    \"type\": \"claude-code\",\n    \"config\": {\n      \"model\": \"claude-sonnet-4-20250514\"\n    }\n  },\n  \"provider\": {\n    \"type\": \"anthropic\",\n    \"config\": {\n      \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n    },\n    \"protocol\": \"anthropic\"\n  },\n  \"domainContext\": {\n    \"skills\": [\n      \"code-review\",\n      \"typescript-expert\"\n    ],\n    \"prompts\": [\n      \"system-code-reviewer\"\n    ],\n    \"mcpServers\": [\n      {\n        \"name\": \"filesystem\",\n        \"command\": \"npx\",\n        \"args\": [\n          \"-y\",\n          \"@anthropic/mcp-filesystem\"\n        ],\n        \"env\": {}\n      }\n    ],\n    \"workflow\": \"trellis-standard\",\n    \"subAgents\": [],\n    \"plugins\": []\n  },\n  \"initializer\": {\n    \"steps\": [\n      {\n        \"type\": \"create-workspace\"\n      },\n      {\n        \"type\": \"apply-workflow\"\n      }\n    ]\n  },\n  \"metadata\": {\n    \"author\": \"Actant Team\",\n    \"tags\": \"code-review,typescript\"\n  }\n}",
    "stderr": "",
    "elapsed": 405,
    "verdict": "PASS",
    "expect": "返回 JSON，name=code-review-agent，backend.type=claude-code，domainContext.skills 包含 code-review"
  },
  {
    "id": "p2-tpl-persist-check",
    "description": "[Phase 2 Template] 白盒验证模板持久化",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/configs/templates/code-review-agent.json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"code-review-agent\",\n  \"version\": \"1.0.0\",\n  \"description\": \"A code review agent powered by Claude\",\n  \"backend\": {\n    \"type\": \"claude-code\",\n    \"config\": {\n      \"model\": \"claude-sonnet-4-20250514\"\n    }\n  },\n  \"provider\": {\n    \"type\": \"anthropic\",\n    \"config\": {\n      \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n    },\n    \"protocol\": \"anthropic\"\n  },\n  \"domainContext\": {\n    \"skills\": [\n      \"code-review\",\n      \"typescript-expert\"\n    ],\n    \"prompts\": [\n      \"system-code-reviewer\"\n    ],\n    \"mcpServers\": [\n      {\n        \"name\": \"filesystem\",\n        \"command\": \"npx\",\n        \"args\": [\n          \"-y\",\n          \"@anthropic/mcp-filesystem\"\n        ],\n        \"env\": {}\n      }\n    ],\n    \"workflow\": \"trellis-standard\",\n    \"subAgents\": [],\n    \"plugins\": []\n  },\n  \"initializer\": {\n    \"steps\": [\n      {\n        \"type\": \"create-workspace\"\n      },\n      {\n        \"type\": \"apply-workflow\"\n      }\n    ]\n  },\n  \"metadata\": {\n    \"author\": \"Actant Team\",\n    \"tags\": \"code-review,typescript\"\n  }\n}\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "文件存在且为合法 JSON，包含 name=code-review-agent"
  },
  {
    "id": "p2-tpl-validate-invalid",
    "description": "[Phase 2 Template] 验证无效模板文件",
    "command": "template validate C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\\fixtures/invalid-template.json",
    "exitCode": 1,
    "stdout": "",
    "stderr": "Invalid template\n  - name: Invalid input: expected string, received undefined\n  - version: Invalid input: expected string, received undefined\n  - backend: Invalid input: expected object, received undefined\n  - domainContext: Invalid input: expected object, received undefined",
    "elapsed": 421,
    "verdict": "PASS",
    "expect": "退出码非 0 或输出 Invalid/errors 信息"
  },
  {
    "id": "p2-tpl-validate-nofile",
    "description": "[Phase 2 Template] 验证不存在的文件",
    "command": "template validate /tmp/nonexistent-qa-file-xyz-99999.json",
    "exitCode": 1,
    "stdout": "",
    "stderr": "Invalid template\n  - : Configuration file not found: g:\\tmp\\nonexistent-qa-file-xyz-99999.json",
    "elapsed": 409,
    "verdict": "PASS",
    "expect": "退出码非 0，错误信息提示文件不存在或无法读取"
  },
  {
    "id": "p2-tpl-show-nonexist",
    "description": "[Phase 2 Template] 查看不存在的模板",
    "command": "template show nonexistent-tpl-xyz-99",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32001] Template \"nonexistent-tpl-xyz-99\" not found in registry\n  Context: {\"templateName\":\"nonexistent-tpl-xyz-99\"}",
    "elapsed": 405,
    "verdict": "PASS",
    "expect": "退出码非 0，错误信息提示模板不存在"
  },
  {
    "id": "p3-skill-list-init",
    "description": "[Phase 3 Skill] 列出 skills（初始状态）",
    "command": "skill list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"actant-hub@code-review\",\n    \"version\": \"1.0.0\",\n    \"description\": \"Systematic code review skill — guides agents through structured, thorough code reviews.\",\n    \"tags\": [\n      \"code-quality\",\n      \"review\",\n      \"best-practices\"\n    ],\n    \"license\": \"MIT\",\n    \"content\": \"# Code Review Skill\\n\\nYou are a systematic code reviewer. Follow this structured approach for every code review.\\n\\n## Review Checklist\\n\\n### 1. Correctness\\n- Does the code do what it claims?\\n- Are edge cases handled (null, empty, boundary values)?\\n- Are error paths properly handled?\\n\\n### 2. Security\\n- No hardcoded secrets or credentials\\n- Input validation on all external data\\n- Proper escaping for SQL, HTML, shell commands\\n- Principle of least privilege for permissions\\n\\n### 3. Performance\\n- No unnecessary allocations in hot paths\\n- Appropriate data structures for the use case\\n- Database queries are indexed and bounded\\n- No N+1 query patterns\\n\\n### 4. Maintainability\\n- Clear naming that reveals intent\\n- Functions do one thing and do it well\\n- No magic numbers — use named constants\\n- Dependencies are explicit, not implicit\\n\\n### 5. Testing\\n- New code has corresponding tests\\n- Tests cover both happy path and error cases\\n- Tests are deterministic (no flaky timing dependencies)\\n- Test names describe the behavior being verified\\n\\n## Review Output Format\\n\\nFor each finding, provide:\\n1. **Severity**: critical / warning / suggestion / nitpick\\n2. **Location**: f",
    "stderr": "",
    "elapsed": 406,
    "verdict": "PASS",
    "expect": "返回数组（可能为空或含 source 加载的 skill），退出码 0"
  },
  {
    "id": "p3-skill-add-1",
    "description": "[Phase 3 Skill] 添加 code-review skill",
    "command": "skill add C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\\fixtures/code-review.json",
    "exitCode": 0,
    "stdout": "Skill \"code-review\" added successfully.",
    "stderr": "",
    "elapsed": 406,
    "verdict": "PASS",
    "expect": "成功添加，退出码 0"
  },
  {
    "id": "p3-skill-add-2",
    "description": "[Phase 3 Skill] 添加 typescript-expert skill",
    "command": "skill add C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\\fixtures/typescript-expert.json",
    "exitCode": 0,
    "stdout": "Skill \"typescript-expert\" added successfully.",
    "stderr": "",
    "elapsed": 407,
    "verdict": "PASS",
    "expect": "成功添加，退出码 0"
  },
  {
    "id": "p3-skill-list-two",
    "description": "[Phase 3 Skill] 添加后列出（至少 2 个）",
    "command": "skill list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"actant-hub@code-review\",\n    \"version\": \"1.0.0\",\n    \"description\": \"Systematic code review skill — guides agents through structured, thorough code reviews.\",\n    \"tags\": [\n      \"code-quality\",\n      \"review\",\n      \"best-practices\"\n    ],\n    \"license\": \"MIT\",\n    \"content\": \"# Code Review Skill\\n\\nYou are a systematic code reviewer. Follow this structured approach for every code review.\\n\\n## Review Checklist\\n\\n### 1. Correctness\\n- Does the code do what it claims?\\n- Are edge cases handled (null, empty, boundary values)?\\n- Are error paths properly handled?\\n\\n### 2. Security\\n- No hardcoded secrets or credentials\\n- Input validation on all external data\\n- Proper escaping for SQL, HTML, shell commands\\n- Principle of least privilege for permissions\\n\\n### 3. Performance\\n- No unnecessary allocations in hot paths\\n- Appropriate data structures for the use case\\n- Database queries are indexed and bounded\\n- No N+1 query patterns\\n\\n### 4. Maintainability\\n- Clear naming that reveals intent\\n- Functions do one thing and do it well\\n- No magic numbers — use named constants\\n- Dependencies are explicit, not implicit\\n\\n### 5. Testing\\n- New code has corresponding tests\\n- Tests cover both happy path and error cases\\n- Tests are deterministic (no flaky timing dependencies)\\n- Test names describe the behavior being verified\\n\\n## Review Output Format\\n\\nFor each finding, provide:\\n1. **Severity**: critical / warning / suggestion / nitpick\\n2. **Location**: f",
    "stderr": "",
    "elapsed": 406,
    "verdict": "PASS",
    "expect": "返回数组，包含 code-review 和 typescript-expert"
  },
  {
    "id": "p3-skill-show-1",
    "description": "[Phase 3 Skill] 查看 code-review 详情",
    "command": "skill show code-review -f json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"code-review\",\n  \"description\": \"Rules and guidelines for reviewing code quality\",\n  \"content\": \"## Code Review Checklist\\n\\n- Check for proper error handling (try/catch, error boundaries)\\n- Verify type safety (no `any`, proper generics)\\n- Review naming conventions (descriptive, consistent casing)\\n- Look for potential performance issues (unnecessary re-renders, N+1 queries)\\n- Ensure tests cover edge cases\\n- Validate input/output contracts match API specs\\n- Check for security vulnerabilities (injection, XSS, auth bypass)\",\n  \"tags\": [\n    \"review\",\n    \"quality\",\n    \"best-practices\"\n  ]\n}",
    "stderr": "",
    "elapsed": 405,
    "verdict": "PASS",
    "expect": "返回 JSON，name=code-review，content 包含 Code Review Checklist，tags 包含 review"
  },
  {
    "id": "p3-skill-show-2",
    "description": "[Phase 3 Skill] 查看 typescript-expert 详情",
    "command": "skill show typescript-expert -f json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"typescript-expert\",\n  \"description\": \"TypeScript best practices and advanced patterns\",\n  \"content\": \"## TypeScript Best Practices\\n\\n- Use strict mode (`strict: true` in tsconfig)\\n- Prefer interfaces over type aliases for object shapes\\n- Use discriminated unions for state machines and variant types\\n- Avoid `any`, prefer `unknown` with type guards\\n- Use `satisfies` operator for type-safe object literals\\n- Leverage template literal types for string patterns\\n- Use `const` assertions for literal types\\n- Prefer `readonly` for immutable data structures\",\n  \"tags\": [\n    \"typescript\",\n    \"patterns\",\n    \"best-practices\"\n  ]\n}",
    "stderr": "",
    "elapsed": 406,
    "verdict": "PASS",
    "expect": "返回 JSON，name=typescript-expert，content 包含 TypeScript Best Practices"
  },
  {
    "id": "p3-skill-export",
    "description": "[Phase 3 Skill] 导出 code-review 到文件",
    "command": "skill export code-review -o C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/exported-skill.json",
    "exitCode": 0,
    "stdout": "Skill \"code-review\" exported to C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/exported-skill.json",
    "stderr": "",
    "elapsed": 410,
    "verdict": "PASS",
    "expect": "成功导出，退出码 0"
  },
  {
    "id": "p3-skill-verify-export",
    "description": "[Phase 3 Skill] 白盒验证导出文件",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/exported-skill.json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"code-review\",\n  \"description\": \"Rules and guidelines for reviewing code quality\",\n  \"content\": \"## Code Review Checklist\\n\\n- Check for proper error handling (try/catch, error boundaries)\\n- Verify type safety (no `any`, proper generics)\\n- Review naming conventions (descriptive, consistent casing)\\n- Look for potential performance issues (unnecessary re-renders, N+1 queries)\\n- Ensure tests cover edge cases\\n- Validate input/output contracts match API specs\\n- Check for security vulnerabilities (injection, XSS, auth bypass)\",\n  \"tags\": [\n    \"review\",\n    \"quality\",\n    \"best-practices\"\n  ]\n}\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "文件为合法 JSON，包含 name=code-review 和 content 字段"
  },
  {
    "id": "p3-skill-remove",
    "description": "[Phase 3 Skill] 移除 code-review",
    "command": "skill remove code-review",
    "exitCode": 0,
    "stdout": "Skill \"code-review\" removed.",
    "stderr": "",
    "elapsed": 407,
    "verdict": "PASS",
    "expect": "成功移除，退出码 0"
  },
  {
    "id": "p3-skill-list-after-rm",
    "description": "[Phase 3 Skill] 移除后列出",
    "command": "skill list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"actant-hub@code-review\",\n    \"version\": \"1.0.0\",\n    \"description\": \"Systematic code review skill — guides agents through structured, thorough code reviews.\",\n    \"tags\": [\n      \"code-quality\",\n      \"review\",\n      \"best-practices\"\n    ],\n    \"license\": \"MIT\",\n    \"content\": \"# Code Review Skill\\n\\nYou are a systematic code reviewer. Follow this structured approach for every code review.\\n\\n## Review Checklist\\n\\n### 1. Correctness\\n- Does the code do what it claims?\\n- Are edge cases handled (null, empty, boundary values)?\\n- Are error paths properly handled?\\n\\n### 2. Security\\n- No hardcoded secrets or credentials\\n- Input validation on all external data\\n- Proper escaping for SQL, HTML, shell commands\\n- Principle of least privilege for permissions\\n\\n### 3. Performance\\n- No unnecessary allocations in hot paths\\n- Appropriate data structures for the use case\\n- Database queries are indexed and bounded\\n- No N+1 query patterns\\n\\n### 4. Maintainability\\n- Clear naming that reveals intent\\n- Functions do one thing and do it well\\n- No magic numbers — use named constants\\n- Dependencies are explicit, not implicit\\n\\n### 5. Testing\\n- New code has corresponding tests\\n- Tests cover both happy path and error cases\\n- Tests are deterministic (no flaky timing dependencies)\\n- Test names describe the behavior being verified\\n\\n## Review Output Format\\n\\nFor each finding, provide:\\n1. **Severity**: critical / warning / suggestion / nitpick\\n2. **Location**: f",
    "stderr": "",
    "elapsed": 407,
    "verdict": "PASS",
    "expect": "code-review 已不在列表中，typescript-expert 仍存在"
  },
  {
    "id": "p3-skill-reimport",
    "description": "[Phase 3 Skill] 从导出文件重新导入（roundtrip 验证）",
    "command": "skill add C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/exported-skill.json",
    "exitCode": 0,
    "stdout": "Skill \"code-review\" added successfully.",
    "stderr": "",
    "elapsed": 409,
    "verdict": "PASS",
    "expect": "成功导入，退出码 0"
  },
  {
    "id": "p3-skill-show-reimport",
    "description": "[Phase 3 Skill] 验证 roundtrip 后数据完整",
    "command": "skill show code-review -f json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"code-review\",\n  \"description\": \"Rules and guidelines for reviewing code quality\",\n  \"content\": \"## Code Review Checklist\\n\\n- Check for proper error handling (try/catch, error boundaries)\\n- Verify type safety (no `any`, proper generics)\\n- Review naming conventions (descriptive, consistent casing)\\n- Look for potential performance issues (unnecessary re-renders, N+1 queries)\\n- Ensure tests cover edge cases\\n- Validate input/output contracts match API specs\\n- Check for security vulnerabilities (injection, XSS, auth bypass)\",\n  \"tags\": [\n    \"review\",\n    \"quality\",\n    \"best-practices\"\n  ]\n}",
    "stderr": "",
    "elapsed": 391,
    "verdict": "PASS",
    "expect": "返回 JSON，name=code-review，content 与原始一致"
  },
  {
    "id": "p3-prompt-list-init",
    "description": "[Phase 3 Prompt] 列出 prompts（初始状态）",
    "command": "prompt list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"actant-hub@code-assistant\",\n    \"version\": \"1.0.0\",\n    \"description\": \"System prompt for a general-purpose code assistant agent\",\n    \"tags\": [\n      \"coding\",\n      \"assistant\",\n      \"general\"\n    ],\n    \"content\": \"You are a senior software engineer acting as a code assistant. Your role is to help developers write, review, debug, and improve code.\\n\\n## Guidelines\\n\\n- Write clean, idiomatic code following the language's conventions\\n- Explain your reasoning when making design decisions\\n- Suggest tests for any new code you write\\n- When fixing bugs, explain the root cause before showing the fix\\n- Prefer simple solutions over clever ones\\n- If a request is ambiguous, ask for clarification before proceeding\\n- Always consider error handling and edge cases\\n- Use TypeScript strict mode conventions when writing TypeScript\\n- Follow the project's existing patterns and conventions\",\n    \"variables\": [\n      \"language\",\n      \"framework\"\n    ]\n  },\n  {\n    \"name\": \"actant-hub@qa-assistant\",\n    \"version\": \"1.0.0\",\n    \"description\": \"System prompt for a QA testing assistant agent\",\n    \"tags\": [\n      \"testing\",\n      \"qa\",\n      \"quality\"\n    ],\n    \"content\": \"You are a QA engineer focused on finding bugs and ensuring software quality. Your role is to systematically test software, identify issues, and report them clearly.\\n\\n## Guidelines\\n\\n- Think like a user: test realistic scenarios, not just technical edge cases\\n- Verify both happy paths and failure ",
    "stderr": "",
    "elapsed": 541,
    "verdict": "PASS",
    "expect": "返回数组，退出码 0"
  },
  {
    "id": "p3-prompt-add",
    "description": "[Phase 3 Prompt] 添加 system-code-reviewer",
    "command": "prompt add C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\\fixtures/system-code-reviewer.json",
    "exitCode": 0,
    "stdout": "Prompt \"system-code-reviewer\" added successfully.",
    "stderr": "",
    "elapsed": 406,
    "verdict": "PASS",
    "expect": "成功添加，退出码 0"
  },
  {
    "id": "p3-prompt-list-after",
    "description": "[Phase 3 Prompt] 添加后列出",
    "command": "prompt list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"actant-hub@code-assistant\",\n    \"version\": \"1.0.0\",\n    \"description\": \"System prompt for a general-purpose code assistant agent\",\n    \"tags\": [\n      \"coding\",\n      \"assistant\",\n      \"general\"\n    ],\n    \"content\": \"You are a senior software engineer acting as a code assistant. Your role is to help developers write, review, debug, and improve code.\\n\\n## Guidelines\\n\\n- Write clean, idiomatic code following the language's conventions\\n- Explain your reasoning when making design decisions\\n- Suggest tests for any new code you write\\n- When fixing bugs, explain the root cause before showing the fix\\n- Prefer simple solutions over clever ones\\n- If a request is ambiguous, ask for clarification before proceeding\\n- Always consider error handling and edge cases\\n- Use TypeScript strict mode conventions when writing TypeScript\\n- Follow the project's existing patterns and conventions\",\n    \"variables\": [\n      \"language\",\n      \"framework\"\n    ]\n  },\n  {\n    \"name\": \"actant-hub@qa-assistant\",\n    \"version\": \"1.0.0\",\n    \"description\": \"System prompt for a QA testing assistant agent\",\n    \"tags\": [\n      \"testing\",\n      \"qa\",\n      \"quality\"\n    ],\n    \"content\": \"You are a QA engineer focused on finding bugs and ensuring software quality. Your role is to systematically test software, identify issues, and report them clearly.\\n\\n## Guidelines\\n\\n- Think like a user: test realistic scenarios, not just technical edge cases\\n- Verify both happy paths and failure ",
    "stderr": "",
    "elapsed": 408,
    "verdict": "PASS",
    "expect": "返回数组包含 system-code-reviewer"
  },
  {
    "id": "p3-prompt-show",
    "description": "[Phase 3 Prompt] 查看详情",
    "command": "prompt show system-code-reviewer -f json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"system-code-reviewer\",\n  \"description\": \"System prompt for a code review agent\",\n  \"content\": \"You are a senior code reviewer for the {{project}} project.\\n\\nYour responsibilities:\\n1. Review code changes for correctness, performance, and maintainability\\n2. Identify potential bugs, security issues, and anti-patterns\\n3. Suggest improvements with concrete code examples\\n4. Ensure coding standards and conventions are followed\\n5. Verify test coverage for new functionality\\n\\nWhen reviewing:\\n- Be constructive and specific in feedback\\n- Explain the 'why' behind suggestions\\n- Prioritize issues by severity (critical > major > minor > style)\\n- Acknowledge good patterns and improvements\",\n  \"variables\": [\n    \"project\"\n  ]\n}",
    "stderr": "",
    "elapsed": 405,
    "verdict": "PASS",
    "expect": "返回 JSON，name=system-code-reviewer，content 包含 senior code reviewer，variables 包含 project"
  },
  {
    "id": "p3-prompt-export",
    "description": "[Phase 3 Prompt] 导出到文件",
    "command": "prompt export system-code-reviewer -o C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/exported-prompt.json",
    "exitCode": 0,
    "stdout": "Prompt \"system-code-reviewer\" exported to C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/exported-prompt.json",
    "stderr": "",
    "elapsed": 407,
    "verdict": "PASS",
    "expect": "成功导出，退出码 0"
  },
  {
    "id": "p3-prompt-verify-export",
    "description": "[Phase 3 Prompt] 白盒验证导出文件",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/exported-prompt.json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"system-code-reviewer\",\n  \"description\": \"System prompt for a code review agent\",\n  \"content\": \"You are a senior code reviewer for the {{project}} project.\\n\\nYour responsibilities:\\n1. Review code changes for correctness, performance, and maintainability\\n2. Identify potential bugs, security issues, and anti-patterns\\n3. Suggest improvements with concrete code examples\\n4. Ensure coding standards and conventions are followed\\n5. Verify test coverage for new functionality\\n\\nWhen reviewing:\\n- Be constructive and specific in feedback\\n- Explain the 'why' behind suggestions\\n- Prioritize issues by severity (critical > major > minor > style)\\n- Acknowledge good patterns and improvements\",\n  \"variables\": [\n    \"project\"\n  ]\n}\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "合法 JSON，包含 name=system-code-reviewer 和 content"
  },
  {
    "id": "p3-prompt-remove",
    "description": "[Phase 3 Prompt] 移除",
    "command": "prompt remove system-code-reviewer",
    "exitCode": 0,
    "stdout": "Prompt \"system-code-reviewer\" removed.",
    "stderr": "",
    "elapsed": 419,
    "verdict": "PASS",
    "expect": "成功移除，退出码 0"
  },
  {
    "id": "p3-prompt-list-after-rm",
    "description": "[Phase 3 Prompt] 移除后确认",
    "command": "prompt list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"actant-hub@code-assistant\",\n    \"version\": \"1.0.0\",\n    \"description\": \"System prompt for a general-purpose code assistant agent\",\n    \"tags\": [\n      \"coding\",\n      \"assistant\",\n      \"general\"\n    ],\n    \"content\": \"You are a senior software engineer acting as a code assistant. Your role is to help developers write, review, debug, and improve code.\\n\\n## Guidelines\\n\\n- Write clean, idiomatic code following the language's conventions\\n- Explain your reasoning when making design decisions\\n- Suggest tests for any new code you write\\n- When fixing bugs, explain the root cause before showing the fix\\n- Prefer simple solutions over clever ones\\n- If a request is ambiguous, ask for clarification before proceeding\\n- Always consider error handling and edge cases\\n- Use TypeScript strict mode conventions when writing TypeScript\\n- Follow the project's existing patterns and conventions\",\n    \"variables\": [\n      \"language\",\n      \"framework\"\n    ]\n  },\n  {\n    \"name\": \"actant-hub@qa-assistant\",\n    \"version\": \"1.0.0\",\n    \"description\": \"System prompt for a QA testing assistant agent\",\n    \"tags\": [\n      \"testing\",\n      \"qa\",\n      \"quality\"\n    ],\n    \"content\": \"You are a QA engineer focused on finding bugs and ensuring software quality. Your role is to systematically test software, identify issues, and report them clearly.\\n\\n## Guidelines\\n\\n- Think like a user: test realistic scenarios, not just technical edge cases\\n- Verify both happy paths and failure ",
    "stderr": "",
    "elapsed": 406,
    "verdict": "PASS",
    "expect": "system-code-reviewer 已不在列表中"
  },
  {
    "id": "p3-prompt-reimport",
    "description": "[Phase 3 Prompt] 从导出文件重新导入",
    "command": "prompt add C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/exported-prompt.json",
    "exitCode": 0,
    "stdout": "Prompt \"system-code-reviewer\" added successfully.",
    "stderr": "",
    "elapsed": 406,
    "verdict": "PASS",
    "expect": "成功导入，退出码 0"
  },
  {
    "id": "p3-prompt-show-reimport",
    "description": "[Phase 3 Prompt] 验证 roundtrip 数据完整",
    "command": "prompt show system-code-reviewer -f json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"system-code-reviewer\",\n  \"description\": \"System prompt for a code review agent\",\n  \"content\": \"You are a senior code reviewer for the {{project}} project.\\n\\nYour responsibilities:\\n1. Review code changes for correctness, performance, and maintainability\\n2. Identify potential bugs, security issues, and anti-patterns\\n3. Suggest improvements with concrete code examples\\n4. Ensure coding standards and conventions are followed\\n5. Verify test coverage for new functionality\\n\\nWhen reviewing:\\n- Be constructive and specific in feedback\\n- Explain the 'why' behind suggestions\\n- Prioritize issues by severity (critical > major > minor > style)\\n- Acknowledge good patterns and improvements\",\n  \"variables\": [\n    \"project\"\n  ]\n}",
    "stderr": "",
    "elapsed": 406,
    "verdict": "PASS",
    "expect": "返回 JSON 与原始一致，content 包含 senior code reviewer"
  },
  {
    "id": "p3-mcp-list-init",
    "description": "[Phase 3 MCP] 列出 MCP 配置（初始状态）",
    "command": "mcp list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"actant-hub@filesystem\",\n    \"version\": \"1.0.0\",\n    \"description\": \"File system access MCP server — read, write, search, and navigate project files\",\n    \"tags\": [\n      \"fs\",\n      \"files\",\n      \"essential\"\n    ],\n    \"command\": \"npx\",\n    \"args\": [\n      \"-y\",\n      \"@modelcontextprotocol/server-filesystem\",\n      \".\"\n    ],\n    \"env\": {}\n  },\n  {\n    \"name\": \"actant-hub@memory-server\",\n    \"version\": \"1.0.0\",\n    \"description\": \"Persistent memory MCP server — knowledge graph for long-term agent context\",\n    \"tags\": [\n      \"memory\",\n      \"knowledge-graph\",\n      \"persistence\"\n    ],\n    \"command\": \"npx\",\n    \"args\": [\n      \"-y\",\n      \"@modelcontextprotocol/server-memory\"\n    ],\n    \"env\": {}\n  }\n]",
    "stderr": "",
    "elapsed": 423,
    "verdict": "PASS",
    "expect": "返回数组，退出码 0"
  },
  {
    "id": "p3-mcp-add",
    "description": "[Phase 3 MCP] 添加 filesystem MCP",
    "command": "mcp add C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\\fixtures/filesystem.json",
    "exitCode": 0,
    "stdout": "MCP \"filesystem\" added successfully.",
    "stderr": "",
    "elapsed": 390,
    "verdict": "PASS",
    "expect": "成功添加，退出码 0"
  },
  {
    "id": "p3-mcp-list-after",
    "description": "[Phase 3 MCP] 添加后列出",
    "command": "mcp list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"actant-hub@filesystem\",\n    \"version\": \"1.0.0\",\n    \"description\": \"File system access MCP server — read, write, search, and navigate project files\",\n    \"tags\": [\n      \"fs\",\n      \"files\",\n      \"essential\"\n    ],\n    \"command\": \"npx\",\n    \"args\": [\n      \"-y\",\n      \"@modelcontextprotocol/server-filesystem\",\n      \".\"\n    ],\n    \"env\": {}\n  },\n  {\n    \"name\": \"actant-hub@memory-server\",\n    \"version\": \"1.0.0\",\n    \"description\": \"Persistent memory MCP server — knowledge graph for long-term agent context\",\n    \"tags\": [\n      \"memory\",\n      \"knowledge-graph\",\n      \"persistence\"\n    ],\n    \"command\": \"npx\",\n    \"args\": [\n      \"-y\",\n      \"@modelcontextprotocol/server-memory\"\n    ],\n    \"env\": {}\n  },\n  {\n    \"name\": \"filesystem\",\n    \"description\": \"MCP server for filesystem access within the workspace\",\n    \"command\": \"npx\",\n    \"args\": [\n      \"-y\",\n      \"@anthropic/mcp-filesystem\"\n    ],\n    \"env\": {\n      \"ROOT_DIR\": \"/workspace\"\n    }\n  }\n]",
    "stderr": "",
    "elapsed": 388,
    "verdict": "PASS",
    "expect": "返回数组包含 filesystem"
  },
  {
    "id": "p3-mcp-show",
    "description": "[Phase 3 MCP] 查看详情",
    "command": "mcp show filesystem -f json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"filesystem\",\n  \"description\": \"MCP server for filesystem access within the workspace\",\n  \"command\": \"npx\",\n  \"args\": [\n    \"-y\",\n    \"@anthropic/mcp-filesystem\"\n  ],\n  \"env\": {\n    \"ROOT_DIR\": \"/workspace\"\n  }\n}",
    "stderr": "",
    "elapsed": 391,
    "verdict": "PASS",
    "expect": "返回 JSON，name=filesystem，command=npx，args 包含 @anthropic/mcp-filesystem"
  },
  {
    "id": "p3-mcp-export",
    "description": "[Phase 3 MCP] 导出到文件",
    "command": "mcp export filesystem -o C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/exported-mcp.json",
    "exitCode": 0,
    "stdout": "MCP \"filesystem\" exported to C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/exported-mcp.json",
    "stderr": "",
    "elapsed": 407,
    "verdict": "PASS",
    "expect": "成功导出，退出码 0"
  },
  {
    "id": "p3-mcp-verify-export",
    "description": "[Phase 3 MCP] 白盒验证导出文件",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/exported-mcp.json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"filesystem\",\n  \"description\": \"MCP server for filesystem access within the workspace\",\n  \"command\": \"npx\",\n  \"args\": [\n    \"-y\",\n    \"@anthropic/mcp-filesystem\"\n  ],\n  \"env\": {\n    \"ROOT_DIR\": \"/workspace\"\n  }\n}\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "合法 JSON，包含 name=filesystem 和 command=npx"
  },
  {
    "id": "p3-mcp-remove",
    "description": "[Phase 3 MCP] 移除",
    "command": "mcp remove filesystem",
    "exitCode": 0,
    "stdout": "MCP \"filesystem\" removed.",
    "stderr": "",
    "elapsed": 398,
    "verdict": "PASS",
    "expect": "成功移除，退出码 0"
  },
  {
    "id": "p3-mcp-list-after-rm",
    "description": "[Phase 3 MCP] 移除后确认",
    "command": "mcp list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"actant-hub@filesystem\",\n    \"version\": \"1.0.0\",\n    \"description\": \"File system access MCP server — read, write, search, and navigate project files\",\n    \"tags\": [\n      \"fs\",\n      \"files\",\n      \"essential\"\n    ],\n    \"command\": \"npx\",\n    \"args\": [\n      \"-y\",\n      \"@modelcontextprotocol/server-filesystem\",\n      \".\"\n    ],\n    \"env\": {}\n  },\n  {\n    \"name\": \"actant-hub@memory-server\",\n    \"version\": \"1.0.0\",\n    \"description\": \"Persistent memory MCP server — knowledge graph for long-term agent context\",\n    \"tags\": [\n      \"memory\",\n      \"knowledge-graph\",\n      \"persistence\"\n    ],\n    \"command\": \"npx\",\n    \"args\": [\n      \"-y\",\n      \"@modelcontextprotocol/server-memory\"\n    ],\n    \"env\": {}\n  }\n]",
    "stderr": "",
    "elapsed": 403,
    "verdict": "PASS",
    "expect": "filesystem 已不在列表中"
  },
  {
    "id": "p3-mcp-reimport",
    "description": "[Phase 3 MCP] 从导出文件重新导入",
    "command": "mcp add C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/exported-mcp.json",
    "exitCode": 0,
    "stdout": "MCP \"filesystem\" added successfully.",
    "stderr": "",
    "elapsed": 390,
    "verdict": "PASS",
    "expect": "成功导入，退出码 0"
  },
  {
    "id": "p3-mcp-show-reimport",
    "description": "[Phase 3 MCP] 验证 roundtrip 数据完整",
    "command": "mcp show filesystem -f json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"filesystem\",\n  \"description\": \"MCP server for filesystem access within the workspace\",\n  \"command\": \"npx\",\n  \"args\": [\n    \"-y\",\n    \"@anthropic/mcp-filesystem\"\n  ],\n  \"env\": {\n    \"ROOT_DIR\": \"/workspace\"\n  }\n}",
    "stderr": "",
    "elapsed": 419,
    "verdict": "PASS",
    "expect": "返回 JSON 与原始一致"
  },
  {
    "id": "p3-wf-list-init",
    "description": "[Phase 3 Workflow] 列出 workflows（初始状态）",
    "command": "workflow list -f json",
    "exitCode": 0,
    "stdout": "[]",
    "stderr": "",
    "elapsed": 407,
    "verdict": "PASS",
    "expect": "返回数组，退出码 0"
  },
  {
    "id": "p3-wf-add",
    "description": "[Phase 3 Workflow] 添加 trellis-standard",
    "command": "workflow add C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\\fixtures/trellis-standard.json",
    "exitCode": 0,
    "stdout": "Workflow \"trellis-standard\" added successfully.",
    "stderr": "",
    "elapsed": 391,
    "verdict": "PASS",
    "expect": "成功添加，退出码 0"
  },
  {
    "id": "p3-wf-list-after",
    "description": "[Phase 3 Workflow] 添加后列出",
    "command": "workflow list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"trellis-standard\",\n    \"description\": \"Standard Trellis development workflow\",\n    \"content\": \"# Development Workflow\\n\\n## Quick Start\\n\\n1. **Read context** — Understand current project state\\n2. **Plan** — Break down the task into actionable steps\\n3. **Implement** — Write code following project guidelines\\n4. **Test** — Run lint, type-check, and tests\\n5. **Record** — Document changes in session journal\\n\\n## Code Quality Checklist\\n\\n- [ ] Lint checks pass\\n- [ ] Type checks pass\\n- [ ] Tests pass\\n- [ ] No `any` types introduced\\n- [ ] Error handling is comprehensive\\n- [ ] Changes documented if needed\"\n  }\n]",
    "stderr": "",
    "elapsed": 391,
    "verdict": "PASS",
    "expect": "返回数组包含 trellis-standard"
  },
  {
    "id": "p3-wf-show",
    "description": "[Phase 3 Workflow] 查看详情",
    "command": "workflow show trellis-standard -f json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"trellis-standard\",\n  \"description\": \"Standard Trellis development workflow\",\n  \"content\": \"# Development Workflow\\n\\n## Quick Start\\n\\n1. **Read context** — Understand current project state\\n2. **Plan** — Break down the task into actionable steps\\n3. **Implement** — Write code following project guidelines\\n4. **Test** — Run lint, type-check, and tests\\n5. **Record** — Document changes in session journal\\n\\n## Code Quality Checklist\\n\\n- [ ] Lint checks pass\\n- [ ] Type checks pass\\n- [ ] Tests pass\\n- [ ] No `any` types introduced\\n- [ ] Error handling is comprehensive\\n- [ ] Changes documented if needed\"\n}",
    "stderr": "",
    "elapsed": 406,
    "verdict": "PASS",
    "expect": "返回 JSON，name=trellis-standard，content 包含 Development Workflow"
  },
  {
    "id": "p3-wf-export",
    "description": "[Phase 3 Workflow] 导出到文件",
    "command": "workflow export trellis-standard -o C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/exported-wf.json",
    "exitCode": 0,
    "stdout": "Workflow \"trellis-standard\" exported to C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/exported-wf.json",
    "stderr": "",
    "elapsed": 392,
    "verdict": "PASS",
    "expect": "成功导出，退出码 0"
  },
  {
    "id": "p3-wf-verify-export",
    "description": "[Phase 3 Workflow] 白盒验证导出文件",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/exported-wf.json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"trellis-standard\",\n  \"description\": \"Standard Trellis development workflow\",\n  \"content\": \"# Development Workflow\\n\\n## Quick Start\\n\\n1. **Read context** — Understand current project state\\n2. **Plan** — Break down the task into actionable steps\\n3. **Implement** — Write code following project guidelines\\n4. **Test** — Run lint, type-check, and tests\\n5. **Record** — Document changes in session journal\\n\\n## Code Quality Checklist\\n\\n- [ ] Lint checks pass\\n- [ ] Type checks pass\\n- [ ] Tests pass\\n- [ ] No `any` types introduced\\n- [ ] Error handling is comprehensive\\n- [ ] Changes documented if needed\"\n}\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "合法 JSON，包含 name=trellis-standard"
  },
  {
    "id": "p3-wf-remove",
    "description": "[Phase 3 Workflow] 移除",
    "command": "workflow remove trellis-standard",
    "exitCode": 0,
    "stdout": "Workflow \"trellis-standard\" removed.",
    "stderr": "",
    "elapsed": 387,
    "verdict": "PASS",
    "expect": "成功移除，退出码 0"
  },
  {
    "id": "p3-wf-list-after-rm",
    "description": "[Phase 3 Workflow] 移除后确认",
    "command": "workflow list -f json",
    "exitCode": 0,
    "stdout": "[]",
    "stderr": "",
    "elapsed": 392,
    "verdict": "PASS",
    "expect": "trellis-standard 已不在列表中"
  },
  {
    "id": "p3-wf-reimport",
    "description": "[Phase 3 Workflow] 从导出文件重新导入",
    "command": "workflow add C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/exported-wf.json",
    "exitCode": 0,
    "stdout": "Workflow \"trellis-standard\" added successfully.",
    "stderr": "",
    "elapsed": 391,
    "verdict": "PASS",
    "expect": "成功导入，退出码 0"
  },
  {
    "id": "p3-wf-show-reimport",
    "description": "[Phase 3 Workflow] 验证 roundtrip 数据完整",
    "command": "workflow show trellis-standard -f json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"trellis-standard\",\n  \"description\": \"Standard Trellis development workflow\",\n  \"content\": \"# Development Workflow\\n\\n## Quick Start\\n\\n1. **Read context** — Understand current project state\\n2. **Plan** — Break down the task into actionable steps\\n3. **Implement** — Write code following project guidelines\\n4. **Test** — Run lint, type-check, and tests\\n5. **Record** — Document changes in session journal\\n\\n## Code Quality Checklist\\n\\n- [ ] Lint checks pass\\n- [ ] Type checks pass\\n- [ ] Tests pass\\n- [ ] No `any` types introduced\\n- [ ] Error handling is comprehensive\\n- [ ] Changes documented if needed\"\n}",
    "stderr": "",
    "elapsed": 400,
    "verdict": "PASS",
    "expect": "返回 JSON 与原始一致"
  },
  {
    "id": "p3-plugin-list-init",
    "description": "[Phase 3 Plugin] 列出 plugins（初始状态）",
    "command": "plugin list -f json",
    "exitCode": 0,
    "stdout": "[]",
    "stderr": "",
    "elapsed": 405,
    "verdict": "PASS",
    "expect": "返回数组，退出码 0"
  },
  {
    "id": "p3-plugin-add-1",
    "description": "[Phase 3 Plugin] 添加 web-search plugin",
    "command": "plugin add C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\\fixtures/web-search-plugin.json",
    "exitCode": 0,
    "stdout": "Plugin \"web-search\" added successfully.",
    "stderr": "",
    "elapsed": 400,
    "verdict": "PASS",
    "expect": "成功添加，退出码 0"
  },
  {
    "id": "p3-plugin-add-2",
    "description": "[Phase 3 Plugin] 添加 memory plugin",
    "command": "plugin add C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\\fixtures/memory-plugin.json",
    "exitCode": 0,
    "stdout": "Plugin \"memory\" added successfully.",
    "stderr": "",
    "elapsed": 389,
    "verdict": "PASS",
    "expect": "成功添加，退出码 0"
  },
  {
    "id": "p3-plugin-list-two",
    "description": "[Phase 3 Plugin] 添加后列出（至少 2 个）",
    "command": "plugin list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"web-search\",\n    \"description\": \"Web search capability plugin — enables agents to search the web for real-time information\",\n    \"type\": \"npm\",\n    \"source\": \"@anthropic/web-search\",\n    \"config\": {\n      \"maxResults\": 10,\n      \"safeSearch\": true\n    },\n    \"enabled\": true\n  },\n  {\n    \"name\": \"memory\",\n    \"description\": \"Persistent memory plugin for Claude Code — enables long-term context retention across sessions\",\n    \"type\": \"npm\",\n    \"source\": \"@anthropic/memory\",\n    \"config\": {\n      \"storage\": \"local\",\n      \"maxEntries\": 1000\n    },\n    \"enabled\": true\n  }\n]",
    "stderr": "",
    "elapsed": 405,
    "verdict": "PASS",
    "expect": "返回数组包含 web-search 和 memory"
  },
  {
    "id": "p3-plugin-show-1",
    "description": "[Phase 3 Plugin] 查看 web-search 详情",
    "command": "plugin show web-search -f json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"web-search\",\n  \"description\": \"Web search capability plugin — enables agents to search the web for real-time information\",\n  \"type\": \"npm\",\n  \"source\": \"@anthropic/web-search\",\n  \"config\": {\n    \"maxResults\": 10,\n    \"safeSearch\": true\n  },\n  \"enabled\": true\n}",
    "stderr": "",
    "elapsed": 390,
    "verdict": "PASS",
    "expect": "返回 JSON，name=web-search，type=npm，enabled=true"
  },
  {
    "id": "p3-plugin-show-2",
    "description": "[Phase 3 Plugin] 查看 memory 详情",
    "command": "plugin show memory -f json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"memory\",\n  \"description\": \"Persistent memory plugin for Claude Code — enables long-term context retention across sessions\",\n  \"type\": \"npm\",\n  \"source\": \"@anthropic/memory\",\n  \"config\": {\n    \"storage\": \"local\",\n    \"maxEntries\": 1000\n  },\n  \"enabled\": true\n}",
    "stderr": "",
    "elapsed": 395,
    "verdict": "PASS",
    "expect": "返回 JSON，name=memory，config.storage=local"
  },
  {
    "id": "p3-plugin-export",
    "description": "[Phase 3 Plugin] 导出 web-search 到文件",
    "command": "plugin export web-search -o C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/exported-plugin.json",
    "exitCode": 0,
    "stdout": "Plugin \"web-search\" exported to C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/exported-plugin.json",
    "stderr": "",
    "elapsed": 420,
    "verdict": "PASS",
    "expect": "成功导出，退出码 0"
  },
  {
    "id": "p3-plugin-verify-export",
    "description": "[Phase 3 Plugin] 白盒验证导出文件",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/exported-plugin.json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"web-search\",\n  \"description\": \"Web search capability plugin — enables agents to search the web for real-time information\",\n  \"type\": \"npm\",\n  \"source\": \"@anthropic/web-search\",\n  \"config\": {\n    \"maxResults\": 10,\n    \"safeSearch\": true\n  },\n  \"enabled\": true\n}\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "合法 JSON，包含 name=web-search"
  },
  {
    "id": "p3-plugin-remove",
    "description": "[Phase 3 Plugin] 移除 web-search",
    "command": "plugin remove web-search",
    "exitCode": 0,
    "stdout": "Plugin \"web-search\" removed.",
    "stderr": "",
    "elapsed": 421,
    "verdict": "PASS",
    "expect": "成功移除，退出码 0"
  },
  {
    "id": "p3-plugin-list-after-rm",
    "description": "[Phase 3 Plugin] 移除后确认",
    "command": "plugin list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"memory\",\n    \"description\": \"Persistent memory plugin for Claude Code — enables long-term context retention across sessions\",\n    \"type\": \"npm\",\n    \"source\": \"@anthropic/memory\",\n    \"config\": {\n      \"storage\": \"local\",\n      \"maxEntries\": 1000\n    },\n    \"enabled\": true\n  }\n]",
    "stderr": "",
    "elapsed": 390,
    "verdict": "PASS",
    "expect": "web-search 已不在列表中，memory 仍存在"
  },
  {
    "id": "p3-plugin-reimport",
    "description": "[Phase 3 Plugin] 从导出文件重新导入",
    "command": "plugin add C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/exported-plugin.json",
    "exitCode": 0,
    "stdout": "Plugin \"web-search\" added successfully.",
    "stderr": "",
    "elapsed": 388,
    "verdict": "PASS",
    "expect": "成功导入，退出码 0"
  },
  {
    "id": "p3-plugin-show-reimport",
    "description": "[Phase 3 Plugin] 验证 roundtrip 数据完整",
    "command": "plugin show web-search -f json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"web-search\",\n  \"description\": \"Web search capability plugin — enables agents to search the web for real-time information\",\n  \"type\": \"npm\",\n  \"source\": \"@anthropic/web-search\",\n  \"config\": {\n    \"maxResults\": 10,\n    \"safeSearch\": true\n  },\n  \"enabled\": true\n}",
    "stderr": "",
    "elapsed": 391,
    "verdict": "PASS",
    "expect": "返回 JSON，name=web-search，与原始一致"
  },
  {
    "id": "p4-source-list-init",
    "description": "[Phase 4 Source] 列出 sources（应含 actant-hub 默认源）",
    "command": "source list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"actant-hub\",\n    \"config\": {\n      \"type\": \"github\",\n      \"url\": \"https://github.com/blackplume233/actant-hub.git\",\n      \"branch\": \"main\"\n    },\n    \"syncedAt\": \"2026-02-24T12:37:07.120Z\"\n  }\n]",
    "stderr": "",
    "elapsed": 390,
    "verdict": "PASS",
    "expect": "返回数组，包含 actant-hub（类型 github），退出码 0"
  },
  {
    "id": "p4-source-sync-hub",
    "description": "[Phase 4 Source] 同步 actant-hub 默认源（需网络，耗时较长）",
    "command": "source sync actant-hub",
    "exitCode": 0,
    "stdout": "Synced: actant-hub",
    "stderr": "",
    "elapsed": 1904,
    "verdict": "PASS",
    "expect": "同步完成，输出同步报告（added/updated/removed 数量），退出码 0"
  },
  {
    "id": "p4-source-list-synced",
    "description": "[Phase 4 Source] 同步后列出",
    "command": "source list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"actant-hub\",\n    \"config\": {\n      \"type\": \"github\",\n      \"url\": \"https://github.com/blackplume233/actant-hub.git\",\n      \"branch\": \"main\"\n    },\n    \"syncedAt\": \"2026-02-24T12:37:09.420Z\"\n  }\n]",
    "stderr": "",
    "elapsed": 390,
    "verdict": "PASS",
    "expect": "actant-hub 显示已同步状态和组件数量"
  },
  {
    "id": "p4-source-validate-hub",
    "description": "[Phase 4 Source] 验证 actant-hub 源完整性",
    "command": "source validate actant-hub",
    "exitCode": 0,
    "stdout": "Validating source: actant-hub (C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\\sources-cache\\actant-hub)\n\n\nSummary: 20 component(s) passed\n\nValidation passed.",
    "stderr": "",
    "elapsed": 407,
    "verdict": "PASS",
    "expect": "退出码 0，输出验证结果（各组件类型数量）"
  },
  {
    "id": "p4-source-validate-strict",
    "description": "[Phase 4 Source] 严格模式验证",
    "command": "source validate actant-hub --strict",
    "exitCode": 0,
    "stdout": "Validating source: actant-hub (C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\\sources-cache\\actant-hub)\n\n\nSummary: 20 component(s) passed\n\nValidation passed.",
    "stderr": "",
    "elapsed": 402,
    "verdict": "WARN",
    "expect": "退出码 0（严格模式下无警告），或退出码 1（有警告时 --strict 将其视为错误）"
  },
  {
    "id": "p4-source-add-local",
    "description": "[Phase 4 Source] 添加本地 source（使用项目 configs/ 目录）",
    "command": "source add g:/Workspace/AgentWorkSpace/AgentCraft/configs --name qa-local --type local",
    "exitCode": 0,
    "stdout": "Source \"qa-local\" added. Components: 3 skills, 1 prompts, 1 mcp, 1 workflows, 0 presets",
    "stderr": "",
    "elapsed": 390,
    "verdict": "PASS",
    "expect": "成功添加，退出码 0"
  },
  {
    "id": "p4-source-list-with-local",
    "description": "[Phase 4 Source] 添加后列出（应含 actant-hub + qa-local）",
    "command": "source list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"actant-hub\",\n    \"config\": {\n      \"type\": \"github\",\n      \"url\": \"https://github.com/blackplume233/actant-hub.git\",\n      \"branch\": \"main\"\n    },\n    \"syncedAt\": \"2026-02-24T12:37:11.019Z\"\n  },\n  {\n    \"name\": \"qa-local\",\n    \"config\": {\n      \"type\": \"local\",\n      \"path\": \"g:/Workspace/AgentWorkSpace/AgentCraft/configs\"\n    },\n    \"syncedAt\": \"2026-02-24T12:37:11.019Z\"\n  }\n]",
    "stderr": "",
    "elapsed": 395,
    "verdict": "PASS",
    "expect": "返回数组包含 actant-hub 和 qa-local"
  },
  {
    "id": "p4-source-sync-local",
    "description": "[Phase 4 Source] 同步本地源",
    "command": "source sync qa-local",
    "exitCode": 0,
    "stdout": "Synced: qa-local",
    "stderr": "",
    "elapsed": 388,
    "verdict": "PASS",
    "expect": "同步完成，退出码 0"
  },
  {
    "id": "p4-source-validate-local",
    "description": "[Phase 4 Source] 验证本地源（configs/ 缺少 actant.json 清单）",
    "command": "source validate qa-local",
    "exitCode": 1,
    "stdout": "Validating source: unknown (g:/Workspace/AgentWorkSpace/AgentCraft/configs)\n\n  [ERROR]  actant.json — actant.json not found in source root\n\nSummary: 7 component(s) passed, 1 error(s)\n\nValidation failed.",
    "stderr": "",
    "elapsed": 404,
    "verdict": "PASS",
    "expect": "退出码 1，输出 Validation failed，因为 configs/ 目录缺少 actant.json 清单文件，但组件文件通过验证"
  },
  {
    "id": "p4-source-validate-path",
    "description": "[Phase 4 Source] 使用 --path 直接验证目录（缺少 actant.json）",
    "command": "source validate --path g:/Workspace/AgentWorkSpace/AgentCraft/configs",
    "exitCode": 1,
    "stdout": "Validating source: unknown (g:/Workspace/AgentWorkSpace/AgentCraft/configs)\n\n  [ERROR]  actant.json — actant.json not found in source root\n\nSummary: 7 component(s) passed, 1 error(s)\n\nValidation failed.",
    "stderr": "",
    "elapsed": 404,
    "verdict": "PASS",
    "expect": "退出码 1，输出 Validation failed，因为 configs/ 目录缺少 actant.json 清单文件，但组件文件通过验证"
  },
  {
    "id": "p4-source-remove-local",
    "description": "[Phase 4 Source] 移除本地源",
    "command": "source remove qa-local",
    "exitCode": 0,
    "stdout": "Source \"qa-local\" removed.",
    "stderr": "",
    "elapsed": 405,
    "verdict": "PASS",
    "expect": "成功移除，退出码 0"
  },
  {
    "id": "p4-source-list-after-rm",
    "description": "[Phase 4 Source] 移除后确认",
    "command": "source list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"actant-hub\",\n    \"config\": {\n      \"type\": \"github\",\n      \"url\": \"https://github.com/blackplume233/actant-hub.git\",\n      \"branch\": \"main\"\n    },\n    \"syncedAt\": \"2026-02-24T12:37:13.028Z\"\n  }\n]",
    "stderr": "",
    "elapsed": 391,
    "verdict": "PASS",
    "expect": "qa-local 已不在列表中，actant-hub 仍存在"
  },
  {
    "id": "p5-preset-list",
    "description": "[Phase 5 Preset] 列出全部 presets",
    "command": "preset list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"web-dev\",\n    \"version\": \"1.0.0\",\n    \"description\": \"Web development preset — code review, testing, documentation, and file system access\",\n    \"skills\": [\n      \"code-review\",\n      \"test-writer\",\n      \"doc-writer\"\n    ],\n    \"prompts\": [\n      \"code-assistant\"\n    ],\n    \"mcpServers\": [\n      \"filesystem\"\n    ],\n    \"templates\": [\n      \"code-reviewer\",\n      \"qa-engineer\",\n      \"doc-writer\"\n    ]\n  },\n  {\n    \"name\": \"devops\",\n    \"version\": \"1.0.0\",\n    \"description\": \"DevOps preset — testing, documentation, file system and persistent memory for infrastructure work\",\n    \"skills\": [\n      \"test-writer\",\n      \"doc-writer\"\n    ],\n    \"prompts\": [\n      \"code-assistant\"\n    ],\n    \"mcpServers\": [\n      \"filesystem\",\n      \"memory-server\"\n    ],\n    \"templates\": [\n      \"qa-engineer\"\n    ]\n  }\n]",
    "stderr": "",
    "elapsed": 407,
    "verdict": "PASS",
    "expect": "返回数组（如 actant-hub 已同步，应包含 web-dev、devops 等 preset），退出码 0"
  },
  {
    "id": "p5-preset-list-hub",
    "description": "[Phase 5 Preset] 按 source 筛选 preset",
    "command": "preset list actant-hub -f json",
    "exitCode": 0,
    "stdout": "[]",
    "stderr": "",
    "elapsed": 405,
    "verdict": "PASS",
    "expect": "返回 actant-hub 的 preset 列表"
  },
  {
    "id": "p5-preset-show-webdev",
    "description": "[Phase 5 Preset] 查看 web-dev preset 详情",
    "command": "preset show actant-hub@web-dev -f json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"web-dev\",\n  \"version\": \"1.0.0\",\n  \"description\": \"Web development preset — code review, testing, documentation, and file system access\",\n  \"skills\": [\n    \"code-review\",\n    \"test-writer\",\n    \"doc-writer\"\n  ],\n  \"prompts\": [\n    \"code-assistant\"\n  ],\n  \"mcpServers\": [\n    \"filesystem\"\n  ],\n  \"templates\": [\n    \"code-reviewer\",\n    \"qa-engineer\",\n    \"doc-writer\"\n  ]\n}",
    "stderr": "",
    "elapsed": 409,
    "verdict": "PASS",
    "expect": "返回 JSON，包含 preset 定义（skills、prompts、mcpServers 等引用），退出码 0"
  },
  {
    "id": "p5-preset-show-devops",
    "description": "[Phase 5 Preset] 查看 devops preset 详情",
    "command": "preset show actant-hub@devops -f json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"devops\",\n  \"version\": \"1.0.0\",\n  \"description\": \"DevOps preset — testing, documentation, file system and persistent memory for infrastructure work\",\n  \"skills\": [\n    \"test-writer\",\n    \"doc-writer\"\n  ],\n  \"prompts\": [\n    \"code-assistant\"\n  ],\n  \"mcpServers\": [\n    \"filesystem\",\n    \"memory-server\"\n  ],\n  \"templates\": [\n    \"qa-engineer\"\n  ]\n}",
    "stderr": "",
    "elapsed": 393,
    "verdict": "PASS",
    "expect": "返回 JSON，包含 devops 相关组件引用"
  },
  {
    "id": "p5-preset-show-nonexist",
    "description": "[Phase 5 Preset] 查看不存在的 preset",
    "command": "preset show nonexistent-pkg@nonexistent-preset",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32000] Configuration file not found: Preset \"nonexistent-pkg@nonexistent-preset\" not found\n  Context: {\"configPath\":\"Preset \\\"nonexistent-pkg@nonexistent-preset\\\" not found\"}",
    "elapsed": 393,
    "verdict": "PASS",
    "expect": "退出码非 0，错误信息提示 preset 不存在"
  },
  {
    "id": "p5-tpl-install",
    "description": "[Phase 5 Preset] 从源安装模板",
    "command": "template install actant-hub@code-reviewer",
    "exitCode": 0,
    "stdout": "Syncing source \"actant-hub\"...\n  Template \"actant-hub@code-reviewer\" is available.\n\n  Name:        actant-hub@code-reviewer\n  Description: A code review agent — systematic reviews with security, performance, and maintainability checks\n  Backend:     claude-code\n  Version:     1.0.0\n\n  Create an agent: actant agent create <agent-name> --template actant-hub@code-reviewer",
    "stderr": "",
    "elapsed": 1817,
    "verdict": "PASS",
    "expect": "成功安装 code-reviewer 模板（从 actant-hub 源），退出码 0"
  },
  {
    "id": "p5-preset-apply",
    "description": "[Phase 5 Preset] 应用 preset 到模板（使用命名空间全名）",
    "command": "preset apply actant-hub@web-dev actant-hub@code-reviewer",
    "exitCode": 0,
    "stdout": "Preset \"actant-hub@web-dev\" applied to template \"actant-hub@code-reviewer\".",
    "stderr": "",
    "elapsed": 390,
    "verdict": "PASS",
    "expect": "成功应用，退出码 0，模板的 domainContext 被 preset 扩展"
  },
  {
    "id": "p5-tpl-show-applied",
    "description": "[Phase 5 Preset] 验证 preset 已合并到模板",
    "command": "template show actant-hub@code-reviewer -f json",
    "exitCode": 0,
    "stdout": "{\n  \"name\": \"actant-hub@code-reviewer\",\n  \"version\": \"1.0.0\",\n  \"description\": \"A code review agent — systematic reviews with security, performance, and maintainability checks\",\n  \"backend\": {\n    \"type\": \"claude-code\"\n  },\n  \"domainContext\": {\n    \"skills\": [\n      \"actant-hub@code-review\"\n    ],\n    \"prompts\": [\n      \"actant-hub@code-assistant\"\n    ],\n    \"mcpServers\": [\n      {\n        \"name\": \"filesystem\",\n        \"command\": \"npx\",\n        \"args\": [\n          \"-y\",\n          \"@modelcontextprotocol/server-filesystem\",\n          \".\"\n        ]\n      }\n    ]\n  },\n  \"metadata\": {\n    \"category\": \"web-dev\",\n    \"difficulty\": \"beginner\"\n  }\n}",
    "stderr": "",
    "elapsed": 413,
    "verdict": "PASS",
    "expect": "返回 JSON，domainContext 中应包含 web-dev preset 引入的额外 skills/prompts/mcp 等引用"
  },
  {
    "id": "p6-agent-list-empty",
    "description": "[Phase 6 Agent 基础] 初始 Agent 列表",
    "command": "agent list -f json",
    "exitCode": 0,
    "stdout": "[]",
    "stderr": "",
    "elapsed": 389,
    "verdict": "PASS",
    "expect": "返回空数组，退出码 0"
  },
  {
    "id": "p6-agent-create",
    "description": "[Phase 6 Agent 基础] 创建 cursor 后端 Agent",
    "command": "agent create qa-cursor-1 -t qa-cursor-tpl -f json",
    "exitCode": 0,
    "stdout": "Agent created successfully.\n\n{\n  \"id\": \"a4347a94-6fb6-4a80-a328-9fd81465d661\",\n  \"name\": \"qa-cursor-1\",\n  \"templateName\": \"qa-cursor-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"cursor\",\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:37:18.452Z\",\n  \"updatedAt\": \"2026-02-24T12:37:18.452Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 390,
    "verdict": "PASS",
    "expect": "返回 JSON，name=qa-cursor-1，status=created，退出码 0"
  },
  {
    "id": "p6-agent-list-after",
    "description": "[Phase 6 Agent 基础] 创建后列出",
    "command": "agent list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"id\": \"a4347a94-6fb6-4a80-a328-9fd81465d661\",\n    \"name\": \"qa-cursor-1\",\n    \"templateName\": \"qa-cursor-tpl\",\n    \"templateVersion\": \"1.0.0\",\n    \"backendType\": \"cursor\",\n    \"status\": \"created\",\n    \"launchMode\": \"direct\",\n    \"workspacePolicy\": \"persistent\",\n    \"processOwnership\": \"managed\",\n    \"createdAt\": \"2026-02-24T12:37:18.452Z\",\n    \"updatedAt\": \"2026-02-24T12:37:18.452Z\",\n    \"effectivePermissions\": {\n      \"allow\": [\n        \"*\"\n      ],\n      \"deny\": [],\n      \"ask\": [],\n      \"defaultMode\": \"bypassPermissions\"\n    }\n  }\n]",
    "stderr": "",
    "elapsed": 398,
    "verdict": "PASS",
    "expect": "返回数组包含 qa-cursor-1，status=created"
  },
  {
    "id": "p6-agent-status",
    "description": "[Phase 6 Agent 基础] 查看状态",
    "command": "agent status qa-cursor-1 -f json",
    "exitCode": 0,
    "stdout": "{\n  \"id\": \"a4347a94-6fb6-4a80-a328-9fd81465d661\",\n  \"name\": \"qa-cursor-1\",\n  \"templateName\": \"qa-cursor-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"cursor\",\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:37:18.452Z\",\n  \"updatedAt\": \"2026-02-24T12:37:18.452Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 383,
    "verdict": "PASS",
    "expect": "返回 JSON，status=created，name=qa-cursor-1，backendType=cursor"
  },
  {
    "id": "p6-agent-wb-actant",
    "description": "[Phase 6 Agent 基础] 白盒验证 .actant.json",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/qa-cursor-1/.actant.json",
    "exitCode": 0,
    "stdout": "{\n  \"id\": \"a4347a94-6fb6-4a80-a328-9fd81465d661\",\n  \"name\": \"qa-cursor-1\",\n  \"templateName\": \"qa-cursor-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"cursor\",\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:37:18.452Z\",\n  \"updatedAt\": \"2026-02-24T12:37:18.452Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "合法 JSON，包含 name=qa-cursor-1、template=qa-cursor-tpl、backendType=cursor、status=created"
  },
  {
    "id": "p6-agent-wb-agents-md",
    "description": "[Phase 6 Agent 基础] 白盒验证 AGENTS.md 存在",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/qa-cursor-1/AGENTS.md",
    "exitCode": 0,
    "stdout": "# Agent Skills\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "文件存在（即使内容可能为空或最小化）"
  },
  {
    "id": "p6-agent-wb-cursor-dir",
    "description": "[Phase 6 Agent 基础] 白盒验证 .cursor/ 目录结构",
    "command": "_whitebox_ls:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/qa-cursor-1/.cursor/",
    "exitCode": 0,
    "stdout": "rules",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": ".cursor/ 目录存在，可能包含 rules/ 子目录"
  },
  {
    "id": "p6-agent-resolve",
    "description": "[Phase 6 Agent 基础] Resolve Agent（获取启动信息）",
    "command": "agent resolve qa-cursor-1 -f json",
    "exitCode": 0,
    "stdout": "{\n  \"workspaceDir\": \"C:\\\\Users\\\\black\\\\AppData\\\\Local\\\\Temp\\\\ac-qa-ultimate-r2-20260224203555\\\\instances\\\\qa-cursor-1\",\n  \"command\": \"cursor.cmd\",\n  \"args\": [\n    \"C:\\\\Users\\\\black\\\\AppData\\\\Local\\\\Temp\\\\ac-qa-ultimate-r2-20260224203555\\\\instances\\\\qa-cursor-1\"\n  ],\n  \"instanceName\": \"qa-cursor-1\",\n  \"backendType\": \"cursor\",\n  \"created\": false\n}",
    "stderr": "",
    "elapsed": 393,
    "verdict": "PASS",
    "expect": "返回 JSON，包含 command（cursor 或 cursor.cmd）和 args、workspaceDir，退出码 0"
  },
  {
    "id": "p6-agent-open",
    "description": "[Phase 6 Agent 基础] Open Agent（在 IDE 中打开）",
    "command": "agent open qa-cursor-1",
    "exitCode": 0,
    "stdout": "Opening qa-cursor-1 → cursor.cmd C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\\instances\\qa-cursor-1",
    "stderr": "",
    "elapsed": 389,
    "verdict": "WARN",
    "expect": "退出码 0，或因 cursor 二进制不在 PATH 中而退出码非 0（均为合法行为）"
  },
  {
    "id": "p6-agent-status-after-open",
    "description": "[Phase 6 Agent 基础] Open 后状态不变",
    "command": "agent status qa-cursor-1 -f json",
    "exitCode": 0,
    "stdout": "{\n  \"id\": \"a4347a94-6fb6-4a80-a328-9fd81465d661\",\n  \"name\": \"qa-cursor-1\",\n  \"templateName\": \"qa-cursor-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"cursor\",\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:37:18.452Z\",\n  \"updatedAt\": \"2026-02-24T12:37:18.452Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 434,
    "verdict": "PASS",
    "expect": "status 仍为 created（open 不改变 agent 状态）"
  },
  {
    "id": "p6-agent-destroy",
    "description": "[Phase 6 Agent 基础] 销毁 Agent",
    "command": "agent destroy qa-cursor-1 --force",
    "exitCode": 0,
    "stdout": "Destroyed qa-cursor-1",
    "stderr": "",
    "elapsed": 406,
    "verdict": "PASS",
    "expect": "成功销毁，退出码 0"
  },
  {
    "id": "p6-agent-list-after-destroy",
    "description": "[Phase 6 Agent 基础] 销毁后列出",
    "command": "agent list -f json",
    "exitCode": 0,
    "stdout": "[]",
    "stderr": "",
    "elapsed": 423,
    "verdict": "PASS",
    "expect": "qa-cursor-1 已不在列表中"
  },
  {
    "id": "p6-agent-wb-dir-removed",
    "description": "[Phase 6 Agent 基础] 白盒验证实例目录已删除",
    "command": "_whitebox_ls:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/qa-cursor-1/",
    "exitCode": 1,
    "stdout": "",
    "stderr": "Directory not found: C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/qa-cursor-1/",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "目录不存在（已被删除）"
  },
  {
    "id": "p6-agent-destroy-no-force",
    "description": "[Phase 6 Agent 基础] 不使用 --force 销毁（应拒绝）",
    "command": "agent destroy nonexistent-agent-xyz",
    "exitCode": 1,
    "stdout": "Destroying agent \"nonexistent-agent-xyz\" will remove its entire workspace.\nUse --force to skip this warning.",
    "stderr": "",
    "elapsed": 397,
    "verdict": "PASS",
    "expect": "退出码 1，输出两行警告: Destroying agent ... will remove its entire workspace 和 Use --force to skip this warning"
  },
  {
    "id": "p6-agent-status-all",
    "description": "[Phase 6 Agent 基础] 无参数 agent status（列出全部 Agent）",
    "command": "agent status -f json",
    "exitCode": 0,
    "stdout": "[]",
    "stderr": "",
    "elapsed": 431,
    "verdict": "PASS",
    "expect": "退出码 0，等价于 agent list，返回所有 Agent 的状态数组"
  },
  {
    "id": "p7-create-cursor",
    "description": "[Phase 7 多后端] 创建 cursor 后端 Agent",
    "command": "agent create mb-cursor -t qa-cursor-tpl -f json",
    "exitCode": 0,
    "stdout": "Agent created successfully.\n\n{\n  \"id\": \"38de6732-848c-45af-8d98-e01c2ba08a41\",\n  \"name\": \"mb-cursor\",\n  \"templateName\": \"qa-cursor-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"cursor\",\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:37:22.579Z\",\n  \"updatedAt\": \"2026-02-24T12:37:22.579Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 412,
    "verdict": "PASS",
    "expect": "成功创建，backendType=cursor"
  },
  {
    "id": "p7-create-claude",
    "description": "[Phase 7 多后端] 创建 claude-code 后端 Agent",
    "command": "agent create mb-claude -t qa-claude-tpl -f json",
    "exitCode": 0,
    "stdout": "Agent created successfully.\n\n{\n  \"id\": \"83d3a66d-d276-4961-8969-3a25ee638f66\",\n  \"name\": \"mb-claude\",\n  \"templateName\": \"qa-claude-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"claude-code\",\n  \"providerConfig\": {\n    \"type\": \"anthropic\",\n    \"protocol\": \"anthropic\"\n  },\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:37:22.985Z\",\n  \"updatedAt\": \"2026-02-24T12:37:22.985Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 403,
    "verdict": "PASS",
    "expect": "成功创建，backendType=claude-code"
  },
  {
    "id": "p7-create-pi",
    "description": "[Phase 7 多后端] 创建 pi 后端 Agent",
    "command": "agent create mb-pi -t qa-pi-tpl -f json",
    "exitCode": 0,
    "stdout": "Agent created successfully.\n\n{\n  \"id\": \"275a0ecb-841d-42e0-bb64-3a8ad5a2995e\",\n  \"name\": \"mb-pi\",\n  \"templateName\": \"qa-pi-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"pi\",\n  \"providerConfig\": {\n    \"type\": \"anthropic\",\n    \"config\": {\n      \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n    },\n    \"protocol\": \"anthropic\"\n  },\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:37:23.381Z\",\n  \"updatedAt\": \"2026-02-24T12:37:23.381Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 392,
    "verdict": "PASS",
    "expect": "成功创建，backendType=pi"
  },
  {
    "id": "p7-list-three",
    "description": "[Phase 7 多后端] 列出三个共存 Agent",
    "command": "agent list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"id\": \"38de6732-848c-45af-8d98-e01c2ba08a41\",\n    \"name\": \"mb-cursor\",\n    \"templateName\": \"qa-cursor-tpl\",\n    \"templateVersion\": \"1.0.0\",\n    \"backendType\": \"cursor\",\n    \"status\": \"created\",\n    \"launchMode\": \"direct\",\n    \"workspacePolicy\": \"persistent\",\n    \"processOwnership\": \"managed\",\n    \"createdAt\": \"2026-02-24T12:37:22.579Z\",\n    \"updatedAt\": \"2026-02-24T12:37:22.579Z\",\n    \"effectivePermissions\": {\n      \"allow\": [\n        \"*\"\n      ],\n      \"deny\": [],\n      \"ask\": [],\n      \"defaultMode\": \"bypassPermissions\"\n    }\n  },\n  {\n    \"id\": \"83d3a66d-d276-4961-8969-3a25ee638f66\",\n    \"name\": \"mb-claude\",\n    \"templateName\": \"qa-claude-tpl\",\n    \"templateVersion\": \"1.0.0\",\n    \"backendType\": \"claude-code\",\n    \"providerConfig\": {\n      \"type\": \"anthropic\",\n      \"protocol\": \"anthropic\"\n    },\n    \"status\": \"created\",\n    \"launchMode\": \"direct\",\n    \"workspacePolicy\": \"persistent\",\n    \"processOwnership\": \"managed\",\n    \"createdAt\": \"2026-02-24T12:37:22.985Z\",\n    \"updatedAt\": \"2026-02-24T12:37:22.985Z\",\n    \"effectivePermissions\": {\n      \"allow\": [\n        \"*\"\n      ],\n      \"deny\": [],\n      \"ask\": [],\n      \"defaultMode\": \"bypassPermissions\"\n    }\n  },\n  {\n    \"id\": \"275a0ecb-841d-42e0-bb64-3a8ad5a2995e\",\n    \"name\": \"mb-pi\",\n    \"templateName\": \"qa-pi-tpl\",\n    \"templateVersion\": \"1.0.0\",\n    \"backendType\": \"pi\",\n    \"providerConfig\": {\n      \"type\": \"anthropic\",\n      \"config\": {\n        \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n      },\n      \"protocol\": \"anthropi",
    "stderr": "",
    "elapsed": 407,
    "verdict": "PASS",
    "expect": "返回数组包含 mb-cursor、mb-claude、mb-pi，各自 backendType 正确"
  },
  {
    "id": "p7-status-cursor",
    "description": "[Phase 7 多后端] 验证 cursor Agent 状态",
    "command": "agent status mb-cursor -f json",
    "exitCode": 0,
    "stdout": "{\n  \"id\": \"38de6732-848c-45af-8d98-e01c2ba08a41\",\n  \"name\": \"mb-cursor\",\n  \"templateName\": \"qa-cursor-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"cursor\",\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:37:22.579Z\",\n  \"updatedAt\": \"2026-02-24T12:37:22.579Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 425,
    "verdict": "PASS",
    "expect": "status=created，backendType=cursor"
  },
  {
    "id": "p7-status-claude",
    "description": "[Phase 7 多后端] 验证 claude-code Agent 状态",
    "command": "agent status mb-claude -f json",
    "exitCode": 0,
    "stdout": "{\n  \"id\": \"83d3a66d-d276-4961-8969-3a25ee638f66\",\n  \"name\": \"mb-claude\",\n  \"templateName\": \"qa-claude-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"claude-code\",\n  \"providerConfig\": {\n    \"type\": \"anthropic\",\n    \"protocol\": \"anthropic\"\n  },\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:37:22.985Z\",\n  \"updatedAt\": \"2026-02-24T12:37:22.985Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 452,
    "verdict": "PASS",
    "expect": "status=created，backendType=claude-code"
  },
  {
    "id": "p7-status-pi",
    "description": "[Phase 7 多后端] 验证 pi Agent 状态",
    "command": "agent status mb-pi -f json",
    "exitCode": 0,
    "stdout": "{\n  \"id\": \"275a0ecb-841d-42e0-bb64-3a8ad5a2995e\",\n  \"name\": \"mb-pi\",\n  \"templateName\": \"qa-pi-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"pi\",\n  \"providerConfig\": {\n    \"type\": \"anthropic\",\n    \"config\": {\n      \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n    },\n    \"protocol\": \"anthropic\"\n  },\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:37:23.381Z\",\n  \"updatedAt\": \"2026-02-24T12:37:23.381Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 435,
    "verdict": "PASS",
    "expect": "status=created，backendType=pi"
  },
  {
    "id": "p7-resolve-cursor",
    "description": "[Phase 7 多后端] Resolve cursor Agent",
    "command": "agent resolve mb-cursor -f json",
    "exitCode": 0,
    "stdout": "{\n  \"workspaceDir\": \"C:\\\\Users\\\\black\\\\AppData\\\\Local\\\\Temp\\\\ac-qa-ultimate-r2-20260224203555\\\\instances\\\\mb-cursor\",\n  \"command\": \"cursor.cmd\",\n  \"args\": [\n    \"C:\\\\Users\\\\black\\\\AppData\\\\Local\\\\Temp\\\\ac-qa-ultimate-r2-20260224203555\\\\instances\\\\mb-cursor\"\n  ],\n  \"instanceName\": \"mb-cursor\",\n  \"backendType\": \"cursor\",\n  \"created\": false\n}",
    "stderr": "",
    "elapsed": 437,
    "verdict": "PASS",
    "expect": "返回 command 为 cursor 相关二进制"
  },
  {
    "id": "p7-resolve-claude",
    "description": "[Phase 7 多后端] Resolve claude-code Agent",
    "command": "agent resolve mb-claude -f json",
    "exitCode": 0,
    "stdout": "{\n  \"workspaceDir\": \"C:\\\\Users\\\\black\\\\AppData\\\\Local\\\\Temp\\\\ac-qa-ultimate-r2-20260224203555\\\\instances\\\\mb-claude\",\n  \"command\": \"claude-agent-acp.cmd\",\n  \"args\": [],\n  \"instanceName\": \"mb-claude\",\n  \"backendType\": \"claude-code\",\n  \"created\": false,\n  \"resolvePackage\": \"@zed-industries/claude-agent-acp\"\n}",
    "stderr": "",
    "elapsed": 417,
    "verdict": "PASS",
    "expect": "返回 command 为 claude 相关二进制"
  },
  {
    "id": "p7-wb-cursor-ws",
    "description": "[Phase 7 多后端] 白盒: cursor 工作区包含 .cursor/",
    "command": "_whitebox_ls:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/mb-cursor/.cursor/",
    "exitCode": 0,
    "stdout": "rules",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": ".cursor/ 目录存在"
  },
  {
    "id": "p7-wb-claude-ws",
    "description": "[Phase 7 多后端] 白盒: claude-code 工作区包含 .claude/",
    "command": "_whitebox_ls:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/mb-claude/.claude/",
    "exitCode": 0,
    "stdout": "settings.local.json",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": ".claude/ 目录存在（claude-code builder 产物）"
  },
  {
    "id": "p7-attach-bad-pid",
    "description": "[Phase 7 多后端] Attach 不存在的 PID",
    "command": "agent attach mb-cursor --pid 99999",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32008] Failed to launch agent \"mb-cursor\"\n  Context: {\"instanceName\":\"mb-cursor\",\"cause\":\"Process with PID 99999 does not exist\"}",
    "elapsed": 421,
    "verdict": "PASS",
    "expect": "退出码非 0，错误信息（进程不存在）"
  },
  {
    "id": "p7-detach-not-attached",
    "description": "[Phase 7 多后端] Detach 未 attach 的 Agent",
    "command": "agent detach mb-cursor",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32010] Agent \"mb-cursor\" has no attached process\n  Context: {\"instanceName\":\"mb-cursor\"}",
    "elapsed": 452,
    "verdict": "PASS",
    "expect": "退出码非 0，提示 Agent 未被 attach"
  },
  {
    "id": "p7-adopt-prep",
    "description": "[Phase 7 多后端] 白盒准备: 创建 adopt 用模拟工作区",
    "command": "_setup:create_dir_with_file C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/mock-workspace/.actant.json {\"name\":\"mock-ws-agent\",\"status\":\"stopped\",\"template\":\"qa-cursor-tpl\",\"backendType\":\"cursor\",\"workspaceDir\":\"C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/mock-workspace\"}",
    "exitCode": 0,
    "stdout": "Created C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/mock-workspace/.actant.json",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "目录和 .actant.json 文件创建成功"
  },
  {
    "id": "p7-adopt",
    "description": "[Phase 7 多后端] Adopt 已有工作区",
    "command": "agent adopt C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/mock-workspace --rename adopted-agent -f json",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32007] Agent instance \"C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\\mock-workspace\" is corrupted: .actant.json contains invalid JSON\n  Context: {\"instanceName\":\"C:\\\\Users\\\\black\\\\AppData\\\\Local\\\\Temp\\\\ac-qa-ultimate-r2-20260224203555\\\\mock-workspace\",\"reason\":\".actant.json contains invalid JSON\"}",
    "elapsed": 426,
    "verdict": "FAIL",
    "expect": "成功 adopt，返回 Agent 信息，退出码 0"
  },
  {
    "id": "p7-adopt-status",
    "description": "[Phase 7 多后端] 验证 adopted Agent 状态",
    "command": "agent status adopted-agent -f json",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32003] Agent instance \"adopted-agent\" not found\n  Context: {\"instanceName\":\"adopted-agent\"}",
    "elapsed": 476,
    "verdict": "FAIL",
    "expect": "返回 Agent 状态信息"
  },
  {
    "id": "p7-adopt-destroy",
    "description": "[Phase 7 多后端] 销毁 adopted Agent",
    "command": "agent destroy adopted-agent --force",
    "exitCode": 0,
    "stdout": "Destroyed adopted-agent (already absent)",
    "stderr": "",
    "elapsed": 463,
    "verdict": "PASS",
    "expect": "成功销毁，退出码 0"
  },
  {
    "id": "p7-destroy-cursor",
    "description": "[Phase 7 多后端] 销毁 cursor Agent",
    "command": "agent destroy mb-cursor --force",
    "exitCode": 0,
    "stdout": "Destroyed mb-cursor",
    "stderr": "",
    "elapsed": 448,
    "verdict": "PASS",
    "expect": "成功销毁"
  },
  {
    "id": "p7-destroy-claude",
    "description": "[Phase 7 多后端] 销毁 claude Agent",
    "command": "agent destroy mb-claude --force",
    "exitCode": 0,
    "stdout": "Destroyed mb-claude",
    "stderr": "",
    "elapsed": 418,
    "verdict": "PASS",
    "expect": "成功销毁"
  },
  {
    "id": "p7-destroy-pi",
    "description": "[Phase 7 多后端] 销毁 pi Agent",
    "command": "agent destroy mb-pi --force",
    "exitCode": 0,
    "stdout": "Destroyed mb-pi",
    "stderr": "",
    "elapsed": 448,
    "verdict": "PASS",
    "expect": "成功销毁"
  },
  {
    "id": "p7-list-empty",
    "description": "[Phase 7 多后端] 确认全部销毁",
    "command": "agent list -f json",
    "exitCode": 0,
    "stdout": "[]",
    "stderr": "",
    "elapsed": 434,
    "verdict": "PASS",
    "expect": "返回空数组"
  },
  {
    "id": "p8-ctx-create",
    "description": "[Phase 8 域上下文物化] 使用富模板创建 Agent",
    "command": "agent create rich-agent -t qa-rich-tpl -f json",
    "exitCode": 0,
    "stdout": "Agent created successfully.\n\n{\n  \"id\": \"ecfe78c7-a6dd-44a1-bacc-df5bad77b223\",\n  \"name\": \"rich-agent\",\n  \"templateName\": \"qa-rich-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"cursor\",\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:37:30.481Z\",\n  \"updatedAt\": \"2026-02-24T12:37:30.481Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 447,
    "verdict": "PASS",
    "expect": "成功创建，name=rich-agent，退出码 0。可能有域组件引用警告（如果某些组件未加载），但创建应成功"
  },
  {
    "id": "p8-ctx-status",
    "description": "[Phase 8 域上下文物化] 验证 Agent 创建成功",
    "command": "agent status rich-agent -f json",
    "exitCode": 0,
    "stdout": "{\n  \"id\": \"ecfe78c7-a6dd-44a1-bacc-df5bad77b223\",\n  \"name\": \"rich-agent\",\n  \"templateName\": \"qa-rich-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"cursor\",\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:37:30.481Z\",\n  \"updatedAt\": \"2026-02-24T12:37:30.481Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 417,
    "verdict": "PASS",
    "expect": "status=created，backendType=cursor"
  },
  {
    "id": "p8-ctx-wb-rules-cr",
    "description": "[Phase 8 域上下文物化] 白盒: code-review skill → .cursor/rules/code-review.mdc",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/rich-agent/.cursor/rules/code-review.mdc",
    "exitCode": 0,
    "stdout": "---\ndescription: \"Rules and guidelines for reviewing code quality\"\nalwaysApply: true\n---\n\n## Code Review Checklist\n\n- Check for proper error handling (try/catch, error boundaries)\n- Verify type safety (no `any`, proper generics)\n- Review naming conventions (descriptive, consistent casing)\n- Look for potential performance issues (unnecessary re-renders, N+1 queries)\n- Ensure tests cover edge cases\n- Validate input/output contracts match API specs\n- Check for security vulnerabilities (injection, XSS, auth bypass)\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "文件存在且内容非空，包含 Code Review Checklist 相关内容"
  },
  {
    "id": "p8-ctx-wb-rules-ts",
    "description": "[Phase 8 域上下文物化] 白盒: typescript-expert skill → .cursor/rules/typescript-expert.mdc",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/rich-agent/.cursor/rules/typescript-expert.mdc",
    "exitCode": 0,
    "stdout": "---\ndescription: \"TypeScript best practices and advanced patterns\"\nalwaysApply: true\n---\n\n## TypeScript Best Practices\n\n- Use strict mode (`strict: true` in tsconfig)\n- Prefer interfaces over type aliases for object shapes\n- Use discriminated unions for state machines and variant types\n- Avoid `any`, prefer `unknown` with type guards\n- Use `satisfies` operator for type-safe object literals\n- Leverage template literal types for string patterns\n- Use `const` assertions for literal types\n- Prefer `readonly` for immutable data structures\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "文件存在且内容非空，包含 TypeScript Best Practices"
  },
  {
    "id": "p8-ctx-wb-agents-md",
    "description": "[Phase 8 域上下文物化] 白盒: AGENTS.md 包含 skill 内容",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/rich-agent/AGENTS.md",
    "exitCode": 0,
    "stdout": "# Agent Skills\n\n## code-review\n> Rules and guidelines for reviewing code quality\n\n## Code Review Checklist\n\n- Check for proper error handling (try/catch, error boundaries)\n- Verify type safety (no `any`, proper generics)\n- Review naming conventions (descriptive, consistent casing)\n- Look for potential performance issues (unnecessary re-renders, N+1 queries)\n- Ensure tests cover edge cases\n- Validate input/output contracts match API specs\n- Check for security vulnerabilities (injection, XSS, auth bypass)\n\n---\n\n## typescript-expert\n> TypeScript best practices and advanced patterns\n\n## TypeScript Best Practices\n\n- Use strict mode (`strict: true` in tsconfig)\n- Prefer interfaces over type aliases for object shapes\n- Use discriminated unions for state machines and variant types\n- Avoid `any`, prefer `unknown` with type guards\n- Use `satisfies` operator for type-safe object literals\n- Leverage template literal types for string patterns\n- Use `const` assertions for literal types\n- Prefer `readonly` for immutable data structures\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "文件包含 code-review 和 typescript-expert 的 skill 内容"
  },
  {
    "id": "p8-ctx-wb-prompts",
    "description": "[Phase 8 域上下文物化] 白盒: prompts/system.md 包含 prompt 内容",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/rich-agent/prompts/system.md",
    "exitCode": 0,
    "stdout": "## system-code-reviewer\n\n> System prompt for a code review agent\n\n\nYou are a senior code reviewer for the {{project}} project.\n\nYour responsibilities:\n1. Review code changes for correctness, performance, and maintainability\n2. Identify potential bugs, security issues, and anti-patterns\n3. Suggest improvements with concrete code examples\n4. Ensure coding standards and conventions are followed\n5. Verify test coverage for new functionality\n\nWhen reviewing:\n- Be constructive and specific in feedback\n- Explain the 'why' behind suggestions\n- Prioritize issues by severity (critical > major > minor > style)\n- Acknowledge good patterns and improvements\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "文件包含 senior code reviewer 相关内容"
  },
  {
    "id": "p8-ctx-wb-mcp",
    "description": "[Phase 8 域上下文物化] 白盒: .cursor/mcp.json 包含 MCP 配置",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/rich-agent/.cursor/mcp.json",
    "exitCode": 0,
    "stdout": "{\n  \"mcpServers\": {\n    \"filesystem\": {\n      \"command\": \"npx\",\n      \"args\": [\n        \"-y\",\n        \"@anthropic/mcp-filesystem\"\n      ]\n    }\n  }\n}\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "合法 JSON，包含 filesystem 服务配置，command=npx，args 包含 @anthropic/mcp-filesystem"
  },
  {
    "id": "p8-ctx-wb-workflow",
    "description": "[Phase 8 域上下文物化] 白盒: .trellis/workflow.md 包含 workflow",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/rich-agent/.trellis/workflow.md",
    "exitCode": 0,
    "stdout": "# Development Workflow\n\n## Quick Start\n\n1. **Read context** — Understand current project state\n2. **Plan** — Break down the task into actionable steps\n3. **Implement** — Write code following project guidelines\n4. **Test** — Run lint, type-check, and tests\n5. **Record** — Document changes in session journal\n\n## Code Quality Checklist\n\n- [ ] Lint checks pass\n- [ ] Type checks pass\n- [ ] Tests pass\n- [ ] No `any` types introduced\n- [ ] Error handling is comprehensive\n- [ ] Changes documented if needed\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "文件包含 Development Workflow 相关内容"
  },
  {
    "id": "p8-ctx-wb-extensions",
    "description": "[Phase 8 域上下文物化] 白盒: .cursor/extensions.json 包含 plugin 配置",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/rich-agent/.cursor/extensions.json",
    "exitCode": 0,
    "stdout": "{\n  \"recommendations\": [\n    \"@anthropic/web-search\"\n  ]\n}\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "合法 JSON，包含 web-search plugin 信息"
  },
  {
    "id": "p8-ctx-wb-actant-json",
    "description": "[Phase 8 域上下文物化] 白盒: .actant.json 完整元数据",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/rich-agent/.actant.json",
    "exitCode": 0,
    "stdout": "{\n  \"id\": \"ecfe78c7-a6dd-44a1-bacc-df5bad77b223\",\n  \"name\": \"rich-agent\",\n  \"templateName\": \"qa-rich-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"cursor\",\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:37:30.481Z\",\n  \"updatedAt\": \"2026-02-24T12:37:30.481Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "合法 JSON，包含 domainContext 引用、template=qa-rich-tpl、backendType=cursor"
  },
  {
    "id": "p8-ctx-wb-cursor-settings",
    "description": "[Phase 8 域上下文物化] 白盒: .cursor/settings.json 权限",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/rich-agent/.cursor/settings.json",
    "exitCode": 1,
    "stdout": "",
    "stderr": "File not found: C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/rich-agent/.cursor/settings.json",
    "elapsed": 0,
    "verdict": "WARN",
    "expect": "文件存在（可能为空对象或包含权限设置）"
  },
  {
    "id": "p8-ctx-resolve",
    "description": "[Phase 8 域上下文物化] Resolve 验证物化完整",
    "command": "agent resolve rich-agent -f json",
    "exitCode": 0,
    "stdout": "{\n  \"workspaceDir\": \"C:\\\\Users\\\\black\\\\AppData\\\\Local\\\\Temp\\\\ac-qa-ultimate-r2-20260224203555\\\\instances\\\\rich-agent\",\n  \"command\": \"cursor.cmd\",\n  \"args\": [\n    \"C:\\\\Users\\\\black\\\\AppData\\\\Local\\\\Temp\\\\ac-qa-ultimate-r2-20260224203555\\\\instances\\\\rich-agent\"\n  ],\n  \"instanceName\": \"rich-agent\",\n  \"backendType\": \"cursor\",\n  \"created\": false\n}",
    "stderr": "",
    "elapsed": 441,
    "verdict": "PASS",
    "expect": "退出码 0，返回 resolve 信息"
  },
  {
    "id": "p8-ctx-destroy",
    "description": "[Phase 8 域上下文物化] 销毁并验证",
    "command": "agent destroy rich-agent --force",
    "exitCode": 0,
    "stdout": "Destroyed rich-agent",
    "stderr": "",
    "elapsed": 448,
    "verdict": "PASS",
    "expect": "成功销毁"
  },
  {
    "id": "p8-ctx-wb-dir-gone",
    "description": "[Phase 8 域上下文物化] 白盒确认工作区删除",
    "command": "_whitebox_ls:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/rich-agent/",
    "exitCode": 1,
    "stdout": "",
    "stderr": "Directory not found: C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/rich-agent/",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "目录不存在"
  },
  {
    "id": "p9-comm-create",
    "description": "[Phase 9 Agent 通信] 创建 Pi 后端 Agent",
    "command": "agent create comm-agent -t qa-pi-tpl -f json",
    "exitCode": 0,
    "stdout": "Agent created successfully.\n\n{\n  \"id\": \"f69f5b08-8c02-4b2c-b8b2-80bb70b88866\",\n  \"name\": \"comm-agent\",\n  \"templateName\": \"qa-pi-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"pi\",\n  \"providerConfig\": {\n    \"type\": \"anthropic\",\n    \"config\": {\n      \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n    },\n    \"protocol\": \"anthropic\"\n  },\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:37:32.274Z\",\n  \"updatedAt\": \"2026-02-24T12:37:32.274Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 422,
    "verdict": "PASS",
    "expect": "成功创建，backendType=pi"
  },
  {
    "id": "p9-comm-start",
    "description": "[Phase 9 Agent 通信] 启动 Pi Agent",
    "command": "agent start comm-agent",
    "exitCode": 0,
    "stdout": "Started comm-agent",
    "stderr": "",
    "elapsed": 1291,
    "verdict": "PASS",
    "expect": "成功启动，退出码 0。Pi 后端为 in-process，ACP 桥接启动"
  },
  {
    "id": "p9-comm-status-running",
    "description": "[Phase 9 Agent 通信] 验证运行状态",
    "command": "agent status comm-agent -f json",
    "exitCode": 0,
    "stdout": "{\n  \"id\": \"f69f5b08-8c02-4b2c-b8b2-80bb70b88866\",\n  \"name\": \"comm-agent\",\n  \"templateName\": \"qa-pi-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"pi\",\n  \"providerConfig\": {\n    \"type\": \"anthropic\",\n    \"protocol\": \"anthropic\",\n    \"config\": {\n      \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n    }\n  },\n  \"status\": \"running\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:37:32.274Z\",\n  \"updatedAt\": \"2026-02-24T12:37:33.575Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 412,
    "verdict": "PASS",
    "expect": "status=running"
  },
  {
    "id": "p9-comm-run",
    "description": "[Phase 9 Agent 通信] agent run 发送 prompt",
    "command": "agent run comm-agent --prompt \"Say hello in one word\" --timeout 30000",
    "exitCode": 1,
    "stdout": "",
    "stderr": "Error: RPC call timed out after 35000ms",
    "elapsed": 35347,
    "verdict": "WARN",
    "expect": "返回文本响应（LLM 回复），退出码 0。如无 API key，可能返回认证错误（WARN 级别）"
  },
  {
    "id": "p9-comm-prompt",
    "description": "[Phase 9 Agent 通信] agent prompt 通过 ACP session",
    "command": "agent prompt comm-agent -m \"What is 2+2?\" -f json",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32603] Agent \"comm-agent\" has no ACP connection. Start it first with `agent start`.",
    "elapsed": 405,
    "verdict": "FAIL",
    "expect": "返回 JSON 包含 response 和 sessionId，退出码 0。如无 API key，返回错误（WARN）"
  },
  {
    "id": "p9-comm-dispatch",
    "description": "[Phase 9 Agent 通信] dispatch 后台任务",
    "command": "agent dispatch comm-agent -m \"Background analysis task\" -p high",
    "exitCode": 1,
    "stdout": "No scheduler for agent \"comm-agent\". Task not queued.\nHint: use \"actant agent run comm-agent --prompt <message>\" for one-shot execution.",
    "stderr": "",
    "elapsed": 390,
    "verdict": "WARN",
    "expect": "成功入队或提示调度器相关信息，退出码 0"
  },
  {
    "id": "p9-comm-tasks",
    "description": "[Phase 9 Agent 通信] 查看任务队列",
    "command": "agent tasks comm-agent -f json",
    "exitCode": 0,
    "stdout": "{\n  \"queued\": 0,\n  \"processing\": false,\n  \"tasks\": []\n}",
    "stderr": "",
    "elapsed": 389,
    "verdict": "PASS",
    "expect": "返回 JSON 包含 queued/processing/tasks 字段，退出码 0"
  },
  {
    "id": "p9-comm-logs",
    "description": "[Phase 9 Agent 通信] 查看执行日志",
    "command": "agent logs comm-agent -f json",
    "exitCode": 0,
    "stdout": "[]",
    "stderr": "",
    "elapsed": 387,
    "verdict": "PASS",
    "expect": "返回日志数组（可能为空），退出码 0"
  },
  {
    "id": "p9-comm-stop",
    "description": "[Phase 9 Agent 通信] 停止 Agent",
    "command": "agent stop comm-agent",
    "exitCode": 0,
    "stdout": "Stopped comm-agent",
    "stderr": "",
    "elapsed": 388,
    "verdict": "PASS",
    "expect": "成功停止，退出码 0"
  },
  {
    "id": "p9-comm-status-stopped",
    "description": "[Phase 9 Agent 通信] 验证停止状态",
    "command": "agent status comm-agent -f json",
    "exitCode": 0,
    "stdout": "{\n  \"id\": \"f69f5b08-8c02-4b2c-b8b2-80bb70b88866\",\n  \"name\": \"comm-agent\",\n  \"templateName\": \"qa-pi-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"pi\",\n  \"providerConfig\": {\n    \"type\": \"anthropic\",\n    \"protocol\": \"anthropic\",\n    \"config\": {\n      \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n    }\n  },\n  \"status\": \"stopped\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:37:32.274Z\",\n  \"updatedAt\": \"2026-02-24T12:38:11.312Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 397,
    "verdict": "PASS",
    "expect": "status=stopped"
  },
  {
    "id": "p9-comm-destroy",
    "description": "[Phase 9 Agent 通信] 销毁通信测试 Agent",
    "command": "agent destroy comm-agent --force",
    "exitCode": 0,
    "stdout": "Destroyed comm-agent",
    "stderr": "",
    "elapsed": 402,
    "verdict": "PASS",
    "expect": "成功销毁"
  },
  {
    "id": "p9-err-dispatch-noagent",
    "description": "[Phase 9 Agent 通信] dispatch 不存在的 Agent",
    "command": "agent dispatch ghost-comm-xyz -m \"test\"",
    "exitCode": 1,
    "stdout": "No scheduler for agent \"ghost-comm-xyz\". Task not queued.\nHint: use \"actant agent run ghost-comm-xyz --prompt <message>\" for one-shot execution.",
    "stderr": "",
    "elapsed": 386,
    "verdict": "PASS",
    "expect": "退出码非 0，错误信息"
  },
  {
    "id": "p9-err-prompt-stopped",
    "description": "[Phase 9 Agent 通信] prompt 已停止的 Agent",
    "command": "agent prompt ghost-comm-xyz -m \"test\"",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32003] Agent instance \"ghost-comm-xyz\" not found\n  Context: {\"instanceName\":\"ghost-comm-xyz\"}",
    "elapsed": 378,
    "verdict": "PASS",
    "expect": "退出码非 0，提示 Agent 不存在或未运行"
  },
  {
    "id": "p9-err-run-noagent",
    "description": "[Phase 9 Agent 通信] run 不存在的 Agent",
    "command": "agent run ghost-comm-xyz --prompt \"test\"",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32003] Agent instance \"ghost-comm-xyz\" not found\n  Context: {\"instanceName\":\"ghost-comm-xyz\"}",
    "elapsed": 394,
    "verdict": "PASS",
    "expect": "退出码非 0，错误信息"
  },
  {
    "id": "p10-sched-create",
    "description": "[Phase 10 Scheduler] 创建带 heartbeat 的 Agent",
    "command": "agent create sched-agent -t qa-sched-tpl -f json",
    "exitCode": 0,
    "stdout": "Agent created successfully.\n\n{\n  \"id\": \"8257573b-dd2e-4270-9fc0-8a3381b41ad7\",\n  \"name\": \"sched-agent\",\n  \"templateName\": \"qa-sched-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"pi\",\n  \"providerConfig\": {\n    \"type\": \"anthropic\",\n    \"config\": {\n      \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n    },\n    \"protocol\": \"anthropic\"\n  },\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:38:13.664Z\",\n  \"updatedAt\": \"2026-02-24T12:38:13.664Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 388,
    "verdict": "PASS",
    "expect": "成功创建，schedule 配置应包含 heartbeat"
  },
  {
    "id": "p10-sched-start",
    "description": "[Phase 10 Scheduler] 启动带 scheduler 的 Agent",
    "command": "agent start sched-agent",
    "exitCode": 0,
    "stdout": "Started sched-agent",
    "stderr": "",
    "elapsed": 1243,
    "verdict": "PASS",
    "expect": "成功启动，退出码 0"
  },
  {
    "id": "p10-sched-status",
    "description": "[Phase 10 Scheduler] 验证运行状态",
    "command": "agent status sched-agent -f json",
    "exitCode": 0,
    "stdout": "{\n  \"id\": \"8257573b-dd2e-4270-9fc0-8a3381b41ad7\",\n  \"name\": \"sched-agent\",\n  \"templateName\": \"qa-sched-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"pi\",\n  \"providerConfig\": {\n    \"type\": \"anthropic\",\n    \"protocol\": \"anthropic\",\n    \"config\": {\n      \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n    }\n  },\n  \"status\": \"running\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:38:13.664Z\",\n  \"updatedAt\": \"2026-02-24T12:38:14.915Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 392,
    "verdict": "PASS",
    "expect": "status=running"
  },
  {
    "id": "p10-sched-list",
    "description": "[Phase 10 Scheduler] 列出 schedule 源",
    "command": "schedule list sched-agent -f json",
    "exitCode": 0,
    "stdout": "{\n  \"sources\": [],\n  \"running\": false\n}",
    "stderr": "",
    "elapsed": 395,
    "verdict": "PASS",
    "expect": "返回 JSON，sources 包含 heartbeat 源，running=true"
  },
  {
    "id": "p10-sched-dispatch",
    "description": "[Phase 10 Scheduler] 手动 dispatch 任务",
    "command": "agent dispatch sched-agent -m \"Scheduled health check\" -p normal",
    "exitCode": 1,
    "stdout": "No scheduler for agent \"sched-agent\". Task not queued.\nHint: use \"actant agent run sched-agent --prompt <message>\" for one-shot execution.",
    "stderr": "",
    "elapsed": 392,
    "verdict": "WARN",
    "expect": "queued=true 或成功入队信息"
  },
  {
    "id": "p10-sched-tasks",
    "description": "[Phase 10 Scheduler] 查看任务队列",
    "command": "agent tasks sched-agent -f json",
    "exitCode": 0,
    "stdout": "{\n  \"queued\": 0,\n  \"processing\": false,\n  \"tasks\": []\n}",
    "stderr": "",
    "elapsed": 386,
    "verdict": "PASS",
    "expect": "返回包含刚 dispatch 的任务或处理中状态"
  },
  {
    "id": "p10-sched-dispatch-critical",
    "description": "[Phase 10 Scheduler] dispatch 高优先级任务",
    "command": "agent dispatch sched-agent -m \"Critical alert\" -p critical",
    "exitCode": 1,
    "stdout": "No scheduler for agent \"sched-agent\". Task not queued.\nHint: use \"actant agent run sched-agent --prompt <message>\" for one-shot execution.",
    "stderr": "",
    "elapsed": 388,
    "verdict": "FAIL",
    "expect": "成功入队，退出码 0"
  },
  {
    "id": "p10-sched-logs",
    "description": "[Phase 10 Scheduler] 查看执行日志",
    "command": "agent logs sched-agent -f json",
    "exitCode": 0,
    "stdout": "[]",
    "stderr": "",
    "elapsed": 391,
    "verdict": "PASS",
    "expect": "返回日志数组，退出码 0"
  },
  {
    "id": "p10-sched-stop",
    "description": "[Phase 10 Scheduler] 停止 Agent",
    "command": "agent stop sched-agent",
    "exitCode": 0,
    "stdout": "Stopped sched-agent",
    "stderr": "",
    "elapsed": 396,
    "verdict": "PASS",
    "expect": "成功停止"
  },
  {
    "id": "p10-sched-destroy",
    "description": "[Phase 10 Scheduler] 销毁",
    "command": "agent destroy sched-agent --force",
    "exitCode": 0,
    "stdout": "Destroyed sched-agent",
    "stderr": "",
    "elapsed": 403,
    "verdict": "PASS",
    "expect": "成功销毁"
  },
  {
    "id": "p11-session-setup",
    "description": "[Phase 11 Session] 创建并启动 ACP Agent 用于 session 测试",
    "command": "agent create session-agent -t qa-pi-tpl -f json",
    "exitCode": 0,
    "stdout": "Agent created successfully.\n\n{\n  \"id\": \"d1d98b21-8b09-46b3-90b2-295674da6409\",\n  \"name\": \"session-agent\",\n  \"templateName\": \"qa-pi-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"pi\",\n  \"providerConfig\": {\n    \"type\": \"anthropic\",\n    \"config\": {\n      \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n    },\n    \"protocol\": \"anthropic\"\n  },\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:38:18.468Z\",\n  \"updatedAt\": \"2026-02-24T12:38:18.468Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 386,
    "verdict": "PASS",
    "expect": "成功创建"
  },
  {
    "id": "p11-session-start",
    "description": "[Phase 11 Session] 启动 Agent",
    "command": "agent start session-agent",
    "exitCode": 0,
    "stdout": "Started session-agent",
    "stderr": "",
    "elapsed": 1249,
    "verdict": "PASS",
    "expect": "成功启动，退出码 0"
  },
  {
    "id": "p11-session-list-empty",
    "description": "[Phase 11 Session] 列出 sessions（应为空）",
    "command": "_rpc:session.list {\"agentName\":\"session-agent\"}",
    "exitCode": 0,
    "stdout": "(RPC pseudo-command skipped in batch runner)",
    "stderr": "",
    "elapsed": 0,
    "verdict": "SKIP",
    "expect": "返回空数组"
  },
  {
    "id": "p11-session-create",
    "description": "[Phase 11 Session] 创建 session",
    "command": "_rpc:session.create {\"agentName\":\"session-agent\",\"clientId\":\"qa-client-1\"}",
    "exitCode": 0,
    "stdout": "(RPC pseudo-command skipped in batch runner)",
    "stderr": "",
    "elapsed": 0,
    "verdict": "SKIP",
    "expect": "返回 SessionLeaseInfo，包含 sessionId"
  },
  {
    "id": "p11-session-list-one",
    "description": "[Phase 11 Session] 列出 sessions（应有 1 个）",
    "command": "_rpc:session.list {\"agentName\":\"session-agent\"}",
    "exitCode": 0,
    "stdout": "(RPC pseudo-command skipped in batch runner)",
    "stderr": "",
    "elapsed": 0,
    "verdict": "SKIP",
    "expect": "返回包含 1 个 session 的数组"
  },
  {
    "id": "p11-session-prompt",
    "description": "[Phase 11 Session] 通过 session 发送 prompt",
    "command": "_rpc:session.prompt {\"sessionId\":\"$LAST_SESSION_ID\",\"text\":\"Say hi\"}",
    "exitCode": 0,
    "stdout": "(RPC pseudo-command skipped in batch runner)",
    "stderr": "",
    "elapsed": 0,
    "verdict": "SKIP",
    "expect": "返回 JSON 包含 text 和 stopReason。如无 API key，返回 LLM 错误（WARN）"
  },
  {
    "id": "p11-session-cancel",
    "description": "[Phase 11 Session] 取消 session",
    "command": "_rpc:session.cancel {\"sessionId\":\"$LAST_SESSION_ID\"}",
    "exitCode": 0,
    "stdout": "(RPC pseudo-command skipped in batch runner)",
    "stderr": "",
    "elapsed": 0,
    "verdict": "SKIP",
    "expect": "返回 {ok: true} 或提示无活动请求"
  },
  {
    "id": "p11-session-close",
    "description": "[Phase 11 Session] 关闭 session",
    "command": "_rpc:session.close {\"sessionId\":\"$LAST_SESSION_ID\"}",
    "exitCode": 0,
    "stdout": "(RPC pseudo-command skipped in batch runner)",
    "stderr": "",
    "elapsed": 0,
    "verdict": "SKIP",
    "expect": "返回 {ok: true}"
  },
  {
    "id": "p11-session-list-closed",
    "description": "[Phase 11 Session] 关闭后列出（应为空）",
    "command": "_rpc:session.list {\"agentName\":\"session-agent\"}",
    "exitCode": 0,
    "stdout": "(RPC pseudo-command skipped in batch runner)",
    "stderr": "",
    "elapsed": 0,
    "verdict": "SKIP",
    "expect": "session 已从列表中移除"
  },
  {
    "id": "p11-proxy-help",
    "description": "[Phase 11 Proxy] Proxy 帮助信息",
    "command": "proxy --help",
    "exitCode": 0,
    "stdout": "Usage: actant proxy [options] <name>\n\nRun an ACP proxy for an agent (stdin/stdout ACP protocol)\n\nArguments:\n  name                       Agent name to proxy\n\nOptions:\n  --lease                    Use Session Lease mode (requires running agent)\n                             (default: false)\n  -t, --template <template>  Template name (auto-creates instance if not found)\n  -h, --help                 display help for command",
    "stderr": "",
    "elapsed": 326,
    "verdict": "PASS",
    "expect": "输出 proxy 用法说明，包含 --lease 和 -t 选项，退出码 0"
  },
  {
    "id": "p11-proxy-nonexist",
    "description": "[Phase 11 Proxy] 对不存在的 Agent 启动 proxy",
    "command": "proxy nonexistent-proxy-agent-xyz",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32003] Agent instance \"nonexistent-proxy-agent-xyz\" not found\n  Context: {\"instanceName\":\"nonexistent-proxy-agent-xyz\"}",
    "elapsed": 382,
    "verdict": "PASS",
    "expect": "退出码非 0，错误信息"
  },
  {
    "id": "p11-session-cleanup",
    "description": "[Phase 11 Session] 清理 session 测试 Agent",
    "command": "agent destroy session-agent --force",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32603] EBUSY: resource busy or locked, rmdir 'C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\\instances\\session-agent'",
    "elapsed": 389,
    "verdict": "FAIL",
    "expect": "成功销毁"
  },
  {
    "id": "p12-update-check",
    "description": "[Phase 12 Self-Update] 检查版本（--check）",
    "command": "self-update --check --source g:/Workspace/AgentWorkSpace/AgentCraft",
    "exitCode": 0,
    "stdout": "=== Version Check ===\nSource version: 0.2.2\nLast update: none",
    "stderr": "",
    "elapsed": 332,
    "verdict": "PASS",
    "expect": "输出版本信息（Source version 和 Last update 状态），退出码 0"
  },
  {
    "id": "p12-update-dryrun",
    "description": "[Phase 12 Self-Update] Dry run 更新",
    "command": "self-update --dry-run --no-agent --source g:/Workspace/AgentWorkSpace/AgentCraft",
    "exitCode": 0,
    "stdout": "=== Actant Self-Update ===\nUpdate ID: upd-202602241238215\nSource: g:/Workspace/AgentWorkSpace/AgentCraft\nSpawning: node g:\\Workspace\\AgentWorkSpace\\AgentCraft\\scripts\\self-update.js --manifest C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\\update-manifest.json --dry-run\nUpdate script spawned in background. Check logs at:\n  C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\\logs\\update-upd-202602241238215.log",
    "stderr": "",
    "elapsed": 358,
    "verdict": "PASS",
    "expect": "输出计划执行的操作（不实际执行），退出码 0 或输出 update manifest 信息"
  },
  {
    "id": "p12-update-wb-manifest",
    "description": "[Phase 12 Self-Update] 白盒验证 update-manifest.json",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/update-manifest.json",
    "exitCode": 0,
    "stdout": "{\n  \"updateId\": \"upd-202602241238215\",\n  \"createdAt\": \"2026-02-24T12:38:21.556Z\",\n  \"sourcePath\": \"g:/Workspace/AgentWorkSpace/AgentCraft\",\n  \"installedVersion\": {\n    \"version\": \"0.2.1\"\n  },\n  \"backupPath\": \"C:\\\\Users\\\\black\\\\AppData\\\\Local\\\\Temp\\\\ac-qa-ultimate-r2-20260224203555\\\\backups\\\\upd-202602241238215\",\n  \"runningAgents\": [],\n  \"daemonSocketPath\": \"C:\\\\Users\\\\black\\\\AppData\\\\Local\\\\Temp\\\\ac-qa-ultimate-r2-20260224203555\\\\daemon.sock\",\n  \"rollbackOnFailure\": true,\n  \"phase\": \"pending\",\n  \"useAgent\": true\n}",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "文件存在，包含 updateId、sourcePath、phase 字段"
  },
  {
    "id": "p12-update-nosource",
    "description": "[Phase 12 Self-Update] 无 --source 且 config.json devSourcePath 为空",
    "command": "self-update --check",
    "exitCode": 1,
    "stdout": "",
    "stderr": "No source path specified. Use --source <path> or set devSourcePath in ~/.actant/config.json",
    "elapsed": 321,
    "verdict": "PASS",
    "expect": "退出码 1，输出红色文本: No source path specified. Use --source <path> or set devSourcePath in ~/.actant/config.json"
  },
  {
    "id": "p13-err-agent-create-notpl",
    "description": "[Phase 13 错误处理] 创建 Agent 不指定模板",
    "command": "agent create no-tpl-agent",
    "exitCode": 1,
    "stdout": "",
    "stderr": "error: required option '-t, --template <template>' not specified",
    "elapsed": 329,
    "verdict": "PASS",
    "expect": "退出码 1，Commander 输出: error: required option '-t, --template <template>' not specified"
  },
  {
    "id": "p13-err-agent-create-badtpl",
    "description": "[Phase 13 错误处理] 使用不存在的模板创建",
    "command": "agent create bad-agent -t nonexistent-tpl-xyz-99",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32001] Template \"nonexistent-tpl-xyz-99\" not found in registry\n  Context: {\"templateName\":\"nonexistent-tpl-xyz-99\"}",
    "elapsed": 391,
    "verdict": "PASS",
    "expect": "退出码非 0，提示模板不存在"
  },
  {
    "id": "p13-err-agent-start-noexist",
    "description": "[Phase 13 错误处理] 启动不存在的 Agent",
    "command": "agent start ghost-agent-xyz-99",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32003] Agent instance \"ghost-agent-xyz-99\" not found\n  Context: {\"instanceName\":\"ghost-agent-xyz-99\"}",
    "elapsed": 386,
    "verdict": "PASS",
    "expect": "退出码非 0，错误信息"
  },
  {
    "id": "p13-err-agent-stop-noexist",
    "description": "[Phase 13 错误处理] 停止不存在的 Agent",
    "command": "agent stop ghost-agent-xyz-99",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32003] Agent instance \"ghost-agent-xyz-99\" not found\n  Context: {\"instanceName\":\"ghost-agent-xyz-99\"}",
    "elapsed": 394,
    "verdict": "PASS",
    "expect": "退出码非 0，错误信息"
  },
  {
    "id": "p13-err-agent-status-noexist",
    "description": "[Phase 13 错误处理] 查看不存在 Agent 状态",
    "command": "agent status ghost-agent-xyz-99",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32003] Agent instance \"ghost-agent-xyz-99\" not found\n  Context: {\"instanceName\":\"ghost-agent-xyz-99\"}",
    "elapsed": 383,
    "verdict": "PASS",
    "expect": "退出码非 0，错误信息"
  },
  {
    "id": "p13-err-agent-resolve-noexist",
    "description": "[Phase 13 错误处理] Resolve 不存在的 Agent",
    "command": "agent resolve ghost-agent-xyz-99",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32003] Agent instance \"ghost-agent-xyz-99\" not found\n  Context: {\"instanceName\":\"ghost-agent-xyz-99\"}",
    "elapsed": 394,
    "verdict": "PASS",
    "expect": "退出码非 0，错误信息"
  },
  {
    "id": "p13-err-agent-destroy-force",
    "description": "[Phase 13 错误处理] destroy --force 不存在的 Agent（幂等）",
    "command": "agent destroy ghost-agent-xyz-99 --force",
    "exitCode": 0,
    "stdout": "Destroyed ghost-agent-xyz-99 (already absent)",
    "stderr": "",
    "elapsed": 392,
    "verdict": "PASS",
    "expect": "退出码 0，输出 Destroyed ghost-agent-xyz-99 (already absent)。--force 模式将 AGENT_NOT_FOUND(-32003) 视为成功"
  },
  {
    "id": "p13-err-dup-setup",
    "description": "[Phase 13 错误处理] 创建用于重复测试的 Agent",
    "command": "agent create dup-test -t qa-cursor-tpl",
    "exitCode": 0,
    "stdout": "Agent created successfully.\n\nAgent:     dup-test\nID:        66ed7fcc-4249-4115-85f0-be40c48f7328\nTemplate:  qa-cursor-tpl@1.0.0\nStatus:    created\nLaunch:    direct\nPID:       —\nCreated:   2026-02-24T12:38:24.941Z\nUpdated:   2026-02-24T12:38:24.941Z",
    "stderr": "",
    "elapsed": 402,
    "verdict": "PASS",
    "expect": "成功创建"
  },
  {
    "id": "p13-err-dup-create",
    "description": "[Phase 13 错误处理] 重复创建同名 Agent",
    "command": "agent create dup-test -t qa-cursor-tpl",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32002] Instance directory \"dup-test\" already exists\n  Context: {\"validationErrors\":[{\"path\":\"name\",\"message\":\"Directory already exists: C:\\\\Users\\\\black\\\\AppData\\\\Local\\\\Temp\\\\ac-qa-ultimate-r2-20260224203555\\\\instances\\\\dup-test\"}]}",
    "elapsed": 390,
    "verdict": "PASS",
    "expect": "退出码非 0，提示 Agent 已存在"
  },
  {
    "id": "p13-err-dup-cleanup",
    "description": "[Phase 13 错误处理] 清理重复测试 Agent",
    "command": "agent destroy dup-test --force",
    "exitCode": 0,
    "stdout": "Destroyed dup-test",
    "stderr": "",
    "elapsed": 397,
    "verdict": "PASS",
    "expect": "成功销毁"
  },
  {
    "id": "p13-err-skill-show-noexist",
    "description": "[Phase 13 错误处理] 查看不存在的 skill",
    "command": "skill show nonexistent-skill-xyz-99",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32000] Configuration file not found: Skill \"nonexistent-skill-xyz-99\" not found\n  Context: {\"configPath\":\"Skill \\\"nonexistent-skill-xyz-99\\\" not found\"}",
    "elapsed": 404,
    "verdict": "PASS",
    "expect": "退出码非 0，错误信息"
  },
  {
    "id": "p13-err-prompt-show-noexist",
    "description": "[Phase 13 错误处理] 查看不存在的 prompt",
    "command": "prompt show nonexistent-prompt-xyz-99",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32000] Configuration file not found: Prompt \"nonexistent-prompt-xyz-99\" not found\n  Context: {\"configPath\":\"Prompt \\\"nonexistent-prompt-xyz-99\\\" not found\"}",
    "elapsed": 404,
    "verdict": "PASS",
    "expect": "退出码非 0，错误信息"
  },
  {
    "id": "p13-err-mcp-show-noexist",
    "description": "[Phase 13 错误处理] 查看不存在的 MCP",
    "command": "mcp show nonexistent-mcp-xyz-99",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32000] Configuration file not found: MCP server \"nonexistent-mcp-xyz-99\" not found\n  Context: {\"configPath\":\"MCP server \\\"nonexistent-mcp-xyz-99\\\" not found\"}",
    "elapsed": 388,
    "verdict": "PASS",
    "expect": "退出码非 0，错误信息"
  },
  {
    "id": "p13-err-wf-show-noexist",
    "description": "[Phase 13 错误处理] 查看不存在的 workflow",
    "command": "workflow show nonexistent-wf-xyz-99",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32000] Configuration file not found: Workflow \"nonexistent-wf-xyz-99\" not found\n  Context: {\"configPath\":\"Workflow \\\"nonexistent-wf-xyz-99\\\" not found\"}",
    "elapsed": 389,
    "verdict": "PASS",
    "expect": "退出码非 0，错误信息"
  },
  {
    "id": "p13-err-plugin-show-noexist",
    "description": "[Phase 13 错误处理] 查看不存在的 plugin",
    "command": "plugin show nonexistent-plugin-xyz-99",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32000] Configuration file not found: Plugin \"nonexistent-plugin-xyz-99\" not found\n  Context: {\"configPath\":\"Plugin \\\"nonexistent-plugin-xyz-99\\\" not found\"}",
    "elapsed": 388,
    "verdict": "PASS",
    "expect": "退出码非 0，错误信息"
  },
  {
    "id": "p13-err-tpl-validate-nofile",
    "description": "[Phase 13 错误处理] 验证不存在的模板文件",
    "command": "template validate /tmp/this-file-does-not-exist-xyz-12345.json",
    "exitCode": 1,
    "stdout": "",
    "stderr": "Invalid template\n  - : Configuration file not found: g:\\tmp\\this-file-does-not-exist-xyz-12345.json",
    "elapsed": 375,
    "verdict": "PASS",
    "expect": "退出码非 0，错误信息提示文件不存在"
  },
  {
    "id": "p13-err-tpl-show-noexist",
    "description": "[Phase 13 错误处理] 查看不存在的模板",
    "command": "template show nonexistent-tpl-xyz-99",
    "exitCode": 1,
    "stdout": "",
    "stderr": "[RPC -32001] Template \"nonexistent-tpl-xyz-99\" not found in registry\n  Context: {\"templateName\":\"nonexistent-tpl-xyz-99\"}",
    "elapsed": 394,
    "verdict": "PASS",
    "expect": "退出码非 0"
  },
  {
    "id": "p13-err-source-validate-noparam",
    "description": "[Phase 13 错误处理] source validate 无参数",
    "command": "source validate",
    "exitCode": 1,
    "stdout": "",
    "stderr": "Provide a source name or --path <dir>",
    "elapsed": 329,
    "verdict": "PASS",
    "expect": "退出码 1，输出 Provide a source name or --path <dir>"
  },
  {
    "id": "p13-err-source-remove-noexist",
    "description": "[Phase 13 错误处理] 移除不存在的 source",
    "command": "source remove nonexistent-source-xyz-99",
    "exitCode": 0,
    "stdout": "Source \"nonexistent-source-xyz-99\" not found.",
    "stderr": "",
    "elapsed": 391,
    "verdict": "PASS",
    "expect": "退出码 0，输出 Source not found（source remove 对不存在源为幂等操作）"
  },
  {
    "id": "p13-err-schedule-noexist",
    "description": "[Phase 13 错误处理] 列出不存在 Agent 的 schedule",
    "command": "schedule list nonexistent-sched-xyz-99",
    "exitCode": 1,
    "stdout": "No scheduler for agent \"nonexistent-sched-xyz-99\".",
    "stderr": "",
    "elapsed": 393,
    "verdict": "PASS",
    "expect": "退出码非 0，错误信息"
  },
  {
    "id": "p13-err-session-noagent",
    "description": "[Phase 13 错误处理] 对不存在 Agent 创建 session",
    "command": "_rpc:session.create {\"agentName\":\"ghost-session-xyz\",\"clientId\":\"qa\"}",
    "exitCode": 0,
    "stdout": "(RPC pseudo-command skipped in batch runner)",
    "stderr": "",
    "elapsed": 0,
    "verdict": "SKIP",
    "expect": "返回错误，Agent 不存在"
  },
  {
    "id": "p13-err-session-badid",
    "description": "[Phase 13 错误处理] 使用无效 sessionId prompt",
    "command": "_rpc:session.prompt {\"sessionId\":\"invalid-session-id-xyz\",\"text\":\"hi\"}",
    "exitCode": 0,
    "stdout": "(RPC pseudo-command skipped in batch runner)",
    "stderr": "",
    "elapsed": 0,
    "verdict": "SKIP",
    "expect": "返回错误，session 不存在"
  },
  {
    "id": "p14-sec-create-1",
    "description": "[Phase 14 安全] 创建含 anthropic provider 的 Agent",
    "command": "agent create sec-agent-1 -t qa-sec-tpl -f json",
    "exitCode": 0,
    "stdout": "Agent created successfully.\n\n{\n  \"id\": \"3f8db993-e612-4d94-befc-5621b1b62107\",\n  \"name\": \"sec-agent-1\",\n  \"templateName\": \"qa-sec-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"cursor\",\n  \"providerConfig\": {\n    \"type\": \"anthropic\",\n    \"config\": {\n      \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n    },\n    \"protocol\": \"anthropic\"\n  },\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:38:30.017Z\",\n  \"updatedAt\": \"2026-02-24T12:38:30.017Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 410,
    "verdict": "PASS",
    "expect": "成功创建"
  },
  {
    "id": "p14-sec-wb-no-apikey",
    "description": "[Phase 14 安全] 白盒: .actant.json 不含 apiKey 值",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/sec-agent-1/.actant.json",
    "exitCode": 0,
    "stdout": "{\n  \"id\": \"3f8db993-e612-4d94-befc-5621b1b62107\",\n  \"name\": \"sec-agent-1\",\n  \"templateName\": \"qa-sec-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"cursor\",\n  \"providerConfig\": {\n    \"type\": \"anthropic\",\n    \"config\": {\n      \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n    },\n    \"protocol\": \"anthropic\"\n  },\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:38:30.017Z\",\n  \"updatedAt\": \"2026-02-24T12:38:30.017Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "文件中 provider 配置应包含 type 和 config.apiKeyEnv，但不应包含实际的 apiKey 值（仅有环境变量名引用）"
  },
  {
    "id": "p14-sec-create-2",
    "description": "[Phase 14 安全] 创建第二个含 provider 的 Agent",
    "command": "agent create sec-agent-2 -t qa-claude-tpl -f json",
    "exitCode": 0,
    "stdout": "Agent created successfully.\n\n{\n  \"id\": \"9edbb78a-5b3b-47ac-a293-d95a17208c46\",\n  \"name\": \"sec-agent-2\",\n  \"templateName\": \"qa-claude-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"claude-code\",\n  \"providerConfig\": {\n    \"type\": \"anthropic\",\n    \"protocol\": \"anthropic\"\n  },\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:38:30.428Z\",\n  \"updatedAt\": \"2026-02-24T12:38:30.428Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 405,
    "verdict": "PASS",
    "expect": "成功创建"
  },
  {
    "id": "p14-sec-wb-no-apikey-2",
    "description": "[Phase 14 安全] 白盒: 第二个 Agent .actant.json 不含 apiKey",
    "command": "_whitebox_read:C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/sec-agent-2/.actant.json",
    "exitCode": 0,
    "stdout": "{\n  \"id\": \"9edbb78a-5b3b-47ac-a293-d95a17208c46\",\n  \"name\": \"sec-agent-2\",\n  \"templateName\": \"qa-claude-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"claude-code\",\n  \"providerConfig\": {\n    \"type\": \"anthropic\",\n    \"protocol\": \"anthropic\"\n  },\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:38:30.428Z\",\n  \"updatedAt\": \"2026-02-24T12:38:30.428Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}\n",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "provider 配置不含明文 apiKey"
  },
  {
    "id": "p14-sec-grep-instances",
    "description": "[Phase 14 安全] 白盒: instances/ 全局搜索 apiKey 泄露",
    "command": "_whitebox_grep:apiKey in C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/",
    "exitCode": 0,
    "stdout": "(no matches)",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "搜索结果中不应包含实际 API key 值（apiKeyEnv 作为环境变量名引用是允许的）"
  },
  {
    "id": "p14-sec-grep-secrets",
    "description": "[Phase 14 安全] 白盒: 搜索常见密钥模式",
    "command": "_whitebox_grep:(sk-|anthropic_api_key.*=) in C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/instances/",
    "exitCode": 0,
    "stdout": "(no matches)",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "grep 结果为空，instances/ 下无密钥泄露"
  },
  {
    "id": "p14-sec-grep-templates",
    "description": "[Phase 14 安全] 白盒: 模板持久化文件不含明文密钥",
    "command": "_whitebox_grep:(sk-|secret_key) in C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555/configs/templates/",
    "exitCode": 0,
    "stdout": "(no matches)",
    "stderr": "",
    "elapsed": 0,
    "verdict": "PASS",
    "expect": "模板文件中不含明文 API 密钥"
  },
  {
    "id": "p14-sec-cleanup",
    "description": "[Phase 14 安全] 清理安全测试 Agent",
    "command": "agent destroy sec-agent-1 --force",
    "exitCode": 0,
    "stdout": "Destroyed sec-agent-1",
    "stderr": "",
    "elapsed": 382,
    "verdict": "PASS",
    "expect": "成功销毁"
  },
  {
    "id": "p14-sec-cleanup-2",
    "description": "[Phase 14 安全] 清理第二个安全测试 Agent",
    "command": "agent destroy sec-agent-2 --force",
    "exitCode": 0,
    "stdout": "Destroyed sec-agent-2",
    "stderr": "",
    "elapsed": 387,
    "verdict": "PASS",
    "expect": "成功销毁"
  },
  {
    "id": "p15-edge-destroy-twice",
    "description": "[Phase 15 幂等性] destroy --force 两次（幂等）",
    "command": "agent destroy idempotent-test-xyz --force",
    "exitCode": 0,
    "stdout": "Destroyed idempotent-test-xyz (already absent)",
    "stderr": "",
    "elapsed": 389,
    "verdict": "PASS",
    "expect": "退出码 0（第一次可能找不到也没关系，--force 幂等）"
  },
  {
    "id": "p15-edge-destroy-twice-2",
    "description": "[Phase 15 幂等性] 再次 destroy 同一个名字",
    "command": "agent destroy idempotent-test-xyz --force",
    "exitCode": 0,
    "stdout": "Destroyed idempotent-test-xyz (already absent)",
    "stderr": "",
    "elapsed": 391,
    "verdict": "PASS",
    "expect": "退出码 0（仍然幂等）"
  },
  {
    "id": "p15-edge-tpl-load-twice",
    "description": "[Phase 15 幂等性] template load 同一文件两次",
    "command": "template load C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\\fixtures/code-review-agent.json",
    "exitCode": 0,
    "stdout": "Loaded code-review-agent@1.0.0",
    "stderr": "",
    "elapsed": 405,
    "verdict": "PASS",
    "expect": "退出码 0，覆盖加载或提示已存在"
  },
  {
    "id": "p15-edge-tpl-load-twice-2",
    "description": "[Phase 15 幂等性] 第二次 load（allowOverwrite=true）",
    "command": "template load C:\\Users\\black\\AppData\\Local\\Temp\\ac-qa-ultimate-r2-20260224203555\\fixtures/code-review-agent.json",
    "exitCode": 0,
    "stdout": "Loaded code-review-agent@1.0.0",
    "stderr": "",
    "elapsed": 393,
    "verdict": "PASS",
    "expect": "退出码 0，成功覆盖（TemplateRegistry 配置为 allowOverwrite: true）"
  },
  {
    "id": "p15-edge-longname",
    "description": "[Phase 15 边界] 创建长名称 Agent（50 字符）",
    "command": "agent create this-is-a-very-long-agent-name-for-boundary-test -t qa-cursor-tpl -f json",
    "exitCode": 0,
    "stdout": "Agent created successfully.\n\n{\n  \"id\": \"f33f9c5c-dd1c-49d8-9270-26fd8e60b971\",\n  \"name\": \"this-is-a-very-long-agent-name-for-boundary-test\",\n  \"templateName\": \"qa-cursor-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"cursor\",\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:38:33.202Z\",\n  \"updatedAt\": \"2026-02-24T12:38:33.202Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 410,
    "verdict": "PASS",
    "expect": "成功创建或因名称过长而失败（取决于系统限制），退出码应明确"
  },
  {
    "id": "p15-edge-longname-cleanup",
    "description": "[Phase 15 边界] 清理长名称 Agent",
    "command": "agent destroy this-is-a-very-long-agent-name-for-boundary-test --force",
    "exitCode": 0,
    "stdout": "Destroyed this-is-a-very-long-agent-name-for-boundary-test",
    "stderr": "",
    "elapsed": 405,
    "verdict": "PASS",
    "expect": "退出码 0"
  },
  {
    "id": "p15-edge-overwrite",
    "description": "[Phase 15 边界] 使用 --overwrite 创建 Agent",
    "command": "agent create overwrite-test -t qa-cursor-tpl --overwrite -f json",
    "exitCode": 0,
    "stdout": "Agent created successfully.\n\n{\n  \"id\": \"13bbd1fa-4c00-4096-a4c5-915d744dcd80\",\n  \"name\": \"overwrite-test\",\n  \"templateName\": \"qa-cursor-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"cursor\",\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:38:34.018Z\",\n  \"updatedAt\": \"2026-02-24T12:38:34.018Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 385,
    "verdict": "PASS",
    "expect": "成功创建"
  },
  {
    "id": "p15-edge-overwrite-2",
    "description": "[Phase 15 边界] 再次 --overwrite 同名 Agent",
    "command": "agent create overwrite-test -t qa-cursor-tpl --overwrite -f json",
    "exitCode": 0,
    "stdout": "Agent created successfully.\n\n{\n  \"id\": \"fa9996f6-ffdf-4f6c-8379-78e5ba9a84d2\",\n  \"name\": \"overwrite-test\",\n  \"templateName\": \"qa-cursor-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"cursor\",\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:38:34.410Z\",\n  \"updatedAt\": \"2026-02-24T12:38:34.410Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 391,
    "verdict": "PASS",
    "expect": "成功覆盖创建，退出码 0"
  },
  {
    "id": "p15-edge-overwrite-cleanup",
    "description": "[Phase 15 边界] 清理 overwrite Agent",
    "command": "agent destroy overwrite-test --force",
    "exitCode": 0,
    "stdout": "Destroyed overwrite-test",
    "stderr": "",
    "elapsed": 410,
    "verdict": "PASS",
    "expect": "成功销毁"
  },
  {
    "id": "p15-edge-format-quiet",
    "description": "[Phase 15 边界] quiet 格式输出",
    "command": "daemon status -f quiet",
    "exitCode": 0,
    "stdout": "running",
    "stderr": "",
    "elapsed": 392,
    "verdict": "PASS",
    "expect": "输出 running 或 stopped（简洁单词），退出码 0"
  },
  {
    "id": "p16-conc-create-1",
    "description": "[Phase 16 并发] 创建 Agent 1/5",
    "command": "agent create conc-agent-1 -t qa-cursor-tpl -f json",
    "exitCode": 0,
    "stdout": "Agent created successfully.\n\n{\n  \"id\": \"d7a14d0b-9264-4223-ada8-23cf894df819\",\n  \"name\": \"conc-agent-1\",\n  \"templateName\": \"qa-cursor-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"cursor\",\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:38:35.617Z\",\n  \"updatedAt\": \"2026-02-24T12:38:35.617Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 405,
    "verdict": "PASS",
    "expect": "成功创建"
  },
  {
    "id": "p16-conc-create-2",
    "description": "[Phase 16 并发] 创建 Agent 2/5",
    "command": "agent create conc-agent-2 -t qa-claude-tpl -f json",
    "exitCode": 0,
    "stdout": "Agent created successfully.\n\n{\n  \"id\": \"647a3aec-9c16-4ce3-932f-52724ba765c1\",\n  \"name\": \"conc-agent-2\",\n  \"templateName\": \"qa-claude-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"claude-code\",\n  \"providerConfig\": {\n    \"type\": \"anthropic\",\n    \"protocol\": \"anthropic\"\n  },\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:38:36.017Z\",\n  \"updatedAt\": \"2026-02-24T12:38:36.017Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 402,
    "verdict": "PASS",
    "expect": "成功创建"
  },
  {
    "id": "p16-conc-create-3",
    "description": "[Phase 16 并发] 创建 Agent 3/5",
    "command": "agent create conc-agent-3 -t qa-pi-tpl -f json",
    "exitCode": 0,
    "stdout": "Agent created successfully.\n\n{\n  \"id\": \"b199a6ae-dd80-48b9-bcbc-b44adbc4ab64\",\n  \"name\": \"conc-agent-3\",\n  \"templateName\": \"qa-pi-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"pi\",\n  \"providerConfig\": {\n    \"type\": \"anthropic\",\n    \"config\": {\n      \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n    },\n    \"protocol\": \"anthropic\"\n  },\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:38:36.420Z\",\n  \"updatedAt\": \"2026-02-24T12:38:36.420Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 389,
    "verdict": "PASS",
    "expect": "成功创建"
  },
  {
    "id": "p16-conc-create-4",
    "description": "[Phase 16 并发] 创建 Agent 4/5",
    "command": "agent create conc-agent-4 -t qa-cursor-tpl -f json",
    "exitCode": 0,
    "stdout": "Agent created successfully.\n\n{\n  \"id\": \"dd65200f-bc7c-4845-b9ed-a52db1742c91\",\n  \"name\": \"conc-agent-4\",\n  \"templateName\": \"qa-cursor-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"cursor\",\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:38:36.813Z\",\n  \"updatedAt\": \"2026-02-24T12:38:36.813Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 391,
    "verdict": "PASS",
    "expect": "成功创建"
  },
  {
    "id": "p16-conc-create-5",
    "description": "[Phase 16 并发] 创建 Agent 5/5",
    "command": "agent create conc-agent-5 -t qa-sec-tpl -f json",
    "exitCode": 0,
    "stdout": "Agent created successfully.\n\n{\n  \"id\": \"62daa7b8-5533-4c5e-92d8-560e4497a4c5\",\n  \"name\": \"conc-agent-5\",\n  \"templateName\": \"qa-sec-tpl\",\n  \"templateVersion\": \"1.0.0\",\n  \"backendType\": \"cursor\",\n  \"providerConfig\": {\n    \"type\": \"anthropic\",\n    \"config\": {\n      \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n    },\n    \"protocol\": \"anthropic\"\n  },\n  \"status\": \"created\",\n  \"launchMode\": \"direct\",\n  \"workspacePolicy\": \"persistent\",\n  \"processOwnership\": \"managed\",\n  \"createdAt\": \"2026-02-24T12:38:37.211Z\",\n  \"updatedAt\": \"2026-02-24T12:38:37.211Z\",\n  \"effectivePermissions\": {\n    \"allow\": [\n      \"*\"\n    ],\n    \"deny\": [],\n    \"ask\": [],\n    \"defaultMode\": \"bypassPermissions\"\n  }\n}",
    "stderr": "",
    "elapsed": 407,
    "verdict": "PASS",
    "expect": "成功创建"
  },
  {
    "id": "p16-conc-list",
    "description": "[Phase 16 并发] 列出全部 5 个 Agent",
    "command": "agent list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"id\": \"d1d98b21-8b09-46b3-90b2-295674da6409\",\n    \"name\": \"session-agent\",\n    \"templateName\": \"qa-pi-tpl\",\n    \"templateVersion\": \"1.0.0\",\n    \"backendType\": \"pi\",\n    \"providerConfig\": {\n      \"type\": \"anthropic\",\n      \"protocol\": \"anthropic\",\n      \"config\": {\n        \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n      }\n    },\n    \"status\": \"stopped\",\n    \"launchMode\": \"direct\",\n    \"workspacePolicy\": \"persistent\",\n    \"processOwnership\": \"managed\",\n    \"createdAt\": \"2026-02-24T12:38:18.468Z\",\n    \"updatedAt\": \"2026-02-24T12:38:20.835Z\",\n    \"effectivePermissions\": {\n      \"allow\": [\n        \"*\"\n      ],\n      \"deny\": [],\n      \"ask\": [],\n      \"defaultMode\": \"bypassPermissions\"\n    }\n  },\n  {\n    \"id\": \"d7a14d0b-9264-4223-ada8-23cf894df819\",\n    \"name\": \"conc-agent-1\",\n    \"templateName\": \"qa-cursor-tpl\",\n    \"templateVersion\": \"1.0.0\",\n    \"backendType\": \"cursor\",\n    \"status\": \"created\",\n    \"launchMode\": \"direct\",\n    \"workspacePolicy\": \"persistent\",\n    \"processOwnership\": \"managed\",\n    \"createdAt\": \"2026-02-24T12:38:35.617Z\",\n    \"updatedAt\": \"2026-02-24T12:38:35.617Z\",\n    \"effectivePermissions\": {\n      \"allow\": [\n        \"*\"\n      ],\n      \"deny\": [],\n      \"ask\": [],\n      \"defaultMode\": \"bypassPermissions\"\n    }\n  },\n  {\n    \"id\": \"647a3aec-9c16-4ce3-932f-52724ba765c1\",\n    \"name\": \"conc-agent-2\",\n    \"templateName\": \"qa-claude-tpl\",\n    \"templateVersion\": \"1.0.0\",\n    \"backendType\": \"claude-code\",\n    \"providerConfig\": {\n      \"type\": \"anthropic\",\n      \"protoc",
    "stderr": "",
    "elapsed": 408,
    "verdict": "PASS",
    "expect": "返回数组包含 conc-agent-1 到 conc-agent-5，各自 backendType 正确"
  },
  {
    "id": "p16-conc-destroy-1",
    "description": "[Phase 16 并发] 销毁 Agent 1",
    "command": "agent destroy conc-agent-1 --force",
    "exitCode": 0,
    "stdout": "Destroyed conc-agent-1",
    "stderr": "",
    "elapsed": 384,
    "verdict": "PASS",
    "expect": "成功销毁"
  },
  {
    "id": "p16-conc-destroy-2",
    "description": "[Phase 16 并发] 销毁 Agent 2",
    "command": "agent destroy conc-agent-2 --force",
    "exitCode": 0,
    "stdout": "Destroyed conc-agent-2",
    "stderr": "",
    "elapsed": 389,
    "verdict": "PASS",
    "expect": "成功销毁"
  },
  {
    "id": "p16-conc-destroy-3",
    "description": "[Phase 16 并发] 销毁 Agent 3",
    "command": "agent destroy conc-agent-3 --force",
    "exitCode": 0,
    "stdout": "Destroyed conc-agent-3",
    "stderr": "",
    "elapsed": 396,
    "verdict": "PASS",
    "expect": "成功销毁"
  },
  {
    "id": "p16-conc-destroy-4",
    "description": "[Phase 16 并发] 销毁 Agent 4",
    "command": "agent destroy conc-agent-4 --force",
    "exitCode": 0,
    "stdout": "Destroyed conc-agent-4",
    "stderr": "",
    "elapsed": 386,
    "verdict": "PASS",
    "expect": "成功销毁"
  },
  {
    "id": "p16-conc-destroy-5",
    "description": "[Phase 16 并发] 销毁 Agent 5",
    "command": "agent destroy conc-agent-5 --force",
    "exitCode": 0,
    "stdout": "Destroyed conc-agent-5",
    "stderr": "",
    "elapsed": 392,
    "verdict": "PASS",
    "expect": "成功销毁"
  },
  {
    "id": "p16-conc-list-empty",
    "description": "[Phase 16 并发] 确认全部销毁",
    "command": "agent list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"id\": \"d1d98b21-8b09-46b3-90b2-295674da6409\",\n    \"name\": \"session-agent\",\n    \"templateName\": \"qa-pi-tpl\",\n    \"templateVersion\": \"1.0.0\",\n    \"backendType\": \"pi\",\n    \"providerConfig\": {\n      \"type\": \"anthropic\",\n      \"protocol\": \"anthropic\",\n      \"config\": {\n        \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n      }\n    },\n    \"status\": \"stopped\",\n    \"launchMode\": \"direct\",\n    \"workspacePolicy\": \"persistent\",\n    \"processOwnership\": \"managed\",\n    \"createdAt\": \"2026-02-24T12:38:18.468Z\",\n    \"updatedAt\": \"2026-02-24T12:38:20.835Z\",\n    \"effectivePermissions\": {\n      \"allow\": [\n        \"*\"\n      ],\n      \"deny\": [],\n      \"ask\": [],\n      \"defaultMode\": \"bypassPermissions\"\n    }\n  }\n]",
    "stderr": "",
    "elapsed": 389,
    "verdict": "PASS",
    "expect": "返回空数组"
  },
  {
    "id": "p17-final-agent-list",
    "description": "[Phase 17 清理] 确认无残留 Agent",
    "command": "agent list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"id\": \"d1d98b21-8b09-46b3-90b2-295674da6409\",\n    \"name\": \"session-agent\",\n    \"templateName\": \"qa-pi-tpl\",\n    \"templateVersion\": \"1.0.0\",\n    \"backendType\": \"pi\",\n    \"providerConfig\": {\n      \"type\": \"anthropic\",\n      \"protocol\": \"anthropic\",\n      \"config\": {\n        \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n      }\n    },\n    \"status\": \"stopped\",\n    \"launchMode\": \"direct\",\n    \"workspacePolicy\": \"persistent\",\n    \"processOwnership\": \"managed\",\n    \"createdAt\": \"2026-02-24T12:38:18.468Z\",\n    \"updatedAt\": \"2026-02-24T12:38:20.835Z\",\n    \"effectivePermissions\": {\n      \"allow\": [\n        \"*\"\n      ],\n      \"deny\": [],\n      \"ask\": [],\n      \"defaultMode\": \"bypassPermissions\"\n    }\n  }\n]",
    "stderr": "",
    "elapsed": 389,
    "verdict": "PASS",
    "expect": "返回空数组"
  },
  {
    "id": "p17-final-tpl-list",
    "description": "[Phase 17 清理] 确认模板状态",
    "command": "template list -f json",
    "exitCode": 0,
    "stdout": "[\n  {\n    \"name\": \"qa-cursor-tpl\",\n    \"version\": \"1.0.0\",\n    \"description\": \"QA cursor backend - basic\",\n    \"backend\": {\n      \"type\": \"cursor\"\n    },\n    \"domainContext\": {\n      \"skills\": [],\n      \"prompts\": [],\n      \"mcpServers\": [],\n      \"subAgents\": [],\n      \"plugins\": []\n    }\n  },\n  {\n    \"name\": \"qa-claude-tpl\",\n    \"version\": \"1.0.0\",\n    \"description\": \"QA claude-code backend\",\n    \"backend\": {\n      \"type\": \"claude-code\"\n    },\n    \"provider\": {\n      \"type\": \"anthropic\",\n      \"protocol\": \"anthropic\"\n    },\n    \"domainContext\": {\n      \"skills\": [],\n      \"prompts\": [],\n      \"mcpServers\": [],\n      \"subAgents\": [],\n      \"plugins\": []\n    }\n  },\n  {\n    \"name\": \"qa-pi-tpl\",\n    \"version\": \"1.0.0\",\n    \"description\": \"QA Pi backend with LLM provider\",\n    \"backend\": {\n      \"type\": \"pi\"\n    },\n    \"provider\": {\n      \"type\": \"anthropic\",\n      \"config\": {\n        \"apiKeyEnv\": \"ANTHROPIC_API_KEY\"\n      },\n      \"protocol\": \"anthropic\"\n    },\n    \"domainContext\": {\n      \"skills\": [],\n      \"prompts\": [],\n      \"mcpServers\": [],\n      \"subAgents\": [],\n      \"plugins\": []\n    }\n  },\n  {\n    \"name\": \"qa-rich-tpl\",\n    \"version\": \"1.0.0\",\n    \"description\": \"QA full domain context materialization template\",\n    \"backend\": {\n      \"type\": \"cursor\"\n    },\n    \"domainContext\": {\n      \"skills\": [\n        \"code-review\",\n        \"typescript-expert\"\n      ],\n      \"prompts\": [\n        \"system-code-reviewer\"\n      ],\n      \"mcpServers\": [\n        {\n          \"name\": \"f",
    "stderr": "",
    "elapsed": 395,
    "verdict": "PASS",
    "expect": "退出码 0，返回模板列表"
  },
  {
    "id": "p17-final-daemon-status",
    "description": "[Phase 17 清理] 确认 Daemon 运行状态",
    "command": "daemon status -f json",
    "exitCode": 0,
    "stdout": "{\n  \"running\": true,\n  \"version\": \"0.1.0\",\n  \"uptime\": 141,\n  \"agents\": 1\n}",
    "stderr": "",
    "elapsed": 400,
    "verdict": "PASS",
    "expect": "running=true，退出码 0"
  },
  {
    "id": "p17-daemon-stop",
    "description": "[Phase 17 清理] 停止 Daemon",
    "command": "daemon stop",
    "exitCode": 0,
    "stdout": "Daemon stopping...",
    "stderr": "",
    "elapsed": 335,
    "verdict": "PASS",
    "expect": "成功停止，退出码 0"
  },
  {
    "id": "p17-daemon-after-stop",
    "description": "[Phase 17 清理] 确认 Daemon 已停止",
    "command": "daemon status",
    "exitCode": 1,
    "stdout": "Daemon is not running.\nStart with: actant daemon start",
    "stderr": "",
    "elapsed": 327,
    "verdict": "PASS",
    "expect": "退出码非 0，提示 daemon 未运行"
  }
]