# Actant Specifications

> **核心原则**：协议和配置结构是项目的主要产出，代码是对它们的实现。

---

## 文档层次

```
spec/
├── agent-lifecycle.md    ← Agent 生命周期与使用模式（主要产出）
├── config-spec.md        ← 配置规范（主要产出）
├── api-contracts.md      ← 接口契约（主要产出）
│
├── backend/              ← 后端实现指南（实现层）
├── frontend/             ← 前端实现指南（实现层）
└── guides/               ← 辅助思考指南
```

### 第一层：规范（Specification）

**规范定义系统"是什么"**。所有代码必须符合规范；若代码与规范冲突，以规范为准，修正代码。

| 文档 | 内容 | 约束力 |
|------|------|--------|
| [Agent 生命周期](./agent-lifecycle.md) | 运行模式、接入方式、使用场景、状态转换 | **强制** — 理解系统行为的核心文档 |
| [配置规范](./config-spec.md) | 所有配置结构、Schema、枚举、环境变量 | **强制** — 任何配置变更必须先更新此文档 |
| [接口契约](./api-contracts.md) | RPC 方法、CLI 命令、ACP Proxy、MCP Server、错误码 | **强制** — 任何接口变更必须先更新此文档 |
| [耐久测试规范](./endurance-testing.md) | 覆盖矩阵、不变量、演进策略、维护规范 | **强制** — 生命周期/通信变更必须同步更新耐久测试 |

### 重要设计文档

以下设计文档对理解系统架构至关重要，实现时应作为核心参考：

| 文档 | 内容 | 重要性 |
|------|------|--------|
| [Agent 启动场景与 ACP 架构](../../docs/design/agent-launch-scenarios.md) | 7 种启动/交互场景、ACP Gateway 架构、协议分层、控制权谱系 | **核心** — 所有 ACP/Proxy/Chat 相关实现的架构依据 |
| [架构 Docker 类比](../../docs/design/architecture-docker-analogy.md) | CLI-Daemon 分层设计的概念映射 | 参考 — 理解整体架构思路 |

### 第二层：实现指南（Implementation Guidelines）

**指南描述如何"正确地实现"**。为开发者提供编码规范、错误处理模式、日志策略等。

| 文档 | 描述 |
|------|------|
| [后端指南](./backend/index.md) | 模块架构、错误处理、日志、质量标准 |
| [前端指南](./frontend/index.md) | 组件规范、状态管理、类型安全 |

### 第三层：思考指南（Thinking Guides）

**辅助决策和设计思维**，预防"没想到"导致的缺陷。

| 文档 | 描述 |
|------|------|
| [思考指南索引](./guides/index.md) | 跨层、复用、跨平台等思考框架 |

### 项目上下文文档

以下文档不属于规范层，但对理解项目状态和方向至关重要：

| 文档 | 内容 | 位置 |
|------|------|------|
| 产品路线图 | Phase 规划、里程碑、Issue 对齐 | `docs/planning/roadmap.md` |
| 文档目录规范 | docs/ 各子目录职责、写入权限、命名规范 | `docs/README.md` |
| 目录结构 ADR | 项目目录结构决策及演进记录 | `docs/decisions/002-directory-structure.md` |

---

## 变更规则

1. **规范优先**：新功能先更新规范文档，再实现代码
2. **同步提交**：配置/接口的代码变更与规范更新必须在**同一次提交**中
3. **规范即真相**：若代码行为与规范不一致，视为 Bug
4. **审查检查项**：Code Review 必须确认相关规范文档已同步更新
