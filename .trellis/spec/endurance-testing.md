# è€ä¹…æµ‹è¯•è§„èŒƒ (Endurance Testing Specification)

> è€ä¹…æµ‹è¯•æ˜¯ Actant çš„**æŒç»­éªŒè¯èƒ½åŠ›**â€”â€”ä¸æ˜¯"è·‘å¾—ä¹…çš„æµ‹è¯•"ï¼Œè€Œæ˜¯å¯¹ç³»ç»Ÿåœ¨é•¿æœŸè¿è¡Œä¸­æ­£ç¡®æ€§çš„ç»“æ„åŒ–ä¿éšœã€‚
> æ¯ä¸ªæ–°åŠŸèƒ½**å¿…é¡»**åŒæ­¥æ‰©å±•è€ä¹…è¦†ç›–ã€‚æœ¬æ–‡æ¡£å®šä¹‰è¦†ç›–çŸ©é˜µã€æ¼”è¿›ç­–ç•¥å’Œç»´æŠ¤è§„èŒƒã€‚
> **è‹¥ä»£ç è¡Œä¸ºä¸æœ¬æ–‡æ¡£å®šä¹‰çš„è¦†ç›–ç›®æ ‡ä¸ä¸€è‡´ï¼Œä¼˜å…ˆæ›´æ–°è€ä¹…æµ‹è¯•ã€‚**

> **å®ç°çŠ¶æ€**ï¼š**Phase 1ï¼ˆç”Ÿå‘½å‘¨æœŸåœºæ™¯ï¼‰å·²å®ç°**ï¼Œä¸ºå½“å‰æœ‰æ•ˆè§„èŒƒï¼›Phase 2ï¼ˆé€šä¿¡ä¸åè®®ï¼‰å’Œ Phase 3+ï¼ˆæ‰©å±•ä½“ç³»ï¼‰ä¸ºè®¡åˆ’æ‰©å±•ï¼Œå°šæœªå®ç°ï¼Œæ ‡æ³¨ä¸º"å¾…å®ç°"ã€‚

---

## 1. å®šä½ä¸ä¸‰å±‚æµ‹è¯•ä½“ç³»

| å±‚çº§ | æ–‡ä»¶çº¦å®š | æ‰§è¡Œå‘½ä»¤ | CI é¢‘ç‡ | éªŒè¯ç›®æ ‡ |
|------|---------|---------|---------|---------|
| **å•å…ƒæµ‹è¯•** | `*.test.ts` | `pnpm test` | æ¯æ¬¡æäº¤ | å•æ­¥æ“ä½œæ­£ç¡®æ€§ |
| **åœºæ™¯æµ‹è¯•** | `*-scenarios.test.ts` | `pnpm test` | æ¯æ¬¡æäº¤ | å¤šæ­¥å·¥ä½œæµçŠ¶æ€æœºæ­£ç¡®æ€§ |
| **è€ä¹…æµ‹è¯•** | `*.endurance.test.ts` | `pnpm test:endurance` | æŒ‰éœ€ / å‘ç‰ˆå‰ | é•¿æ—¶é—´è¿è¡Œä¸‹çš„çŠ¶æ€ä¸€è‡´æ€§ã€èµ„æºç¨³å®šæ€§ |

**å…³é”®åŒºåˆ«**ï¼šåœºæ™¯æµ‹è¯•éªŒè¯"å•æ¬¡èµ°å®Œä¸€ä¸ªæµç¨‹æ˜¯å¦æ­£ç¡®"ï¼›è€ä¹…æµ‹è¯•éªŒè¯"åå¤èµ°åŒä¸€ä¸ªæµç¨‹ N æ¬¡ã€æŒç»­ M åˆ†é’Ÿåæ˜¯å¦ä¾ç„¶æ­£ç¡®"ã€‚

---

## 2. è¦†ç›–çŸ©é˜µ

### 2.1 ç»´åº¦å®šä¹‰

è€ä¹…æµ‹è¯•è¦†ç›–ç”±ä¸¤ä¸ªæ­£äº¤ç»´åº¦ç»„æˆï¼š

- **åœºæ™¯ç»´åº¦** â€” å¯¹åº” `agent-lifecycle.md` ä¸­å®šä¹‰çš„ä½¿ç”¨æ¨¡å¼
- **éªŒè¯ç»´åº¦** â€” æ¯ä¸ªåœºæ™¯ä¸‹å¿…é¡»æ£€æŸ¥çš„ä¸å˜é‡

### 2.2 åœºæ™¯è¦†ç›–ï¼ˆéš Phase æ¼”è¿›æ‰©å±•ï¼‰

#### Phase 1: æ ¸å¿ƒè¿è¡Œæ—¶

| åœºæ™¯ ID | åœºæ™¯åç§° | è¦†ç›–å†…å®¹ | å…³åœè¡Œä¸º |
|---------|---------|---------|---------|
| `E-LIFE` | å®Œæ•´ç”Ÿå‘½å‘¨æœŸå¾ªç¯ | create â†’ start â†’ stop â†’ start â†’ stop â†’ destroyï¼Œåå¤ | æ˜¾å¼ stop + destroy |
| `E-SVC` | acp-service è¿ç»­å´©æºƒé‡å¯ | éšæœºå´©æºƒ â†’ è‡ªåŠ¨é‡å¯ â†’ é€€é¿ â†’ æ¢å¤ â†’ é‡ç½®è®¡æ•°å™¨ | å´©æºƒåè‡ªåŠ¨é‡å¯ï¼›è¶…é™å error |
| `E-SHOT` | one-shot æ‰§è¡Œä¸æ¸…ç† | åˆ›å»º â†’ è¿è¡Œ â†’ å®Œæˆ â†’ ephemeral æ¸…ç†ï¼Œåå¤ | è¿›ç¨‹é€€å‡ºåè‡ªåŠ¨é”€æ¯ |
| `E-EXT` | å¤–éƒ¨ Spawn å®Œæ•´æµç¨‹ | resolve â†’ attach â†’ crash/detach â†’ cleanupï¼Œäº¤æ›¿ ephemeral/persistent | ç”±è°ƒç”¨æ–¹ detach å†³å®š |
| `E-DAEMON` | Daemon é‡å¯æ¢å¤ | Daemon åå¤å´©æºƒé‡å¯ï¼ŒéªŒè¯ acp-service æ¢å¤ã€direct ä¸æ¢å¤ | Daemon dispose â†’ æ–° Daemon æ¢å¤ |
| `E-MIX` | æ··åˆå¹¶å‘æ“ä½œ | å¤š Agentã€å¤šæ¨¡å¼ã€éšæœº create/start/stop/crash/destroy | å„æ¨¡å¼å„è‡ªå…³åœé€»è¾‘ |

#### Phase 2: é€šä¿¡ä¸åè®®ï¼ˆå¾…å®ç°ï¼‰

| åœºæ™¯ ID | åœºæ™¯åç§° | è¦†ç›–å†…å®¹ | å…³åœè¡Œä¸º |
|---------|---------|---------|---------|
| `E-RPC` | RPC é«˜é¢‘é€šä¿¡ | è¿ç»­ RPC è°ƒç”¨ï¼ŒéªŒè¯æ— è¿æ¥æ³„æ¼ã€æ— çŠ¶æ€æ¼‚ç§» | æ­£å¸¸å…³é—­è¿æ¥ |
| `E-ACP` | ACP Proxy æŒç»­è½¬å‘ | Proxy é•¿æ—¶é—´è½¬å‘æ¶ˆæ¯ï¼ŒéªŒè¯ Agent çŠ¶æ€åŒæ­¥ï¼›**å¿…é¡»åŒ…å«ç©ºé—²æœŸå­˜æ´»éªŒè¯**ï¼ˆè§æ³¨ï¼‰ | Proxy æ–­å¼€å Agent çŠ¶æ€æ­£ç¡® |
| `E-MCP` | Agent é—´ MCP é€šä¿¡ | Agent A åå¤é€šè¿‡ MCP å§”æ´¾ä»»åŠ¡ç»™ Agent B | one-shot Agent è‡ªåŠ¨æ¸…ç† |

> **`E-ACP` å®ç°æ³¨æ„**ï¼šæµ‹è¯•ä¸­å¿…é¡»åŒ…å« >10s çš„ç©ºé—²çª—å£ï¼ˆä¸¤æ¬¡ prompt ä¹‹é—´æ— æ´»åŠ¨ï¼‰ï¼Œå¹¶éªŒè¯ acp-background Agent å­è¿›ç¨‹åœ¨æ­¤æœŸé—´ä¿æŒå­˜æ´»ï¼ˆ`INV-ALIVE`ï¼‰ã€‚è¿™è¦†ç›–äº† Windows Named Pipe ç©ºé—²é€€å‡º bug çš„å›å½’ã€‚è¯¦è§ `guides/cross-platform-guide.md Â§Windows Named Pipe Idle Exit`ã€‚

#### Phase 3+: æ‰©å±•ä½“ç³»ï¼ˆå¾…å®ç°ï¼‰

| åœºæ™¯ ID | åœºæ™¯åç§° | è¦†ç›–å†…å®¹ |
|---------|---------|---------|
| `E-PLUG` | æ’ä»¶åŠ è½½/å¸è½½å¾ªç¯ | åå¤åŠ è½½å’Œå¸è½½æ’ä»¶ï¼ŒéªŒè¯æ— çŠ¶æ€æ³„æ¼ |
| `E-MEM` | è®°å¿†ç³»ç»ŸæŒä¹…æ€§ | é•¿æ—¶é—´å†™å…¥/è¯»å–è®°å¿†ï¼ŒéªŒè¯ä¸€è‡´æ€§ |

### 2.3 éªŒè¯ä¸å˜é‡

æ¯ä¸ªè€ä¹…æµ‹è¯•åœ¨å¾ªç¯ç»“æŸå**å¿…é¡»**æ£€æŸ¥ä»¥ä¸‹ä¸å˜é‡ï¼ˆé€‚ç”¨çš„å­é›†ï¼‰ï¼š

| ä¸å˜é‡ ID | åç§° | æ£€æŸ¥å†…å®¹ |
|-----------|------|---------|
| `INV-DISK` | ç£ç›˜/ç¼“å­˜ä¸€è‡´ | `readInstanceMeta(disk)` çš„ status ä¸ `manager.getAgent()` çš„ status ä¸€è‡´ |
| `INV-CLEAN` | èµ„æºæ¸…ç†å®Œæ•´ | å·²é”€æ¯çš„ Agent ä¸å­˜åœ¨äºç£ç›˜ã€ç¼“å­˜ã€watcher ä¸­ |
| `INV-STATUS` | çŠ¶æ€å€¼åˆæ³• | æ‰€æœ‰ Agent çš„ status å±äºå®šä¹‰çš„æœ‰æ•ˆå€¼é›†åˆ |
| `INV-COUNT` | ç¼“å­˜è®¡æ•°å‡†ç¡® | `manager.size` ç­‰äºå®é™…å­˜æ´» Agent æ•°é‡ |
| `INV-PID` | PID æ— æ®‹ç•™ | stopped/error/created çŠ¶æ€çš„ Agent æ²¡æœ‰ PID |
| `INV-OWNER` | æ‰€æœ‰æƒæ­£ç¡® | external è¿›ç¨‹ detach å ownership é‡ç½®ä¸º managed |
| `INV-CONV` | å¯¹è¯è®°å½•ä¸ç¢ç‰‡åŒ– | employee Agent å†æ¬¡é‡å¯å `conversationId` ä¿æŒä¸å˜ï¼Œactivity ç›®å½•ä¸­åªæœ‰ä¸€ä¸ª `.jsonl` æ–‡ä»¶ï¼Œä¸éšé‡å¯äº§ç”Ÿæ–°æ–‡ä»¶ |
| `INV-ALIVE` | ACP å­è¿›ç¨‹ä¿æ´» | acp-background Agent åœ¨ä¸¤æ¬¡ prompt ä¹‹é—´çš„ç©ºé—²æœŸï¼ˆ>5sï¼‰ä¸è‡ªåŠ¨é€€å‡ºï¼›Windows ä¸Šä¾èµ– keepalive æœºåˆ¶ï¼ˆ`AcpConnection.startKeepalive`ï¼‰|

---

## 3. å…³åœç­–ç•¥çŸ©é˜µ

æ¯ç§ LaunchMode çš„å…³åœè¡Œä¸ºå¿…é¡»åœ¨è€ä¹…æµ‹è¯•ä¸­æŒç»­éªŒè¯ï¼š

| LaunchMode | æ­£å¸¸å…³åœ | è¿›ç¨‹å´©æºƒ | è¶…é™å´©æºƒ | Daemon é‡å¯ |
|------------|---------|---------|---------|------------|
| `direct` | stop â†’ stopped | watcher æ£€æµ‹ â†’ stopped | â€” | æ¢å¤ä¸º stoppedï¼ˆä¸è‡ªåŠ¨é‡å¯ï¼‰ |
| `acp-background` | stop â†’ stopped | watcher æ£€æµ‹ â†’ stopped | â€” | æ¢å¤ä¸º stopped |
| `acp-service` | stop â†’ stopped | watcher â†’ restart (é€€é¿) | â†’ error | æ¢å¤ä¸º runningï¼ˆè‡ªåŠ¨é‡å¯ï¼‰ |
| `one-shot` | è¿›ç¨‹é€€å‡º â†’ auto-destroy | è¿›ç¨‹é€€å‡º â†’ auto-destroy | â€” | æ¢å¤ä¸º stopped |
| External attach | detach â†’ stopped | watcher â†’ crashed | â€” | â€” |

---

## 4. æ¼”è¿›è§„èŒƒ

### 4.1 æ–°åŠŸèƒ½ â†’ è€ä¹…è¦†ç›–è”åŠ¨

æ¯å½“å¼•å…¥å½±å“ä»¥ä¸‹ç»´åº¦çš„æ–°åŠŸèƒ½æ—¶ï¼Œ**å¿…é¡»**åŒæ­¥æ‰©å±•è€ä¹…æµ‹è¯•ï¼š

| å½±å“ç»´åº¦ | éœ€è¦æ–°å¢/ä¿®æ”¹çš„è€ä¹…åœºæ™¯ |
|---------|---------------------|
| æ–°çš„ LaunchMode æˆ–ä¿®æ”¹ç°æœ‰æ¨¡å¼è¯­ä¹‰ | æ–°å¢ä¸“å±å…³åœè¡Œä¸ºåœºæ™¯ + æ›´æ–° `E-MIX` |
| æ–°çš„é€šä¿¡åè®®/é€šé“ï¼ˆACP/MCP/RPCï¼‰ | æ–°å¢æŒç»­é€šä¿¡åœºæ™¯ |
| çŠ¶æ€æœºæ–°å¢è½¬æ¢è·¯å¾„ | æ›´æ–°å—å½±å“çš„åœºæ™¯ + `INV-STATUS` |
| æ–°çš„ ProcessOwnership æ¨¡å¼ | æ–°å¢ attach/detach å¾ªç¯åœºæ™¯ |
| æ’ä»¶/æ‰©å±•ç³»ç»Ÿ | æ–°å¢åŠ è½½/å¸è½½å¾ªç¯åœºæ™¯ |
| æŒä¹…åŒ–å­˜å‚¨å˜æ›´ | æ›´æ–° `INV-DISK` æ£€æŸ¥ |
| **å¯¹è¯ ID / æ´»åŠ¨è®°å½•é€»è¾‘å˜æ›´** | æ›´æ–° `INV-CONV`ï¼šéªŒè¯ employee conversationId è·¨é‡å¯ä¸å˜ï¼Œactivity ç›®å½•æ— ç¢ç‰‡æ–‡ä»¶ |
| **ACP å­è¿›ç¨‹ä¿æ´»æœºåˆ¶å˜æ›´** | æ›´æ–° `INV-ALIVE`ï¼šéªŒè¯ acp-background åœ¨ç©ºé—²æœŸï¼ˆ>10sï¼‰ä¸é€€å‡ºï¼ŒWindows ä¸Š keepalive å†™å…¥å¯è§‚æµ‹ |

### 4.2 ç»´æŠ¤æ¸…å•

åœ¨å¼€å‘å·¥ä½œæµï¼ˆworkflow.mdï¼‰çš„ Code Quality Checklist ä¸­æ–°å¢ï¼š

```
è€ä¹…æµ‹è¯•åŒæ­¥ï¼ˆåŠŸèƒ½å˜æ›´æ—¶å¿…é€‰ï¼‰:
- [ ] æ–°å¢/ä¿®æ”¹çš„åŠŸèƒ½æ˜¯å¦å½±å“è¦†ç›–çŸ©é˜µä¸­çš„åœºæ™¯ï¼Ÿ
- [ ] å·²æœ‰è€ä¹…æµ‹è¯•æ˜¯å¦å› æ¥å£å˜æ›´éœ€è¦é€‚é…ï¼Ÿ
- [ ] æ–°åœºæ™¯çš„ä¸å˜é‡æ£€æŸ¥æ˜¯å¦å®Œæ•´ï¼Ÿ
- [ ] `pnpm test:endurance` åœ¨ ENDURANCE_DURATION_MS=5000 ä¸‹é€šè¿‡ï¼Ÿ
```

### 4.3 ç‰ˆæœ¬å·æ ‡è®°

è€ä¹…æµ‹è¯•æ–‡ä»¶é¡¶éƒ¨æ³¨é‡Šæ ‡æ³¨å½“å‰è¦†ç›–çš„ Phaseï¼š

```typescript
/**
 * Endurance coverage: Phase 1 (lifecycle, crash-restart, ext-spawn)
 * Next expansion: Phase 2 (RPC, ACP Proxy, MCP communication)
 */
```

---

## 5. æ‰§è¡Œç­–ç•¥

### 5.1 å‘½ä»¤

```bash
# é»˜è®¤ 30 ç§’/æµ‹è¯•ï¼ˆCI å¿«é€ŸéªŒè¯ï¼‰
pnpm test:endurance

# å¼€å‘ä¸­å¿«é€Ÿå›å½’
ENDURANCE_DURATION_MS=5000 pnpm test:endurance

# å‘ç‰ˆå‰å®Œæ•´éªŒè¯ï¼ˆ10 åˆ†é’Ÿ/æµ‹è¯•ï¼‰
ENDURANCE_DURATION_MS=600000 pnpm test:endurance

# æ·±åº¦æµ¸æ³¡æµ‹è¯•ï¼ˆ1 å°æ—¶ï¼‰
ENDURANCE_DURATION_MS=3600000 pnpm test:endurance
```

### 5.2 ä½•æ—¶æ‰§è¡Œ

| è§¦å‘æ¡ä»¶ | å»ºè®®æ—¶é•¿ | å¿…é¡»/å»ºè®® |
|---------|---------|---------|
| åŠŸèƒ½å¼€å‘å®Œæˆæäº¤å‰ | 5s å¿«é€Ÿå›å½’ | **å¿…é¡»** |
| Phase é‡Œç¨‹ç¢‘å®Œæˆ | 10 åˆ†é’Ÿ | **å¿…é¡»** |
| å‘ç‰ˆå‰ | 30-60 åˆ†é’Ÿ | **å¿…é¡»** |
| ä¿®æ”¹æ ¸å¿ƒçŠ¶æ€ç®¡ç†ä»£ç  | 5-10 åˆ†é’Ÿ | **å»ºè®®** |
| CI nightly | 10 åˆ†é’Ÿ | **å»ºè®®** |

### 5.3 ç»Ÿè®¡è¾“å‡º

æ¯ä¸ªè€ä¹…æµ‹è¯•ç»“æŸå**å¿…é¡»**è¾“å‡ºç»Ÿè®¡æ‘˜è¦ï¼Œæ ¼å¼ï¼š

```
[endurance] <åœºæ™¯å>: <æ“ä½œè®¡æ•°> in <elapsed>ms
```

ç”¨äºè·Ÿè¸ªååé‡è¶‹åŠ¿â€”â€”å¦‚æœåŒæ ·æ—¶é•¿å†…æ“ä½œæ¬¡æ•°æ˜¾è‘—ä¸‹é™ï¼Œå¯èƒ½å­˜åœ¨æ€§èƒ½é€€åŒ–ã€‚

---

## 6. æ–‡ä»¶ç»“æ„

```
packages/
  core/src/manager/
    agent-manager.endurance.test.ts      â† Phase 1: æ ¸å¿ƒç”Ÿå‘½å‘¨æœŸ
  api/src/
    rpc-endurance.test.ts                â† Phase 2: RPC é€šä¿¡ï¼ˆå¾…å»ºï¼‰
  acp/src/
    acp-proxy-endurance.test.ts          â† Phase 2: ACP Proxyï¼ˆå¾…å»ºï¼‰
  core/src/plugin/
    plugin-host.endurance.test.ts        â† Phase 4: Plugin ç”Ÿå‘½å‘¨æœŸï¼ˆå¾…å»ºï¼‰
  core/src/scheduler/
    scheduler.endurance.test.ts          â† Phase 4: Scheduler å¤šè¾“å…¥æºï¼ˆå¾…å»ºï¼‰
  core/src/email/
    email-hub.endurance.test.ts          â† Phase 4: Email æŠ•é€’ï¼ˆå¾…å»ºï¼‰
  agent-memory/store-<backend>/
    memory-store.endurance.test.ts       â† Phase 5: Memory å­˜å‚¨ï¼ˆå¾…å»ºï¼Œåç«¯å¾…å®šï¼‰
```

---

## 7. Phase 4 è€ä¹…æµ‹è¯•åœºæ™¯ ğŸš§

> ä»¥ä¸‹åœºæ™¯éš Phase 4 å„ Step é€æ­¥å®æ–½ã€‚

### E-PLUG â€” Plugin ç”Ÿå‘½å‘¨æœŸç¨³å®šæ€§

**ç›®æ ‡**: éªŒè¯ PluginHost åœ¨é•¿æ—¶é—´è¿è¡Œä¸­ï¼Œå¤šä¸ª Plugin çš„ tick å¾ªç¯ç¨³å®šã€æ•…éšœéš”ç¦»æœ‰æ•ˆã€‚

| ç»´åº¦ | è®¾è®¡ |
|------|------|
| æ“ä½œ | å¯åŠ¨ PluginHostï¼ˆ3 ä¸ª Pluginï¼‰ï¼Œåå¤è§¦å‘ tick å¾ªç¯ |
| æ³¨å…¥æ•…éšœ | éšæœºè®©æŸ Plugin tick æŠ›å¼‚å¸¸ / è¶…æ—¶ |
| ä¸å˜é‡ | (1) å• Plugin å¼‚å¸¸ä¸å½±å“å…¶ä»– Plugin çš„ tick (2) consecutiveFailures è®¡æ•°å‡†ç¡® (3) æ— å†…å­˜æ³„æ¼ (4) stop/dispose å…¨éƒ¨å¹‚ç­‰ |
| ç»Ÿè®¡ | tick æ€»æ¬¡æ•°ã€éš”ç¦»æˆåŠŸæ¬¡æ•°ã€å¹³å‡ tick å»¶è¿Ÿ |

### E-HEART â€” Heartbeat `.heartbeat` æ–‡ä»¶æ¼”è¿›

**ç›®æ ‡**: éªŒè¯ HeartbeatInput åœ¨è¿ç»­å¤šæ¬¡å¿ƒè·³åï¼Œ`.heartbeat` æ–‡ä»¶è¢« Agent æ­£ç¡®è¯»å–å’Œæ›´æ–°ï¼Œå†…å®¹æŒç»­æ¼”è¿›ã€‚

| ç»´åº¦ | è®¾è®¡ |
|------|------|
| æ“ä½œ | åˆ›å»º Employee Agentï¼ˆ10s å¿ƒè·³ï¼‰ï¼Œè¿ç»­è¿è¡Œ â‰¥10 æ¬¡å¿ƒè·³ï¼Œæ”¶é›† `.heartbeat` æ–‡ä»¶å¿«ç…§ |
| ä¸å˜é‡ | (1) `.heartbeat` æ–‡ä»¶ç”± `seedHeartbeatFile()` æ­£ç¡®åˆ›å»º (2) æ¯æ¬¡å¿ƒè·³çš„ prompt ä¸º `DEFAULT_HEARTBEAT_PROMPT`ï¼ˆä¸å«ç”¨æˆ· promptï¼‰ (3) `.heartbeat` æ–‡ä»¶å†…å®¹åœ¨å¤šæ¬¡å¿ƒè·³åæœ‰å˜åŒ–ï¼ˆAgent å®é™…å†™å›ï¼‰ (4) ç§å­å†…å®¹ä¸è¦†ç›–å·²æœ‰æ–‡ä»¶ |
| ç»Ÿè®¡ | å¿ƒè·³æ€»æ¬¡æ•°ã€LLM æˆåŠŸè°ƒç”¨æ¬¡æ•°ã€`.heartbeat` æ–‡ä»¶æ›´æ–°æ¬¡æ•°ã€å¹³å‡å¿ƒè·³è€—æ—¶ |

> **ç»éªŒæ•™è®­ï¼ˆ2026-02-27 QAï¼‰**ï¼šé¦–æ¬¡ E2E æµ‹è¯•éœ€ç¡®ä¿ Pi åç«¯çš„ `baseUrl` æ­£ç¡®é€ä¼ ï¼Œå¦åˆ™æ‰€æœ‰å¿ƒè·³ä¼šé™é»˜è¿”å›ç©ºç»“æœï¼ˆä»»åŠ¡çŠ¶æ€ä»ä¸º "completed"ï¼‰ã€‚å»ºè®®éªŒè¯é¦–æ¬¡å¿ƒè·³çš„ LLM å“åº”éç©ºåå†å¼€å§‹è®¡æ•°ã€‚

### E-SCHED â€” Scheduler å¤šè¾“å…¥æºå‹åŠ›

**ç›®æ ‡**: éªŒè¯ EmployeeScheduler åœ¨ Heartbeat + Cron + DelayInput + EmailInput åŒæ—¶è¿è¡Œæ—¶çš„æ­£ç¡®æ€§ã€‚

| ç»´åº¦ | è®¾è®¡ |
|------|------|
| æ“ä½œ | åŒæ—¶æ³¨å†Œ 4 ç§ InputSourceï¼Œé«˜é¢‘äº§ç”Ÿä»»åŠ¡ |
| ä¸å˜é‡ | (1) TaskQueue ä¸ä¸¢ä»»åŠ¡ (2) ä»»åŠ¡æŒ‰ä¼˜å…ˆçº§æ’åº (3) InputRouter åˆ†å‘æ— ç«æ€ (4) cancel åè¾“å…¥æºåœæ­¢ |
| ç»Ÿè®¡ | ä»»åŠ¡å…¥é˜Ÿæ€»æ•°ã€å¤„ç†æ€»æ•°ã€æœ€å¤§é˜Ÿåˆ—æ·±åº¦ã€å¹³å‡è°ƒåº¦å»¶è¿Ÿ |

### E-EMAIL â€” Email æŠ•é€’å¯é æ€§

**ç›®æ ‡**: éªŒè¯ EmailHub åœ¨å¤§é‡å¹¶å‘ send/reply ä¸‹çš„æ¶ˆæ¯æŠ•é€’å¯é æ€§ã€‚

| ç»´åº¦ | è®¾è®¡ |
|------|------|
| æ“ä½œ | N ä¸ª Agent äº’ç›¸å‘é€ Emailï¼Œæ··åˆåœ¨çº¿/ç¦»çº¿çŠ¶æ€ |
| ä¸å˜é‡ | (1) æ¶ˆæ¯ä¸ä¸¢å¤±ï¼ˆsent = delivered + pendingï¼‰ (2) çº¿ç¨‹å½’ç»„æ­£ç¡® (3) æŒä¹…åŒ–ä¸å†…å­˜çŠ¶æ€ä¸€è‡´ |
| ç»Ÿè®¡ | æ¶ˆæ¯æ€»æ•°ã€æŠ•é€’æˆåŠŸç‡ã€ç¦»çº¿é˜Ÿåˆ—å³°å€¼ã€å¹³å‡æŠ•é€’å»¶è¿Ÿ |

### E-MEM â€” Memory å­˜å‚¨ç¨³å®šæ€§

**ç›®æ ‡**: éªŒè¯ MemoryStore å®ç°åœ¨å¤§é‡ recall/navigate/browse ä¸‹çš„ç¨³å®šæ€§å’Œæ­£ç¡®æ€§ã€‚ï¼ˆå­˜å‚¨åç«¯å¾…å®šï¼‰

| ç»´åº¦ | è®¾è®¡ |
|------|------|
| æ“ä½œ | æ‰¹é‡å†™å…¥ MemoryRecordï¼Œå¹¶å‘æ‰§è¡Œ recall/navigate/browse |
| ä¸å˜é‡ | (1) recall è¿”å›ç»“æœçš„ score å•è°ƒé€’å‡ (2) navigate URI ç²¾ç¡®åŒ¹é… (3) browse ç»“æœé›†æ— é—æ¼ (4) SQL å‚æ•°åŒ–æ— æ³¨å…¥ |
| ç»Ÿè®¡ | å†™å…¥æ¡æ•°ã€æŸ¥è¯¢æ€»æ¬¡æ•°ã€å¹³å‡æŸ¥è¯¢å»¶è¿Ÿã€å­˜å‚¨æ–‡ä»¶å¤§å° |

### E-HOOK â€” äº‹ä»¶æ€»çº¿åå

**ç›®æ ‡**: éªŒè¯ HookEventBus åœ¨é«˜é¢‘ emit ä¸‹çš„äº‹ä»¶åˆ†å‘æ­£ç¡®æ€§å’Œæ€§èƒ½ã€‚

| ç»´åº¦ | è®¾è®¡ |
|------|------|
| æ“ä½œ | æ³¨å†Œ 20+ Workflow hooksï¼Œé«˜é¢‘ emit æ··åˆäº‹ä»¶ |
| ä¸å˜é‡ | (1) æ¯ä¸ªåŒ¹é…çš„ listener éƒ½è¢«è°ƒç”¨ (2) listener å¼‚å¸¸ä¸å½±å“å…¶ä»– listener (3) æ— äº‹ä»¶ä¸¢å¤± |
| ç»Ÿè®¡ | emit æ€»æ¬¡æ•°ã€listener è°ƒç”¨æ€»æ¬¡æ•°ã€å¹³å‡åˆ†å‘å»¶è¿Ÿ |

---

## å˜æ›´çº¦å®š

> å¯¹æœ¬æ–‡æ¡£å®šä¹‰çš„è¦†ç›–çŸ©é˜µã€ä¸å˜é‡æˆ–æ¼”è¿›è§„èŒƒè¿›è¡Œå˜æ›´æ—¶ï¼Œé¡»åŒæ­¥æ›´æ–°å¯¹åº”çš„è€ä¹…æµ‹è¯•ä»£ç ï¼Œåœ¨åŒä¸€æ¬¡æäº¤ä¸­å®Œæˆã€‚
